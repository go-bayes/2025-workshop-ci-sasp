<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Causal Diagrams: The Structures of Interaction/Effect Modification, Measurement Bias, Selection Bias – Beyond Correlation: Causal Inference Workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-49a824ff064150fa59632921ab93e189.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-49a824ff064150fa59632921ab93e189.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-49a824ff064150fa59632921ab93e189.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0f6ccba3aad1fff662cf50edb574b647.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-f3db133a45e4b36e23af773631f45c2c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-0f6ccba3aad1fff662cf50edb574b647.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Beyond Correlation: Causal Inference Workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-workshop-content" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Workshop Content</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-workshop-content">    
        <li>
    <a class="dropdown-item" href="../content/00-background.html">
 <span class="dropdown-text">1. What is Causality?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/01-background.html">
 <span class="dropdown-text">2. Identification Using Causal DAGs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/02-causal-workflow.html">
 <span class="dropdown-text">3. Causal Workflow</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/03-interaction.html">
 <span class="dropdown-text">4. Average and Conditional Average Treatment Effects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../workshop-scripts/06-interpretation-2.html">
 <span class="dropdown-text">5. Code Review</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../simulations/01-simulation-population.html">
 <span class="dropdown-text">Simulations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../pdfs/bulbulia-hand-outs/S2-glossary.pdf">
 <span class="dropdown-text">Glossary (PDF)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../glossary-and-dags.html"> 
<span class="menu-text">Glossary &amp; DAGs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../reading.html"> 
<span class="menu-text">Reading</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/go-bayes"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">Go-Bayes</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#exploring-bias" id="toc-exploring-bias" class="nav-link active" data-scroll-target="#exploring-bias">Exploring Bias</a>
  <ul class="collapse">
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries">Load libraries</a>
  <ul class="collapse">
  <li><a href="#omitted-variable-bias-causal-graph" id="toc-omitted-variable-bias-causal-graph" class="nav-link" data-scroll-target="#omitted-variable-bias-causal-graph">Omitted Variable Bias Causal Graph</a></li>
  </ul></li>
  <li><a href="#mediation-and-causation" id="toc-mediation-and-causation" class="nav-link" data-scroll-target="#mediation-and-causation">Mediation and causation</a></li>
  <li><a href="#pipe-confounding-full-mediation" id="toc-pipe-confounding-full-mediation" class="nav-link" data-scroll-target="#pipe-confounding-full-mediation">Pipe confounding (full mediation)</a></li>
  <li><a href="#masked-relationships" id="toc-masked-relationships" class="nav-link" data-scroll-target="#masked-relationships">Masked relationships</a></li>
  <li><a href="#collider-confounding" id="toc-collider-confounding" class="nav-link" data-scroll-target="#collider-confounding">Collider Confounding</a></li>
  <li><a href="#collider-bias-within-experiments" id="toc-collider-bias-within-experiments" class="nav-link" data-scroll-target="#collider-bias-within-experiments">Collider bias within experiments</a></li>
  <li><a href="#taxonomy-of-confounding" id="toc-taxonomy-of-confounding" class="nav-link" data-scroll-target="#taxonomy-of-confounding">Taxonomy of confounding</a>
  <ul class="collapse">
  <li><a href="#the-fork-omitted-variable-bias" id="toc-the-fork-omitted-variable-bias" class="nav-link" data-scroll-target="#the-fork-omitted-variable-bias">The Fork (omitted variable bias)</a></li>
  <li><a href="#the-pipe-fully-mediated-effects" id="toc-the-pipe-fully-mediated-effects" class="nav-link" data-scroll-target="#the-pipe-fully-mediated-effects">The Pipe (fully mediated effects)</a></li>
  <li><a href="#the-collider" id="toc-the-collider" class="nav-link" data-scroll-target="#the-collider">The Collider</a></li>
  <li><a href="#confounding-by-proxy" id="toc-confounding-by-proxy" class="nav-link" data-scroll-target="#confounding-by-proxy">Confounding by proxy</a></li>
  </ul></li>
  <li><a href="#rules-for-avoiding-confounding" id="toc-rules-for-avoiding-confounding" class="nav-link" data-scroll-target="#rules-for-avoiding-confounding">Rules for avoiding confounding</a></li>
  <li><a href="#inference-depends-on-assumptions-that-are-not-contained-in-the-data." id="toc-inference-depends-on-assumptions-that-are-not-contained-in-the-data." class="nav-link" data-scroll-target="#inference-depends-on-assumptions-that-are-not-contained-in-the-data.">Inference depends on assumptions that are not contained in the data.</a></li>
  <li><a href="#more-examples-of-counfoundingde-confounding" id="toc-more-examples-of-counfoundingde-confounding" class="nav-link" data-scroll-target="#more-examples-of-counfoundingde-confounding">More examples of counfounding/de-confounding</a>
  <ul class="collapse">
  <li><a href="#unmeasured-causes" id="toc-unmeasured-causes" class="nav-link" data-scroll-target="#unmeasured-causes">Unmeasured causes</a></li>
  <li><a href="#what-is-the-relationship-between-smoking-and-cardiac-arrest" id="toc-what-is-the-relationship-between-smoking-and-cardiac-arrest" class="nav-link" data-scroll-target="#what-is-the-relationship-between-smoking-and-cardiac-arrest">What is the relationship between smoking and cardiac arrest?</a></li>
  <li><a href="#selection-bias-in-sampling" id="toc-selection-bias-in-sampling" class="nav-link" data-scroll-target="#selection-bias-in-sampling">Selection bias in sampling</a></li>
  <li><a href="#selection-bias-in-longitudinal-research" id="toc-selection-bias-in-longitudinal-research" class="nav-link" data-scroll-target="#selection-bias-in-longitudinal-research">Selection bias in longitudinal research</a></li>
  </ul></li>
  <li><a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow">Workflow</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  </ul></li>
  <li><a href="#collider-bias-within-experiments-1" id="toc-collider-bias-within-experiments-1" class="nav-link" data-scroll-target="#collider-bias-within-experiments-1">Collider bias within experiments</a></li>
  <li><a href="#taxonomy-of-confounding-1" id="toc-taxonomy-of-confounding-1" class="nav-link" data-scroll-target="#taxonomy-of-confounding-1">Taxonomy of confounding</a>
  <ul class="collapse">
  <li><a href="#the-fork-omitted-variable-bias-1" id="toc-the-fork-omitted-variable-bias-1" class="nav-link" data-scroll-target="#the-fork-omitted-variable-bias-1">The Fork (omitted variable bias)</a></li>
  <li><a href="#the-pipe-fully-mediated-effects-1" id="toc-the-pipe-fully-mediated-effects-1" class="nav-link" data-scroll-target="#the-pipe-fully-mediated-effects-1">The Pipe (fully mediated effects)</a></li>
  <li><a href="#the-collider-1" id="toc-the-collider-1" class="nav-link" data-scroll-target="#the-collider-1">The Collider</a></li>
  <li><a href="#confounding-by-proxy-1" id="toc-confounding-by-proxy-1" class="nav-link" data-scroll-target="#confounding-by-proxy-1">Confounding by proxy</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Causal Diagrams: The Structures of Interaction/Effect Modification, Measurement Bias, Selection Bias</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Required</strong></p>
<ul>
<li><p><span class="citation" data-cites="bulbulia2023">(<a href="#ref-bulbulia2023" role="doc-biblioref">Bulbulia 2024</a>)</span> <a href="https://www.cambridge.org/core/journals/evolutionary-human-sciences/article/methods-in-causal-inference-part-1-causal-diagrams-and-confounding/E734F72109F1BE99836E268DF3AA0359">link</a></p></li>
<li><p>see <a href="https://osf.io/preprints/psyarxiv/tbjx8_v1">simplified reading</a></p></li>
</ul>
<p><strong>Optional</strong></p>
<ul>
<li><span class="citation" data-cites="hernan2024WHATIF">(<a href="#ref-hernan2024WHATIF" role="doc-biblioref">Hernan and Robins 2020</a>)</span> Chapter 6-9 <a href="https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&amp;dl=0">link</a></li>
<li><span class="citation" data-cites="hernan2004STRUCTURAL">(<a href="#ref-hernan2004STRUCTURAL" role="doc-biblioref">Miguel A. Hernán, Hernández-Díaz, and Robins 2004</a>)</span> <a href="https://www.dropbox.com/scl/fi/qni0y1lstntmdw410m2nh/Heran2004StructuralSelectionBias.pdf?rlkey=0ob86mmx7vscxqmn3ipg9m94f&amp;dl=0">link</a></li>
<li><span class="citation" data-cites="hernan2017SELECTIONWITHOUTCOLLIDER">(<a href="#ref-hernan2017SELECTIONWITHOUTCOLLIDER" role="doc-biblioref">M. A. Hernán 2017</a>)</span> <a href="https://www.dropbox.com/scl/fi/zr3tk7ngsutjprqr18bbg/hernan-selection-without-colliders.pdf?rlkey=vfluyl3a7zksfphqepao04fix&amp;dl=0">link</a></li>
<li><span class="citation" data-cites="hernan2009MEASUREMENT">(<a href="#ref-hernan2009MEASUREMENT" role="doc-biblioref">Miguel A. Hernán and Cole 2009</a>)</span> <a href="https://www.dropbox.com/scl/fi/ip8nil6uc5l0x9xw14mbr/hernan_cole_Measure_causal_diagrams.pdf?rlkey=wkj3ayen8xb6ncog46sps2g49&amp;dl=0">link</a></li>
<li><span class="citation" data-cites="vanderweele2012MEASUREMENT">(<a href="#ref-vanderweele2012MEASUREMENT" role="doc-biblioref">VanderWeele and Hernán 2012</a>)</span> <a href="https://www.dropbox.com/scl/fi/wtqoibuyitdwm5nlpjuu7/vander_hernan_measurement_error_vanderweel.pdf?rlkey=e4znxaqdfzf2vg6sj4ui799bb&amp;dl=0">link</a></li>
</ul>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="ref-vanderweele2012MEASUREMENT" class="csl-entry" role="listitem">
VanderWeele, Tyler J., and Miguel A. Hernán. 2012. <span>“Results on Differential and Dependent Measurement Error of the Exposure and the Outcome Using Signed Directed Acyclic Graphs.”</span> <em>American Journal of Epidemiology</em> 175 (12): 1303–10. <a href="https://doi.org/10.1093/aje/kwr458">https://doi.org/10.1093/aje/kwr458</a>.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-hernan2009MEASUREMENT" class="csl-entry" role="listitem">
Hernán, Miguel A., and Stephen R. Cole. 2009. <span>“Invited Commentary: Causal Diagrams and Measurement Bias.”</span> <em>American Journal of Epidemiology</em> 170 (8): 959–62. <a href="https://doi.org/10.1093/aje/kwp293">https://doi.org/10.1093/aje/kwp293</a>.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-hernan2017SELECTIONWITHOUTCOLLIDER" class="csl-entry" role="listitem">
Hernán, M. A. 2017. <span>“Invited Commentary: Selection Bias Without Colliders | American Journal of Epidemiology | Oxford Academic.”</span> <em>American Journal of Epidemiology</em> 185 (11): 1048–50. <a href="https://doi.org/10.1093/aje/kwx077">https://doi.org/10.1093/aje/kwx077</a>.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-hernan2004STRUCTURAL" class="csl-entry" role="listitem">
Hernán, Miguel A., Sonia Hernández-Díaz, and James M. Robins. 2004. <span>“A Structural Approach to Selection Bias.”</span> <em>Epidemiology</em> 15 (5): 615–25. <a href="https://www.jstor.org/stable/20485961">https://www.jstor.org/stable/20485961</a>.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-hernan2024WHATIF" class="csl-entry" role="listitem">
Hernan, M. A., and J. M. Robins. 2020. <em>Causal Inference: What If?</em> Chapman &amp; Hall/CRC Monographs on Statistics &amp; Applied Probab. Taylor &amp; Francis. <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/</a>.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-bulbulia2023" class="csl-entry" role="listitem">
Bulbulia, J. A. 2024. <span>“Methods in Causal Inference Part 1: Causal Diagrams and Confounding.”</span> <em>Evolutionary Human Sciences</em> 6: e40. <a href="https://doi.org/10.1017/ehs.2024.35">https://doi.org/10.1017/ehs.2024.35</a>.
</div></div><div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Key concepts:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>effect (measure) modification</strong></li>
<li><strong>undirected/uncorrelated measurement error bias</strong></li>
<li><strong>undirected/correlated measurement error bias</strong></li>
<li><strong>directed/uncorrelated measurement error bias</strong></li>
<li><strong>directed/correlated measurement error bias</strong></li>
<li><strong>selection bias and transportability</strong></li>
</ul>
</div>
</div>
<section id="exploring-bias" class="level1 page-columns page-full">
<h1>Exploring Bias</h1>
<section id="load-libraries" class="level2">
<h2 class="anchored" data-anchor-id="load-libraries">Load libraries</h2>
<p>We can use the <code>ggdag</code> package to evaluate confounding .</p>
<section id="omitted-variable-bias-causal-graph" class="level3">
<h3 class="anchored" data-anchor-id="omitted-variable-bias-causal-graph">Omitted Variable Bias Causal Graph</h3>
<p>Let’s use <code>ggdag</code> to identify confounding arising from omitting Z in our regression of X on Y.</p>
<p>First we write out the DAG as follows:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code for creating a DAG</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>graph_fork <span class="ot">&lt;-</span> <span class="fu">dagify</span>(Y <span class="sc">~</span> L,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                   A <span class="sc">~</span> L,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">exposure =</span> <span class="st">"A"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">outcome =</span> <span class="st">"Y"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"tree"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the DAG</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>graph_fork <span class="sc">|&gt;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>() <span class="sc">+</span> <span class="fu">theme_dag_blank</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"L is a common cause of A and Y"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Next we ask <code>ggdag</code> which variables we need to include if we are to obtain an unbiased estimate of the outcome from the exposure:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use this code</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>( graph_fork ) <span class="sc">+</span>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"{L} is the exclusive member of the confounder set for A and Y. Conditioning on L 'd-separates' A and Y "</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The causal graph tells us to obtain an unbiased estimate of A on Y we must condition on L.</p>
<p>And indeed, when we included the omitted variable L in our simulated dateset it breaks the association between X and Y:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># confounder</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># A is caused by </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">rnorm</span>(N, L)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Y draws randomly from L but is not caused by A</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">rnorm</span>(N, L)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># note we did not need to make a data frame</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># regress Y on A without control</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>fit_fork  <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># A is "significant</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_fork)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   | Coefficient |   SE |        95% CI | t(998) |      p
------------------------------------------------------------------
(Intercept) |       -0.03 | 0.04 | [-0.11, 0.04] |  -0.89 | 0.373 
A           |        0.50 | 0.03 | [ 0.45, 0.54] |  19.72 | &lt; .001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed
  using a Wald t-distribution approximation.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regress Y on A with control</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fit_fork_controlled  <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A <span class="sc">+</span> L)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A and Y are no longer associated, conditioning worked.</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_fork_controlled)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   | Coefficient |   SE |        95% CI | t(997) |      p
------------------------------------------------------------------
(Intercept) |       -0.02 | 0.03 | [-0.08, 0.04] |  -0.68 | 0.499 
A           |        0.03 | 0.03 | [-0.03, 0.09] |   0.89 | 0.372 
L           |        0.95 | 0.05 | [ 0.86, 1.04] |  20.77 | &lt; .001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed
  using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section>
</section>
<section id="mediation-and-causation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="mediation-and-causation">Mediation and causation</h2>
<p>Suppose we were interested in the causal effect of X on Y. We have a direct effect of X on Y as well as an indirect effect of X on Y through M. We use <code>ggdag</code> to draw the DAG:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>graph_mediation <span class="ot">&lt;-</span> <span class="fu">dagify</span>(Y <span class="sc">~</span>  M,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                 M <span class="sc">~</span> A,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">exposure =</span> <span class="st">"A"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">outcome =</span> <span class="st">"Y"</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  ggdag<span class="sc">::</span><span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"tree"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>graph_mediation <span class="sc">|&gt;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>() <span class="sc">+</span>   </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mediation Graph"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here is another way</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>graph_mediation_full <span class="ot">&lt;-</span> <span class="fu">ggdag_mediation_triangle</span>(<span class="at">x =</span> <span class="st">"A"</span>, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">"Y"</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">m =</span> <span class="st">"M"</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x_y_associated =</span> <span class="cn">FALSE</span>) </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>graph_mediation_full <span class="sc">+</span>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fully Mediated Graph"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What should we condition on if we are interested in the causal effect of changes in X on changes in Y?</p>
<p>We can pose the question to <code>ggdag</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ask ggdag which variables to condition on:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>(graph_fork)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>‘Backdoor Paths Unconditionally Closed’ means that, assuming the DAG we have drawn is correct, we may obtain an unbiased estimate of X on Y without including additional variables.</p>
<p>Later we shall understand why this is the case.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;We shall see there is no “backdoor path” from X to Y that would bias our estimate, hence the estimate X-&gt;Y is an unbiased causal estimate – again, conditional on our DAG.</p></div></div><p>For now, we can enrich our language for causal inference by considering the concept of <code>d-connected</code> and <code>d-separated</code>:</p>
<p>Two variables are <code>d-connected</code> if information flows between them (condional on the graph), and they are <code>d-separated</code> if they are conditionally independent of each other.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use this code to examine d-connectedness</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_dconnected</span>(graph_mediation)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this case, d-connection is a good thing because we can estimate the causal effect of A on Y.</p>
<p>In other cases, d-connection will spoil the model. We have seen this for omitted variable bias. A and Y are d-separated conditional on L, and that’s our motivation for including L. These concepts are tricky, but they get easier with practice.</p>
<p>To add some grit to our exploration of mediation lets simulate data that are consistent with our mediation DAG</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)<span class="co"># sim x</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N , x) <span class="co"># sim X -&gt; M</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N , x <span class="sc">+</span> m) <span class="co"># sim M -&gt; Y</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, m, y)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">x_s =</span> <span class="fu">scale</span>(x),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">m_s =</span> <span class="fu">scale</span>(m))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>First we ask, is X is related to Y?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fit_mediation <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x_s, <span class="at">data =</span> df)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_mediation)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   | Coefficient |   SE |        95% CI | t(98) |      p
-----------------------------------------------------------------
(Intercept) |        0.19 | 0.14 | [-0.08, 0.47] |  1.41 | 0.161 
x s         |        1.66 | 0.14 | [ 1.38, 1.93] | 12.00 | &lt; .001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed
  using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>Yes.</p>
<p>Next we ask, is A related to Y conditional on M?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fit_total_mediated_effect <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x_s <span class="sc">+</span> m_s, <span class="at">data =</span> df)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_total_mediated_effect) <span class="sc">|&gt;</span> parameters<span class="sc">::</span><span class="fu">print_html</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="pikksjwbyf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pikksjwbyf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pikksjwbyf thead, #pikksjwbyf tbody, #pikksjwbyf tfoot, #pikksjwbyf tr, #pikksjwbyf td, #pikksjwbyf th {
  border-style: none;
}

#pikksjwbyf p {
  margin: 0;
  padding: 0;
}

#pikksjwbyf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 100%;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pikksjwbyf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pikksjwbyf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pikksjwbyf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pikksjwbyf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pikksjwbyf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pikksjwbyf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pikksjwbyf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pikksjwbyf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pikksjwbyf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pikksjwbyf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pikksjwbyf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pikksjwbyf .gt_spanner_row {
  border-bottom-style: hidden;
}

#pikksjwbyf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pikksjwbyf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pikksjwbyf .gt_from_md > :first-child {
  margin-top: 0;
}

#pikksjwbyf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pikksjwbyf .gt_row {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pikksjwbyf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pikksjwbyf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pikksjwbyf .gt_row_group_first td {
  border-top-width: 2px;
}

#pikksjwbyf .gt_row_group_first th {
  border-top-width: 2px;
}

#pikksjwbyf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pikksjwbyf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pikksjwbyf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pikksjwbyf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pikksjwbyf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pikksjwbyf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pikksjwbyf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pikksjwbyf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pikksjwbyf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pikksjwbyf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pikksjwbyf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pikksjwbyf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pikksjwbyf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pikksjwbyf .gt_left {
  text-align: left;
}

#pikksjwbyf .gt_center {
  text-align: center;
}

#pikksjwbyf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pikksjwbyf .gt_font_normal {
  font-weight: normal;
}

#pikksjwbyf .gt_font_bold {
  font-weight: bold;
}

#pikksjwbyf .gt_font_italic {
  font-style: italic;
}

#pikksjwbyf .gt_super {
  font-size: 65%;
}

#pikksjwbyf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pikksjwbyf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pikksjwbyf .gt_indent_1 {
  text-indent: 5px;
}

#pikksjwbyf .gt_indent_2 {
  text-indent: 10px;
}

#pikksjwbyf .gt_indent_3 {
  text-indent: 15px;
}

#pikksjwbyf .gt_indent_4 {
  text-indent: 20px;
}

#pikksjwbyf .gt_indent_5 {
  text-indent: 25px;
}

#pikksjwbyf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pikksjwbyf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Parameter" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Parameter</th>
<th id="Coefficient" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Coefficient</th>
<th id="SE" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">SE</th>
<th id="a95%-CI" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI</th>
<th id="t(97)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">t(97)</th>
<th id="p" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">p</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Parameter" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3">(Intercept)</td>
<td class="gt_row gt_center" headers="Coefficient">0.19</td>
<td class="gt_row gt_center" headers="SE">0.10</td>
<td class="gt_row gt_center" headers="95% CI">(4.92e-03, 0.38)</td>
<td class="gt_row gt_center" headers="t(97)">2.04</td>
<td class="gt_row gt_center" headers="p">0.044</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Parameter" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3">x s</td>
<td class="gt_row gt_center" headers="Coefficient">0.77</td>
<td class="gt_row gt_center" headers="SE">0.13</td>
<td class="gt_row gt_center" headers="95% CI">(0.51, 1.02)</td>
<td class="gt_row gt_center" headers="t(97)">6.00</td>
<td class="gt_row gt_center" headers="p">&lt; .001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Parameter" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3">m s</td>
<td class="gt_row gt_center" headers="Coefficient">1.33</td>
<td class="gt_row gt_center" headers="SE">0.13</td>
<td class="gt_row gt_center" headers="95% CI">(1.07, 1.58)</td>
<td class="gt_row gt_center" headers="t(97)">10.34</td>
<td class="gt_row gt_center" headers="p">&lt; .001</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Yes, but notice this is a different question. The effect of X is attenuated because M contributes to the causal effect of Y.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fit_total_effect <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x_s, <span class="at">data =</span> df)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_total_effect) <span class="sc">|&gt;</span> parameters<span class="sc">::</span><span class="fu">print_html</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="tnnfrbxhku" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tnnfrbxhku table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tnnfrbxhku thead, #tnnfrbxhku tbody, #tnnfrbxhku tfoot, #tnnfrbxhku tr, #tnnfrbxhku td, #tnnfrbxhku th {
  border-style: none;
}

#tnnfrbxhku p {
  margin: 0;
  padding: 0;
}

#tnnfrbxhku .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 100%;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tnnfrbxhku .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tnnfrbxhku .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tnnfrbxhku .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tnnfrbxhku .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tnnfrbxhku .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tnnfrbxhku .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tnnfrbxhku .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tnnfrbxhku .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tnnfrbxhku .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tnnfrbxhku .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tnnfrbxhku .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tnnfrbxhku .gt_spanner_row {
  border-bottom-style: hidden;
}

#tnnfrbxhku .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tnnfrbxhku .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tnnfrbxhku .gt_from_md > :first-child {
  margin-top: 0;
}

#tnnfrbxhku .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tnnfrbxhku .gt_row {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tnnfrbxhku .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tnnfrbxhku .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tnnfrbxhku .gt_row_group_first td {
  border-top-width: 2px;
}

#tnnfrbxhku .gt_row_group_first th {
  border-top-width: 2px;
}

#tnnfrbxhku .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnnfrbxhku .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tnnfrbxhku .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tnnfrbxhku .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tnnfrbxhku .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnnfrbxhku .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tnnfrbxhku .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tnnfrbxhku .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tnnfrbxhku .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tnnfrbxhku .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tnnfrbxhku .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnnfrbxhku .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tnnfrbxhku .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnnfrbxhku .gt_left {
  text-align: left;
}

#tnnfrbxhku .gt_center {
  text-align: center;
}

#tnnfrbxhku .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tnnfrbxhku .gt_font_normal {
  font-weight: normal;
}

#tnnfrbxhku .gt_font_bold {
  font-weight: bold;
}

#tnnfrbxhku .gt_font_italic {
  font-style: italic;
}

#tnnfrbxhku .gt_super {
  font-size: 65%;
}

#tnnfrbxhku .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tnnfrbxhku .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tnnfrbxhku .gt_indent_1 {
  text-indent: 5px;
}

#tnnfrbxhku .gt_indent_2 {
  text-indent: 10px;
}

#tnnfrbxhku .gt_indent_3 {
  text-indent: 15px;
}

#tnnfrbxhku .gt_indent_4 {
  text-indent: 20px;
}

#tnnfrbxhku .gt_indent_5 {
  text-indent: 25px;
}

#tnnfrbxhku .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tnnfrbxhku div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Parameter" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Parameter</th>
<th id="Coefficient" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Coefficient</th>
<th id="SE" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">SE</th>
<th id="a95%-CI" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI</th>
<th id="t(98)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">t(98)</th>
<th id="p" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">p</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Parameter" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3">(Intercept)</td>
<td class="gt_row gt_center" headers="Coefficient">0.19</td>
<td class="gt_row gt_center" headers="SE">0.14</td>
<td class="gt_row gt_center" headers="95% CI">(-0.08, 0.47)</td>
<td class="gt_row gt_center" headers="t(98)">1.41</td>
<td class="gt_row gt_center" headers="p">0.161</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Parameter" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3">x s</td>
<td class="gt_row gt_center" headers="Coefficient">1.66</td>
<td class="gt_row gt_center" headers="SE">0.14</td>
<td class="gt_row gt_center" headers="95% CI">(1.38, 1.93)</td>
<td class="gt_row gt_center" headers="t(98)">12.00</td>
<td class="gt_row gt_center" headers="p">&lt; .001</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="pipe-confounding-full-mediation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="pipe-confounding-full-mediation">Pipe confounding (full mediation)</h2>
<p>Suppose we are interested in the effect of x on y, in a scenario when m fully mediates the relationship of x on y.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mediation_triangle</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_y_associated =</span> <span class="cn">FALSE</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What variables do we need to include to obtain an unbiased estimate of X on Y?</p>
<p>Let’s fill out this example out by imagining an experiment.</p>
<p>Suppose we want to know whether a ritual action condition (X) influences charity (Y). We have good reason to assume the effect of X on Y happens <em>entirely</em> through perceived social cohesion (M):</p>
<p>X<span class="math inline">\to</span>M<span class="math inline">\to</span>Z or ritual <span class="math inline">\to</span> social cohesion <span class="math inline">\to</span> charity</p>
<p>Lets simulate some data</p>
<div class="cell page-columns page-full">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Participants</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># initial charitable giving</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>c0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N ,<span class="dv">10</span> ,<span class="dv">2</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># assign treatments and simulate charitable giving and increase in social cohesion</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>ritual <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span> , <span class="at">each =</span> N<span class="sc">/</span><span class="dv">2</span> )</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>cohesion <span class="ot">&lt;-</span> ritual <span class="sc">*</span> <span class="fu">rnorm</span>(N,.<span class="dv">5</span>,.<span class="dv">2</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># increase in charity</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> c0 <span class="sc">+</span> ritual <span class="sc">*</span> cohesion </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># dataframe</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">c0 =</span> c0 , </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">c1=</span>c1 , </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ritual =</span> ritual , </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cohesion =</span> cohesion )</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(d)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display page-columns page-full">
<table class="table table-sm table-striped small">

<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">d</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption">Data summary</div><p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">c0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10.18</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">5.38</td>
<td style="text-align: right;">9.01</td>
<td style="text-align: right;">10.12</td>
<td style="text-align: right;">11.38</td>
<td style="text-align: right;">14.37</td>
<td style="text-align: left;">▁▃▇▅▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">c1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10.43</td>
<td style="text-align: right;">1.85</td>
<td style="text-align: right;">5.89</td>
<td style="text-align: right;">9.17</td>
<td style="text-align: right;">10.30</td>
<td style="text-align: right;">11.57</td>
<td style="text-align: right;">14.99</td>
<td style="text-align: left;">▂▆▇▆▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ritual</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">cohesion</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: left;">▇▃▃▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Does the ritual increase charity?</p>
<p>If we only include the ritual condition in the model, we find that ritual condition reliable predicts increases in charitable giving:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(c1 <span class="sc">~</span>  c0 <span class="sc">+</span> ritual, <span class="at">data =</span> d)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   | Coefficient |       SE |        95% CI |  t(97) |      p
----------------------------------------------------------------------
(Intercept) |        0.08 |     0.08 | [-0.07, 0.23] |   1.05 | 0.297 
c0          |        0.99 | 7.26e-03 | [ 0.98, 1.01] | 136.74 | &lt; .001
ritual      |        0.51 |     0.03 | [ 0.46, 0.56] |  19.33 | &lt; .001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed
  using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>Does the ritual increase charity adjusting for levels of social cohesion?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(c1 <span class="sc">~</span>  c0 <span class="sc">+</span> ritual <span class="sc">+</span> cohesion, <span class="at">data =</span> d)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   | Coefficient |       SE |         95% CI |    t(96) |      p
-------------------------------------------------------------------------
(Intercept) |   -5.94e-15 | 6.11e-16 | [ 0.00,  0.00] |    -9.72 | &lt; .001
c0          |        1.00 | 5.89e-17 | [ 1.00,  1.00] | 1.70e+16 | &lt; .001
ritual      |    3.80e-16 | 4.68e-16 | [ 0.00,  0.00] |     0.81 | 0.419 
cohesion    |        1.00 | 8.19e-16 | [ 1.00,  1.00] | 1.22e+15 | &lt; .001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed
  using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>The answer is that the (direct) effect of ritual entirely drops out when we include both ritual and social cohesion. Why is this? The answer is that once our model knows <code>m</code> it does not obtain any new information by knowing <code>x</code>.</p>
<p>If we were interested in assessing x<span class="math inline">\to</span>y but x were to effect y through m (i.e x<span class="math inline">\to</span>m<span class="math inline">\to</span>y) then conditioning on m would <strong>block the path</strong> from x<span class="math inline">\to</span>y. Including m leads to <strong>Pipe Confounding</strong>.</p>
<p>In experiments we should never condition on a post-treatment variable.</p>
</section>
<section id="masked-relationships" class="level2">
<h2 class="anchored" data-anchor-id="masked-relationships">Masked relationships</h2>
<p>Imagine two variables were to affect an outcome. Both are correlated with each other. One affects the outcome positively and the other affects the outcome negatively. How shall we investigate the causal role of the focal predictor?</p>
<p>Consider two correlated variables that jointly predict Political conservatism (C), religion (R). Imagine that one variable has a positive effect and the other has a negative effect on distress (K6).</p>
<p>First consider this relationship, where conservatism causes religion</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>dag_m1 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(K <span class="sc">~</span> C <span class="sc">+</span> R,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                 R <span class="sc">~</span> C,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">exposure =</span> <span class="st">"C"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">outcome =</span> <span class="st">"K"</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"tree"</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>dag_m1<span class="sc">|&gt;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can simulate the data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># C -&gt; K &lt;- R</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># C -&gt; R</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n )</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n , C )</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n , R <span class="sc">-</span> C )</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>d_sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K=</span>K,<span class="at">R=</span>R,<span class="at">C=</span>C)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>First we only condition on conservatism</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ms1 <span class="ot">&lt;-</span> parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(K  <span class="sc">~</span> C, <span class="at">data =</span> d_sim)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ms1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ms1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   | Coefficient |   SE |        95% CI | t(98) |     p
----------------------------------------------------------------
(Intercept) |        0.03 | 0.14 | [-0.24, 0.30] |  0.22 | 0.829
C           |       -0.19 | 0.15 | [-0.49, 0.11] | -1.24 | 0.219</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed
  using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>Next, only religion:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ms2<span class="ot">&lt;-</span> parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(K  <span class="sc">~</span> R, <span class="at">data =</span> d_sim)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ms2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When we add both C and R, we see them “pop” in opposite directions, as is typical of masking:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ms3<span class="ot">&lt;-</span> parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(K  <span class="sc">~</span> C <span class="sc">+</span> R, <span class="at">data =</span> d_sim)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ms3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that when you ask <code>ggdag</code> to assess how to obtain an unbiased estimate of C on K it will tell you you don’t need to condition on R.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>dag_m1<span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_adjustment_set</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Yet recall when we just assessed the relationship of C on K we got this:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ms1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Is the DAG wrong?</p>
<p>No.&nbsp;The fact that C<span class="math inline">\to</span>R is positive and R<span class="math inline">\to</span>K is negative means that if we were to increase C, we wouldn’t reliably increase K. The total effect of C just isn’t reliable</p>
</section>
<section id="collider-confounding" class="level2">
<h2 class="anchored" data-anchor-id="collider-confounding">Collider Confounding</h2>
<p>The selection-distortion effect (Berkson’s paradox)</p>
<p>This example is from the book <strong>Statistical Rethinking</strong>. Imagine in science there is no relationship between the newsworthiness of science and its trustworthiness. Imagine further that selection committees make decisions on the basis of the both newsworthiness and the trustworthiness of scientific proposals.</p>
<p>This presents us with the following graph</p>
<div class="cell" data-code_folding="true">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="ot">&lt;-</span> <span class="fu">dagify</span>(S <span class="sc">~</span> N,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                 S <span class="sc">~</span> T,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"S"</span> <span class="ot">=</span> <span class="st">"Selection"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"N"</span> <span class="ot">=</span> <span class="st">"Newsworthy"</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"T"</span> <span class="ot">=</span> <span class="st">"Trustworthy"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"nicely"</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="sc">|&gt;</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>(<span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels =</span> <span class="st">"label"</span>) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When two arrows enter into an variable, it opens a path of information between the two variables.</p>
<p>Very often this openning of information has disasterous implications. <em>In the human sciences, included variable bias is a woefully underrated problem</em>.</p>
<div class="cell" data-code_folding="true">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_dseparated</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  dag_sd,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="st">"T"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="st">"N"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">controlling_for =</span> <span class="st">"S"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels =</span> <span class="st">"label"</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can use the <code>ggdag package</code> to find colliders among our variables:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code for finding colliders</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_collider</span>(dag_sd,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The following simulation (by Solomon Kurz) illustrates the selection-distortion effect, which Richard McElreath discusses in <em>Statistical Rethinking</em>:</p>
<p>First simulated uncorrelated variables and a process of selection for sub-populations score high on both indicators.</p>
<div class="cell" data-code_folding="true">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate selection distortion effect, following Solomon Kurz</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://bookdown.org/content/4857/the-haunted-dag-the-causal-terror.html</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># number of grant proposals</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># proportion to select</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># uncorrelated newsworthiness and trustworthiness</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">newsworthiness  =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">trustworthiness =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># total_score</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_score =</span> newsworthiness <span class="sc">+</span> trustworthiness) <span class="sc">|&gt;</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select top 10% of combined scores</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">ifelse</span>(total_score <span class="sc">&gt;=</span> <span class="fu">quantile</span>(total_score, <span class="dv">1</span> <span class="sc">-</span> p), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next filter out the high scoring examples, and assess their correlation.</p>
<p>Note that the act of selection <em>induces</em> a correlation within our dataset.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(selected <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(newsworthiness, trustworthiness) <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                newsworthiness trustworthiness
newsworthiness       1.0000000      -0.7318408
trustworthiness     -0.7318408       1.0000000</code></pre>
</div>
</div>
<p>This makes it seems as if there is a relationship between Trustworthiness and Newsworthiness in science, even when there isn’t any.</p>
<div class="cell" data-code_folding="true">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we'll need this for the annotation</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">newsworthiness  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trustworthiness =</span> <span class="fu">c</span>(<span class="fl">2.25</span>, <span class="sc">-</span><span class="fl">2.5</span>),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">selected        =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">label           =</span> <span class="fu">c</span>(<span class="st">"selected"</span>, <span class="st">"rejected"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> newsworthiness, <span class="at">y =</span> trustworthiness, <span class="at">color =</span> selected)) <span class="sc">+</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> selected), <span class="at">alpha =</span> <span class="dv">3</span> <span class="sc">/</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d <span class="sc">|&gt;</span> <span class="fu">filter</span>(selected <span class="sc">==</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">fullrange =</span> T,</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> F,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = c("black", "lightblue")) +</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">3.9</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(d<span class="sc">$</span>trustworthiness)) <span class="sc">+</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">"Newsworthy"</span>) <span class="sc">+</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"Trustworthy"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Once we know a proposal has been selected, if it is newsworthy we can predict that it is less trustworthy. Our simulation produces this prediction even though we simulated a world in which there is no relationship between trustworthiness and newsworthiness.</p>
<p>Selection bias is commonplace.</p>
</section>
<section id="collider-bias-within-experiments" class="level2">
<h2 class="anchored" data-anchor-id="collider-bias-within-experiments">Collider bias within experiments</h2>
<p>We noted that conditioning on a post-treatment variable can induce bias by blocking the path between the experimental manipulation and the outcome. However, such conditioning can open a path even when there is no experimental effect.</p>
<div class="cell" data-code_folding="true">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> C0 <span class="sc">+</span> U,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  Ch <span class="sc">~</span> U <span class="sc">+</span> R,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R"</span> <span class="ot">=</span> <span class="st">"Ritual"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C1"</span> <span class="ot">=</span> <span class="st">"Charity-post"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C0"</span> <span class="ot">=</span> <span class="st">"Charity-pre"</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ch"</span> <span class="ot">=</span> <span class="st">"Cohesion"</span>,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"U"</span> <span class="ot">=</span> <span class="st">"Religiousness (Unmeasured)"</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"R"</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"C1"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"U"</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="fu">c</span>(<span class="st">"Ch"</span>,<span class="st">"C0"</span>))  </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="sc">|&gt;</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>( <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>How do we avoid collider-bias here?</p>
<p>Note what happens if we condition on cohesion?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_collider</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Cohesion is a collider that opens a path from ritual to charity"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Don’t condition on a post-treatment variable!</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>dag_ex3 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> C0,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> U,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  Ch <span class="sc">~</span> U <span class="sc">+</span> R,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R"</span> <span class="ot">=</span> <span class="st">"Ritual"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C1"</span> <span class="ot">=</span> <span class="st">"Charity-post"</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C0"</span> <span class="ot">=</span> <span class="st">"Charity-pre"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ch"</span> <span class="ot">=</span> <span class="st">"Cohesion"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"U"</span> <span class="ot">=</span> <span class="st">"Religiousness (Unmeasured)"</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"R"</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"C1"</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"U"</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_adjustment_set</span>(dag_ex3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="taxonomy-of-confounding" class="level2">
<h2 class="anchored" data-anchor-id="taxonomy-of-confounding">Taxonomy of confounding</h2>
<p>There is good news. Remember, ultimately are only four basic types of confounding:</p>
<section id="the-fork-omitted-variable-bias" class="level3">
<h3 class="anchored" data-anchor-id="the-fork-omitted-variable-bias">The Fork (omitted variable bias)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confounder_triangle</span>(<span class="at">x =</span> <span class="st">"Coffee"</span>,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="st">"Lung Cancer"</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">z =</span> <span class="st">"Smoking"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dconnected</span>(<span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-pipe-fully-mediated-effects" class="level3">
<h3 class="anchored" data-anchor-id="the-pipe-fully-mediated-effects">The Pipe (fully mediated effects)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mediation_triangle</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="cn">NULL</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_y_associated =</span> <span class="cn">FALSE</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-collider" class="level3">
<h3 class="anchored" data-anchor-id="the-collider">The Collider</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collider_triangle</span>() <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dseparated</span>(<span class="at">controlling_for =</span> <span class="st">"m"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="confounding-by-proxy" class="level3">
<h3 class="anchored" data-anchor-id="confounding-by-proxy">Confounding by proxy</h3>
<p>If we “control for” a descendant of a collider, we will introduce collider bias.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  Z <span class="sc">~</span> X,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  Z <span class="sc">~</span> Y,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  D <span class="sc">~</span> Z,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Z"</span> <span class="ot">=</span> <span class="st">"Collider"</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"D"</span> <span class="ot">=</span> <span class="st">"Descendant"</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X"</span> <span class="ot">=</span> <span class="st">"X"</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y"</span> <span class="ot">=</span> <span class="st">"Y"</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"X"</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"Y"</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="st">"D"</span>) </span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="sc">|&gt;</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dseparated</span>(</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="st">"X"</span>,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="st">"Y"</span>,</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">controlling_for =</span> <span class="st">"D"</span>,</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"X --&gt; Y, controlling for D"</span>,</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="st">"D induces collider bias"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="rules-for-avoiding-confounding" class="level2">
<h2 class="anchored" data-anchor-id="rules-for-avoiding-confounding">Rules for avoiding confounding</h2>
<p>From <em>Statistical Rethinking</em>, p.286</p>
<blockquote class="blockquote">
<p>List all of the paths connecting X (the potential cause of interest) and Y (the outcome).</p>
</blockquote>
<blockquote class="blockquote">
<p>Classify each path by whether it is open or closed. A path is open unless it contains a collider.</p>
</blockquote>
<blockquote class="blockquote">
<p>Classify each path by whether it is a backdoor path. A backdoor path has an arrow entering X.</p>
</blockquote>
<blockquote class="blockquote">
<p>If there are any open backdoor paths, decide which variable(s) to condition on to close it (if possible).</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examle</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># call ggdag model</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write relationships:</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>dg_1 <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">dagify</span>(</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  b <span class="sc">~</span>  im <span class="sc">+</span> ordr <span class="sc">+</span> rel <span class="sc">+</span> sr  <span class="sc">+</span> st,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  rel <span class="sc">~</span>  age <span class="sc">+</span> ses <span class="sc">+</span> edu <span class="sc">+</span> male <span class="sc">+</span> cny,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  ses <span class="sc">~</span> cny <span class="sc">+</span> edu <span class="sc">+</span> age,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  edu <span class="sc">~</span> cny <span class="sc">+</span> male <span class="sc">+</span> age,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  im <span class="sc">~</span> mem <span class="sc">+</span> rel <span class="sc">+</span> cny,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  mem <span class="sc">~</span> age <span class="sc">+</span> edu <span class="sc">+</span> ordr,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"sr"</span>,</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"b"</span>,</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b"</span> <span class="ot">=</span> <span class="st">"statement credibility"</span>,</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sr"</span> <span class="ot">=</span> <span class="st">"source"</span>,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"st"</span> <span class="ot">=</span> <span class="st">"statement"</span>,</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"im"</span> <span class="ot">=</span> <span class="st">"importance"</span>,</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mem"</span> <span class="ot">=</span> <span class="st">"memory"</span>,</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s"</span> <span class="ot">=</span> <span class="st">"source"</span>,</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rel"</span> <span class="ot">=</span> <span class="st">"religious"</span>,</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cny"</span> <span class="ot">=</span> <span class="st">"country"</span>,</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mem"</span> <span class="ot">=</span> <span class="st">"memory"</span>,</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"male"</span> <span class="ot">=</span> <span class="st">"male"</span>,</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ordr"</span> <span class="ot">=</span> <span class="st">"presentation order"</span>,</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ses"</span> <span class="ot">=</span> <span class="st">"perceived SES"</span>,</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"edu"</span> <span class="ot">=</span> <span class="st">"education"</span>,</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"age"</span> <span class="ot">=</span> <span class="st">"age"</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="st">"rel"</span>)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_collider</span>(dg_1, <span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note the colliders induced from the “controls” that we had included in the study:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">ggdag_dseparated</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  dg_1,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="st">"sr"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="st">"b"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">controlling_for =</span> <span class="fu">c</span>(<span class="st">"ses"</span>, <span class="st">"age"</span>, <span class="st">"cny"</span>, <span class="st">"im"</span>, <span class="st">"edu"</span>, <span class="st">"mem"</span>, <span class="st">"male"</span>, <span class="st">"rel"</span>),</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels  =</span> <span class="st">"label"</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Collider Confounding occurs when we `control for` a bunch of variables"</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>p3</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>How do we fix the problem? Think hard about the causal network and let <code>ggdag</code> do the work.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find adjustment set</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>(dg_1,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">use_labels  =</span> <span class="st">"label"</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Adjustment set"</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtite =</span> <span class="st">"Model for Source credibility from belief "</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Ignoring unknown labels:
• subtite : "Model for Source credibility from belief "</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inference-depends-on-assumptions-that-are-not-contained-in-the-data." class="level2">
<h2 class="anchored" data-anchor-id="inference-depends-on-assumptions-that-are-not-contained-in-the-data.">Inference depends on assumptions that are not contained in the data.</h2>
<blockquote class="blockquote">
<p>regression itself does not provide the evidence you need to justify a causal model. Instead, you need some science.” – Richard McElreath: “Statistical Rethinking, Chapter 6”</p>
</blockquote>
<blockquote class="blockquote">
<p>“…the data alone can never tell you which causal model is correct”- Richard McElreath: “Statistical Rethinking” Chapter 5</p>
</blockquote>
<blockquote class="blockquote">
<p>“The parameter estimates will always depend upon what you believe about the causal model, because typically several (or very many) causal models are consistent with any one set of parameter estimates.” “Statistical Rethinking” Chapter 5</p>
</blockquote>
<p>Suppose we assume that the source condition affects religion, say through priming. We then have the following dag:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="do">## adding religion to effect on edu</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>dg_3 <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">dagify</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  b <span class="sc">~</span>  im <span class="sc">+</span> ordr <span class="sc">+</span> rel  <span class="sc">+</span> st <span class="sc">+</span> sr,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  rel <span class="sc">~</span>  age <span class="sc">+</span> ses <span class="sc">+</span> edu <span class="sc">+</span> male <span class="sc">+</span> cny <span class="sc">+</span> sr,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  ses <span class="sc">~</span> cny <span class="sc">+</span> edu <span class="sc">+</span> age,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  edu <span class="sc">~</span> cny <span class="sc">+</span> male <span class="sc">+</span> age,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  im <span class="sc">~</span> mem <span class="sc">+</span> rel <span class="sc">+</span> cny,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  mem <span class="sc">~</span> age <span class="sc">+</span> edu <span class="sc">+</span> ordr,</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"rel"</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"b"</span>,</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b"</span> <span class="ot">=</span> <span class="st">"statement credibility"</span>,</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sr"</span> <span class="ot">=</span> <span class="st">"source"</span>,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"st"</span> <span class="ot">=</span> <span class="st">"statement"</span>,</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"im"</span> <span class="ot">=</span> <span class="st">"importance"</span>,</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mem"</span> <span class="ot">=</span> <span class="st">"memory"</span>,</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s"</span> <span class="ot">=</span> <span class="st">"source"</span>,</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rel"</span> <span class="ot">=</span> <span class="st">"religious"</span>,</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cny"</span> <span class="ot">=</span> <span class="st">"country"</span>,</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mem"</span> <span class="ot">=</span> <span class="st">"memory"</span>,</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"male"</span> <span class="ot">=</span> <span class="st">"male"</span>,</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ordr"</span> <span class="ot">=</span> <span class="st">"presentation order"</span>,</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ses"</span> <span class="ot">=</span> <span class="st">"perceived SES"</span>,</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"edu"</span> <span class="ot">=</span> <span class="st">"education"</span>,</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"age"</span> <span class="ot">=</span> <span class="st">"age"</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>)<span class="sc">|&gt;</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="st">"rel"</span>)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(dg_3, <span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels  =</span> <span class="st">"label"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We turn to our trusted oracle, and and ask: “What do we condition on to obtain an unbiased causal estimate?”</p>
<p>The oracle replies:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  dg_3,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"sr"</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"b"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels  =</span> <span class="st">"label"</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Adjustment set"</span>,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtite =</span> <span class="st">"Model for Source credibility from belief "</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dag_adjustment_sets(., exposure = exposure, outcome = outcome, : Failed to close backdoor paths. Common reasons include:
            * graph is not acyclic
            * backdoor paths are not closeable with given set of variables
            * necessary variables are unmeasured (latent)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Ignoring unknown labels:
• subtite : "Model for Source credibility from belief "</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Your data cannot answer your question.</p>
</section>
<section id="more-examples-of-counfoundingde-confounding" class="level2">
<h2 class="anchored" data-anchor-id="more-examples-of-counfoundingde-confounding">More examples of counfounding/de-confounding</h2>
<p>Here’s another example from recent NZAVS research</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>tidy_ggdag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  WB <span class="sc">~</span> belief <span class="sc">+</span> age_within <span class="sc">+</span> age_between <span class="sc">+</span> partner <span class="sc">+</span> nzdep <span class="sc">+</span> urban <span class="sc">+</span> male <span class="sc">+</span> pols <span class="sc">+</span> empl,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  WB <span class="sc">~</span><span class="er">~</span> partner,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  belief <span class="sc">~</span> age_within <span class="sc">+</span> age_between <span class="sc">+</span> male <span class="sc">+</span> ethn,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  partner <span class="sc">~</span> nzdep <span class="sc">+</span> age_within <span class="sc">+</span> age_between <span class="sc">+</span> belief, </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  nzdep <span class="sc">~</span> empl <span class="sc">+</span> age_within <span class="sc">+</span> age_between,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  pols <span class="sc">~</span> age_within <span class="sc">+</span> age_between <span class="sc">+</span> empl <span class="sc">+</span> ethn,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  empl <span class="sc">~</span>  edu <span class="sc">+</span> ethn <span class="sc">+</span> age_within <span class="sc">+</span> age_between,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span>  <span class="st">"belief"</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span>   <span class="st">"WB"</span>)<span class="sc">|&gt;</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>()</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>tidy_ggdag <span class="sc">|&gt;</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can examine which variables to select, conditional on the causal assumptions of this dag</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graph adjustment sets</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>(tidy_ggdag, <span class="at">node_size =</span> <span class="dv">14</span>) <span class="sc">+</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This method reveals two adjustments sets: {age, employment, male, political conservativism, and time}, and {age, ethnicty, male, and time.} We report the second set because employment is likely to contain more measurement error: some are not employed because they cannot find employment, others because they are not seeking employment (e.g. retirement).</p>
<section id="unmeasured-causes" class="level3">
<h3 class="anchored" data-anchor-id="unmeasured-causes">Unmeasured causes</h3>
<p>Return to the previous example of R and C on K6 distress, but imagine an underlying common cause of both C and R (say childhood upbringing) called “U”:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>dag_m3 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  K <span class="sc">~</span> C <span class="sc">+</span> R,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  C <span class="sc">~</span> U,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  R <span class="sc">~</span> U,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"C"</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"K"</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"U"</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"nicely"</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>dag_m3 <span class="sc">|&gt;</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>How do we assess the relationship of C on K?</p>
<p>We can close the backdoor from U through R by conditioning on R</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>(dag_m3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Aside, we can simulate this relationship using the following code:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># C -&gt; K &lt;- R</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># C &lt;- U -&gt; R</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n )</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n , U )</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n , U )</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n , R <span class="sc">-</span> C )</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>d_sim3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> K, <span class="at">R =</span> R, <span class="at">U =</span> U, <span class="at">C =</span> C )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="what-is-the-relationship-between-smoking-and-cardiac-arrest" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-relationship-between-smoking-and-cardiac-arrest">What is the relationship between smoking and cardiac arrest?</h3>
<p>This example is from the <code>ggdag</code> package, by Malcolm Barrett <a href="https://ggdag.malco.io/">here</a></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>smoking_ca_dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  cardiacarrest <span class="sc">~</span> cholesterol,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  cholesterol <span class="sc">~</span> smoking <span class="sc">+</span> weight,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  smoking <span class="sc">~</span> unhealthy,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  weight <span class="sc">~</span> unhealthy,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cardiacarrest"</span> <span class="ot">=</span> <span class="st">"Cardiac</span><span class="sc">\n</span><span class="st"> Arrest"</span>,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"smoking"</span> <span class="ot">=</span> <span class="st">"Smoking"</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cholesterol"</span> <span class="ot">=</span> <span class="st">"Cholesterol"</span>,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"unhealthy"</span> <span class="ot">=</span> <span class="st">"Unhealthy</span><span class="sc">\n</span><span class="st"> Lifestyle"</span>,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"weight"</span> <span class="ot">=</span> <span class="st">"Weight"</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"unhealthy"</span>,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"smoking"</span>,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"cardiacarrest"</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(smoking_ca_dag,</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What do we condition on to close any open backdoor paths, while avoiding colliders? We imagine that unhealthy lifestyle is unmeasured.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_adjustment_set</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  smoking_ca_dag,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels =</span> <span class="st">"label"</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What if we control for cholesterol?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_dseparated</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  smoking_ca_dag,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">controlling_for =</span> <span class="fu">c</span>(<span class="st">"weight"</span>, <span class="st">"cholesterol"</span>),</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels =</span> <span class="st">"label"</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">collider_lines =</span> <span class="cn">FALSE</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Controlling for intermediate variables may also induce bias, because it decomposes the total effect of x on y into its parts. (ggdag documentation)</p>
</blockquote>
</section>
<section id="selection-bias-in-sampling" class="level3">
<h3 class="anchored" data-anchor-id="selection-bias-in-sampling">Selection bias in sampling</h3>
<p>This example is from <a href="https://ggdag.malco.io/articles/bias-structures.html" class="uri">https://ggdag.malco.io/articles/bias-structures.html</a></p>
<blockquote class="blockquote">
<p>Let’s say we’re doing a case-control study and want to assess the effect of smoking on glioma, a type of brain cancer. We have a group of glioma patients at a hospital and want to compare them to a group of controls, so we pick people in the hospital with a broken bone, since that seems to have nothing to do with brain cancer. However, perhaps there is some unknown confounding between smoking and being in the hospital with a broken bone, like being prone to reckless behavior. In the normal population, there is no causal effect of smoking on glioma, but in our case, we’re selecting on people who have been hospitalized, which opens up a back-door path:</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>coords_mine <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>name,           <span class="sc">~</span>x,  <span class="sc">~</span>y,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"glioma"</span>,         <span class="dv">1</span>,   <span class="dv">2</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hospitalized"</span>,   <span class="dv">2</span>,   <span class="dv">3</span>,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"broken_bone"</span>,    <span class="dv">3</span>,   <span class="dv">2</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"reckless"</span>,       <span class="dv">4</span>,   <span class="dv">1</span>,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"smoking"</span>,        <span class="dv">5</span>,   <span class="dv">2</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(hospitalized <span class="sc">~</span> broken_bone <span class="sc">+</span> glioma,</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>       broken_bone <span class="sc">~</span> reckless,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>       smoking <span class="sc">~</span> reckless,</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">hospitalized =</span> <span class="st">"Hospitalization"</span>,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">broken_bone =</span> <span class="st">"Broken Bone"</span>,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">glioma =</span> <span class="st">"Glioma"</span>,</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reckless =</span> <span class="st">"Reckless </span><span class="sc">\n</span><span class="st">Behavior"</span>,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">smoking =</span> <span class="st">"Smoking"</span>),</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> coords_mine) <span class="sc">|&gt;</span> </span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dconnected</span>(<span class="st">"glioma"</span>, <span class="st">"smoking"</span>, <span class="at">controlling_for =</span> <span class="st">"hospitalized"</span>, </span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels =</span> <span class="st">"label"</span>, <span class="at">collider_lines =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Even though smoking doesn’t actually cause glioma, it will appear as if there is an association. Actually, in this case, it may make smoking appear to be protective against glioma, since controls are more likely to be smokers.</p>
</blockquote>
</section>
<section id="selection-bias-in-longitudinal-research" class="level3">
<h3 class="anchored" data-anchor-id="selection-bias-in-longitudinal-research">Selection bias in longitudinal research</h3>
<p>Suppose we want to estimate the effect of ethnicity on ecological orientation in a longitudinal dataset where there is selection bias from homeownership (it is easier to reach homeowners by the mail.)</p>
<p>Suppose the following DAG:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>dag_sel <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  retained <span class="sc">~</span> homeowner,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  homeowner <span class="sc">~</span> income <span class="sc">+</span> ethnicity,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  ecologicalvalues <span class="sc">~</span>  ethnicity <span class="sc">+</span> income,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">retained =</span> <span class="st">"retained"</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">homeowner =</span> <span class="st">"homeowner"</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ethnicity =</span> <span class="st">"ethnicity"</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">income =</span> <span class="st">"income"</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecologicalvalues =</span> <span class="st">"Ecological </span><span class="sc">\n</span><span class="st"> Orientation"</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"ethnicity"</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"ecologicalvalues"</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="st">"retained"</span>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>dag_sel <span class="sc">|&gt;</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_adjust</span>(</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"retained"</span>,</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">layout =</span> <span class="st">"mds"</span>,</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>,</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">collider_lines =</span> <span class="cn">FALSE</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Notice that “retained” falls downstream from a collider, “home ownership”</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_collider</span>(dag_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Because we are stratifying on “retained”, we introduce collider bias in our estimate of ethnicity on ecological values.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_dseparated</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  dag_sel,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">controlling_for =</span> <span class="st">"retained"</span>,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels =</span> <span class="st">"label"</span>,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">collider_lines =</span> <span class="cn">TRUE</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>However we have an adjustment set</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_adjustment_set</span>(dag_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="workflow" class="level2">
<h2 class="anchored" data-anchor-id="workflow">Workflow</h2>
<ol type="1">
<li>Import your data</li>
<li>Check that data types are correct</li>
<li>Graph your data</li>
<li>Consider your question</li>
<li>If causal, draw your DAG/S</li>
<li>Explain your DAG’s</li>
<li>Write your model</li>
<li>Run your model</li>
<li>Graph and interpret your results</li>
<li>Return to your question, and assess what you have learned.</li>
</ol>
<p>(Typically there are multiple iterations between these steps in your workflow. Annotate your scripts; keep track of your decisions)</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li>We control for variables to avoid omitted variable bias</li>
<li>Omitted variable bias is real, but also commonplace is included variable bias</li>
<li>Included variable biases arise from “pipes”, “colliders”, and conditioning on descendant of colliders.</li>
<li>The <code>ggdag</code> package can help you to obtain causal inference, but it relies on assumptions that are not part of your data.</li>
<li>Clarify your assumption.</li>
</ul>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - Barrett M (2024). _ggdag: Analyze and Create Elegant Directed Acyclic Graphs_. doi:10.32614/CRAN.package.ggdag &lt;https://doi.org/10.32614/CRAN.package.ggdag&gt;, R package version 0.2.13, &lt;https://CRAN.R-project.org/package=ggdag&gt;.
  - Chang W (2023). _extrafont: Tools for Using Fonts_. doi:10.32614/CRAN.package.extrafont &lt;https://doi.org/10.32614/CRAN.package.extrafont&gt;, R package version 0.19, &lt;https://CRAN.R-project.org/package=extrafont&gt;.
  - Grolemund G, Wickham H (2011). "Dates and Times Made Easy with lubridate." _Journal of Statistical Software_, *40*(3), 1-25. &lt;https://www.jstatsoft.org/v40/i03/&gt;.
  - Lüdecke D, Patil I, Ben-Shachar M, Wiernik B, Waggoner P, Makowski D (2021). "see: An R Package for Visualizing Statistical Models." _Journal of Open Source Software_, *6*(64), 3393. doi:10.21105/joss.03393 &lt;https://doi.org/10.21105/joss.03393&gt;.
  - Müller K, Wickham H (2025). _tibble: Simple Data Frames_. doi:10.32614/CRAN.package.tibble &lt;https://doi.org/10.32614/CRAN.package.tibble&gt;, R package version 3.3.0, &lt;https://CRAN.R-project.org/package=tibble&gt;.
  - R Core Team (2025). _R: A Language and Environment for Statistical Computing_. R Foundation for Statistical Computing, Vienna, Austria. &lt;https://www.R-project.org/&gt;.
  - Wickham H (2016). _ggplot2: Elegant Graphics for Data Analysis_. Springer-Verlag New York. ISBN 978-3-319-24277-4, &lt;https://ggplot2.tidyverse.org&gt;.
  - Wickham H (2025). _forcats: Tools for Working with Categorical Variables (Factors)_. doi:10.32614/CRAN.package.forcats &lt;https://doi.org/10.32614/CRAN.package.forcats&gt;, R package version 1.0.1, &lt;https://CRAN.R-project.org/package=forcats&gt;.
  - Wickham H (2025). _stringr: Simple, Consistent Wrappers for Common String Operations_. doi:10.32614/CRAN.package.stringr &lt;https://doi.org/10.32614/CRAN.package.stringr&gt;, R package version 1.5.2, &lt;https://CRAN.R-project.org/package=stringr&gt;.
  - Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). "Welcome to the tidyverse." _Journal of Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686 &lt;https://doi.org/10.21105/joss.01686&gt;.
  - Wickham H, François R, Henry L, Müller K, Vaughan D (2023). _dplyr: A Grammar of Data Manipulation_. doi:10.32614/CRAN.package.dplyr &lt;https://doi.org/10.32614/CRAN.package.dplyr&gt;, R package version 1.1.4, &lt;https://CRAN.R-project.org/package=dplyr&gt;.
  - Wickham H, Henry L (2025). _purrr: Functional Programming Tools_. doi:10.32614/CRAN.package.purrr &lt;https://doi.org/10.32614/CRAN.package.purrr&gt;, R package version 1.1.0, &lt;https://CRAN.R-project.org/package=purrr&gt;.
  - Wickham H, Hester J, Bryan J (2024). _readr: Read Rectangular Text Data_. doi:10.32614/CRAN.package.readr &lt;https://doi.org/10.32614/CRAN.package.readr&gt;, R package version 2.1.5, &lt;https://CRAN.R-project.org/package=readr&gt;.
  - Wickham H, Vaughan D, Girlich M (2024). _tidyr: Tidy Messy Data_. doi:10.32614/CRAN.package.tidyr &lt;https://doi.org/10.32614/CRAN.package.tidyr&gt;, R package version 1.3.1, &lt;https://CRAN.R-project.org/package=tidyr&gt;.
  - Xie Y (2025). _tinytex: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents_. R package version 0.57, &lt;https://github.com/rstudio/tinytex&gt;. Xie Y (2019). "TinyTeX: A lightweight, cross-platform, and easy-to-maintain LaTeX distribution based on TeX Live." _TUGboat_, *40*(1), 30-32. &lt;https://tug.org/TUGboat/Contents/contents40-1.html&gt;.</code></pre>
</div>
</div>
<section id="other-material" class="level4">
<h4 class="anchored" data-anchor-id="other-material">OTHER MATERIAL:</h4>
<p>Selection bias is commonplace.</p>
</section>
</section>
</section>
<section id="collider-bias-within-experiments-1" class="level2">
<h2 class="anchored" data-anchor-id="collider-bias-within-experiments-1">Collider bias within experiments</h2>
<p>We noted that conditioning on a post-treatment variable can induce bias by blocking the path between the experimental manipulation and the outcome. However, such conditioning can open a path even when there is no experimental effect.</p>
<div class="cell" data-code_folding="true">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> C0 <span class="sc">+</span> U,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  Ch <span class="sc">~</span> U <span class="sc">+</span> R,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R"</span> <span class="ot">=</span> <span class="st">"Ritual"</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C1"</span> <span class="ot">=</span> <span class="st">"Charity-post"</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C0"</span> <span class="ot">=</span> <span class="st">"Charity-pre"</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ch"</span> <span class="ot">=</span> <span class="st">"Cohesion"</span>,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"U"</span> <span class="ot">=</span> <span class="st">"Religiousness (Unmeasured)"</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"R"</span>,</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"C1"</span>,</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"U"</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="fu">c</span>(<span class="st">"Ch"</span>,<span class="st">"C0"</span>))  </span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="sc">|&gt;</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>( <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>How do we avoid collider-bias here?</p>
<p>Note what happens if we condition on cohesion?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="sc">|&gt;</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_collider</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Cohesion is a collider that opens a path from ritual to charity"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Don’t condition on a post-treatment variable!</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>dag_ex3 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> C0,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> U,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  Ch <span class="sc">~</span> U <span class="sc">+</span> R,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R"</span> <span class="ot">=</span> <span class="st">"Ritual"</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C1"</span> <span class="ot">=</span> <span class="st">"Charity-post"</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C0"</span> <span class="ot">=</span> <span class="st">"Charity-pre"</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ch"</span> <span class="ot">=</span> <span class="st">"Cohesion"</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"U"</span> <span class="ot">=</span> <span class="st">"Religiousness (Unmeasured)"</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"R"</span>,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"C1"</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"U"</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_adjustment_set</span>(dag_ex3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="taxonomy-of-confounding-1" class="level2">
<h2 class="anchored" data-anchor-id="taxonomy-of-confounding-1">Taxonomy of confounding</h2>
<p>There is good news. Remember, ultimately are only four basic types of confounding:</p>
<section id="the-fork-omitted-variable-bias-1" class="level3">
<h3 class="anchored" data-anchor-id="the-fork-omitted-variable-bias-1">The Fork (omitted variable bias)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confounder_triangle</span>(<span class="at">x =</span> <span class="st">"Coffee"</span>,</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="st">"Lung Cancer"</span>,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">z =</span> <span class="st">"Smoking"</span>) <span class="sc">|&gt;</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dconnected</span>(<span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-pipe-fully-mediated-effects-1" class="level3">
<h3 class="anchored" data-anchor-id="the-pipe-fully-mediated-effects-1">The Pipe (fully mediated effects)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mediation_triangle</span>(</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="cn">NULL</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_y_associated =</span> <span class="cn">FALSE</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">|&gt;</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-collider-1" class="level3">
<h3 class="anchored" data-anchor-id="the-collider-1">The Collider</h3>
</section>
<section id="confounding-by-proxy-1" class="level3">
<h3 class="anchored" data-anchor-id="confounding-by-proxy-1">Confounding by proxy</h3>
<p>If we “control for” a descendant of a collider, we will introduce collider bias.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  Z <span class="sc">~</span> X,</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  Z <span class="sc">~</span> Y,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  D <span class="sc">~</span> Z,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Z"</span> <span class="ot">=</span> <span class="st">"Collider"</span>,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"D"</span> <span class="ot">=</span> <span class="st">"Descendant"</span>,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X"</span> <span class="ot">=</span> <span class="st">"X"</span>,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y"</span> <span class="ot">=</span> <span class="st">"Y"</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"X"</span>,</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"Y"</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="st">"D"</span>) </span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="sc">|&gt;</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dseparated</span>(</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="st">"X"</span>,</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="st">"Y"</span>,</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">controlling_for =</span> <span class="st">"D"</span>,</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"X --&gt; Y, controlling for D"</span>,</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="st">"D induces collider bias"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggdag-examples_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<!-- -->


</section>
</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb82" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Causal Diagrams: The Structures of Interaction/Effect Modification, Measurement Bias, Selection Bias"</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-NOV-119"</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> /Users/joseph/GIT/templates/bib/references.bib</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="co">    warnings: false</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co">    error: false</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="co">    messages: false</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: dracula</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools:</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: false</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="an">html-math-method:</span><span class="co"> katex</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a><span class="an">citation-location:</span><span class="co"> margin</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a><span class="an">cap-location:</span><span class="co"> margin</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a><span class="an">code-block-border-left:</span><span class="co"> true</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/libs2.R")</span></span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/funs.R")</span></span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">ALERT</span><span class="co">: UNCOMMENT THIS AND DOWNLOAD THE FUNCTIONS FROM JB's GITHUB</span></span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a><span class="co"># source(</span></span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   "https://raw.githubusercontent.com/go-bayes/templates/main/functions/experimental_funs.R"</span></span>
<span id="cb82-40"><a href="#cb82-40" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb82-41"><a href="#cb82-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-42"><a href="#cb82-42" aria-hidden="true" tabindex="-1"></a><span class="co"># source(</span></span>
<span id="cb82-43"><a href="#cb82-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   "https://raw.githubusercontent.com/go-bayes/templates/main/functions/experimental_funs.R"</span></span>
<span id="cb82-44"><a href="#cb82-44" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb82-45"><a href="#cb82-45" aria-hidden="true" tabindex="-1"></a><span class="co"># for making graphs</span></span>
<span id="cb82-46"><a href="#cb82-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb82-47"><a href="#cb82-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"extrafont"</span>)</span>
<span id="cb82-48"><a href="#cb82-48" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"all"</span>)</span>
<span id="cb82-49"><a href="#cb82-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-50"><a href="#cb82-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-51"><a href="#cb82-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-52"><a href="#cb82-52" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb82-53"><a href="#cb82-53" aria-hidden="true" tabindex="-1"></a>**Required**</span>
<span id="cb82-54"><a href="#cb82-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-55"><a href="#cb82-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@bulbulia2023</span><span class="co">] [link]</span>(https://www.cambridge.org/core/journals/evolutionary-human-sciences/article/methods-in-causal-inference-part-1-causal-diagrams-and-confounding/E734F72109F1BE99836E268DF3AA0359)</span>
<span id="cb82-56"><a href="#cb82-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-57"><a href="#cb82-57" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>see <span class="co">[</span><span class="ot">simplified reading</span><span class="co">](https://osf.io/preprints/psyarxiv/tbjx8_v1)</span></span>
<span id="cb82-58"><a href="#cb82-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-59"><a href="#cb82-59" aria-hidden="true" tabindex="-1"></a>**Optional**</span>
<span id="cb82-60"><a href="#cb82-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-61"><a href="#cb82-61" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@hernan2024WHATIF</span><span class="co">]</span> Chapter 6-9 <span class="co">[</span><span class="ot">link</span><span class="co">](https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&amp;dl=0)</span></span>
<span id="cb82-62"><a href="#cb82-62" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@hernan2004STRUCTURAL</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/qni0y1lstntmdw410m2nh/Heran2004StructuralSelectionBias.pdf?rlkey=0ob86mmx7vscxqmn3ipg9m94f&amp;dl=0)</span>
<span id="cb82-63"><a href="#cb82-63" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@hernan2017SELECTIONWITHOUTCOLLIDER</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/zr3tk7ngsutjprqr18bbg/hernan-selection-without-colliders.pdf?rlkey=vfluyl3a7zksfphqepao04fix&amp;dl=0)</span>
<span id="cb82-64"><a href="#cb82-64" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@hernan2009MEASUREMENT</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/ip8nil6uc5l0x9xw14mbr/hernan_cole_Measure_causal_diagrams.pdf?rlkey=wkj3ayen8xb6ncog46sps2g49&amp;dl=0)</span>
<span id="cb82-65"><a href="#cb82-65" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@vanderweele2012MEASUREMENT</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/wtqoibuyitdwm5nlpjuu7/vander_hernan_measurement_error_vanderweel.pdf?rlkey=e4znxaqdfzf2vg6sj4ui799bb&amp;dl=0)</span>
<span id="cb82-66"><a href="#cb82-66" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb82-67"><a href="#cb82-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-68"><a href="#cb82-68" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb82-69"><a href="#cb82-69" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key concepts:</span></span>
<span id="cb82-70"><a href="#cb82-70" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**effect (measure) modification**</span>
<span id="cb82-71"><a href="#cb82-71" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**undirected/uncorrelated measurement error bias**</span>
<span id="cb82-72"><a href="#cb82-72" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**undirected/correlated measurement error bias**</span>
<span id="cb82-73"><a href="#cb82-73" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**directed/uncorrelated measurement error bias**</span>
<span id="cb82-74"><a href="#cb82-74" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**directed/correlated measurement error bias**</span>
<span id="cb82-75"><a href="#cb82-75" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**selection bias and transportability**</span>
<span id="cb82-76"><a href="#cb82-76" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb82-77"><a href="#cb82-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-78"><a href="#cb82-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-79"><a href="#cb82-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-80"><a href="#cb82-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-81"><a href="#cb82-81" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploring Bias </span></span>
<span id="cb82-82"><a href="#cb82-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-83"><a href="#cb82-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load libraries</span></span>
<span id="cb82-84"><a href="#cb82-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-87"><a href="#cb82-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-88"><a href="#cb82-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb82-89"><a href="#cb82-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb82-90"><a href="#cb82-90" aria-hidden="true" tabindex="-1"></a><span class="co"># data-wrangling</span></span>
<span id="cb82-91"><a href="#cb82-91" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(tidyverse, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb82-92"><a href="#cb82-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb82-93"><a href="#cb82-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb82-94"><a href="#cb82-94" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-95"><a href="#cb82-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-96"><a href="#cb82-96" aria-hidden="true" tabindex="-1"></a><span class="co"># graphing </span></span>
<span id="cb82-97"><a href="#cb82-97" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggplot2, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb82-98"><a href="#cb82-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb82-99"><a href="#cb82-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb82-100"><a href="#cb82-100" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-101"><a href="#cb82-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-102"><a href="#cb82-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-103"><a href="#cb82-103" aria-hidden="true" tabindex="-1"></a><span class="co"># automated causal diagrams</span></span>
<span id="cb82-104"><a href="#cb82-104" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggdag, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb82-105"><a href="#cb82-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggdag"</span>)</span>
<span id="cb82-106"><a href="#cb82-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggdag)</span>
<span id="cb82-107"><a href="#cb82-107" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-108"><a href="#cb82-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-109"><a href="#cb82-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-110"><a href="#cb82-110" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggdag, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb82-111"><a href="#cb82-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"parameters"</span>)</span>
<span id="cb82-112"><a href="#cb82-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(parameters)</span>
<span id="cb82-113"><a href="#cb82-113" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-114"><a href="#cb82-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-115"><a href="#cb82-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-116"><a href="#cb82-116" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(see, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb82-117"><a href="#cb82-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"see"</span>)</span>
<span id="cb82-118"><a href="#cb82-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(see)</span>
<span id="cb82-119"><a href="#cb82-119" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-120"><a href="#cb82-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-121"><a href="#cb82-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-122"><a href="#cb82-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-123"><a href="#cb82-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-124"><a href="#cb82-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-125"><a href="#cb82-125" aria-hidden="true" tabindex="-1"></a>We can use the <span class="in">`ggdag`</span> package to evaluate confounding .</span>
<span id="cb82-126"><a href="#cb82-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-127"><a href="#cb82-127" aria-hidden="true" tabindex="-1"></a><span class="fu">### Omitted Variable Bias Causal Graph</span></span>
<span id="cb82-128"><a href="#cb82-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-129"><a href="#cb82-129" aria-hidden="true" tabindex="-1"></a>Let's use <span class="in">`ggdag`</span> to identify confounding arising from omitting Z in our regression of X on Y.</span>
<span id="cb82-130"><a href="#cb82-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-131"><a href="#cb82-131" aria-hidden="true" tabindex="-1"></a>First we write out the DAG as follows:</span>
<span id="cb82-132"><a href="#cb82-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-135"><a href="#cb82-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-136"><a href="#cb82-136" aria-hidden="true" tabindex="-1"></a><span class="co"># code for creating a DAG</span></span>
<span id="cb82-137"><a href="#cb82-137" aria-hidden="true" tabindex="-1"></a>graph_fork <span class="ot">&lt;-</span> <span class="fu">dagify</span>(Y <span class="sc">~</span> L,</span>
<span id="cb82-138"><a href="#cb82-138" aria-hidden="true" tabindex="-1"></a>                   A <span class="sc">~</span> L,</span>
<span id="cb82-139"><a href="#cb82-139" aria-hidden="true" tabindex="-1"></a>                   <span class="at">exposure =</span> <span class="st">"A"</span>,</span>
<span id="cb82-140"><a href="#cb82-140" aria-hidden="true" tabindex="-1"></a>                   <span class="at">outcome =</span> <span class="st">"Y"</span>) <span class="sc">|&gt;</span></span>
<span id="cb82-141"><a href="#cb82-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"tree"</span>)</span>
<span id="cb82-142"><a href="#cb82-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-143"><a href="#cb82-143" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the DAG</span></span>
<span id="cb82-144"><a href="#cb82-144" aria-hidden="true" tabindex="-1"></a>graph_fork <span class="sc">|&gt;</span></span>
<span id="cb82-145"><a href="#cb82-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>() <span class="sc">+</span> <span class="fu">theme_dag_blank</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"L is a common cause of A and Y"</span>)</span>
<span id="cb82-146"><a href="#cb82-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-147"><a href="#cb82-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-148"><a href="#cb82-148" aria-hidden="true" tabindex="-1"></a>Next we ask <span class="in">`ggdag`</span> which variables we need to include if we are to obtain an unbiased estimate of the outcome from the exposure:</span>
<span id="cb82-149"><a href="#cb82-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-152"><a href="#cb82-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-153"><a href="#cb82-153" aria-hidden="true" tabindex="-1"></a><span class="co"># use this code</span></span>
<span id="cb82-154"><a href="#cb82-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-155"><a href="#cb82-155" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>( graph_fork ) <span class="sc">+</span>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"{L} is the exclusive member of the confounder set for A and Y. Conditioning on L 'd-separates' A and Y "</span>)</span>
<span id="cb82-156"><a href="#cb82-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-157"><a href="#cb82-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-158"><a href="#cb82-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-159"><a href="#cb82-159" aria-hidden="true" tabindex="-1"></a>The causal graph tells us to obtain an unbiased estimate of A on Y we must condition on L.</span>
<span id="cb82-160"><a href="#cb82-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-161"><a href="#cb82-161" aria-hidden="true" tabindex="-1"></a>And indeed, when we included the omitted variable L in our simulated dateset it breaks the association between X and Y:</span>
<span id="cb82-162"><a href="#cb82-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-165"><a href="#cb82-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-166"><a href="#cb82-166" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb82-167"><a href="#cb82-167" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb82-168"><a href="#cb82-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-169"><a href="#cb82-169" aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations</span></span>
<span id="cb82-170"><a href="#cb82-170" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb82-171"><a href="#cb82-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-172"><a href="#cb82-172" aria-hidden="true" tabindex="-1"></a><span class="co"># confounder</span></span>
<span id="cb82-173"><a href="#cb82-173" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb82-174"><a href="#cb82-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-175"><a href="#cb82-175" aria-hidden="true" tabindex="-1"></a><span class="co"># A is caused by </span></span>
<span id="cb82-176"><a href="#cb82-176" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">rnorm</span>(N, L)</span>
<span id="cb82-177"><a href="#cb82-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-178"><a href="#cb82-178" aria-hidden="true" tabindex="-1"></a><span class="co"># Y draws randomly from L but is not caused by A</span></span>
<span id="cb82-179"><a href="#cb82-179" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">rnorm</span>(N, L)</span>
<span id="cb82-180"><a href="#cb82-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-181"><a href="#cb82-181" aria-hidden="true" tabindex="-1"></a><span class="co"># note we did not need to make a data frame</span></span>
<span id="cb82-182"><a href="#cb82-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-183"><a href="#cb82-183" aria-hidden="true" tabindex="-1"></a><span class="co"># regress Y on A without control</span></span>
<span id="cb82-184"><a href="#cb82-184" aria-hidden="true" tabindex="-1"></a>fit_fork  <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A)</span>
<span id="cb82-185"><a href="#cb82-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-186"><a href="#cb82-186" aria-hidden="true" tabindex="-1"></a><span class="co"># A is "significant</span></span>
<span id="cb82-187"><a href="#cb82-187" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_fork)</span>
<span id="cb82-188"><a href="#cb82-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-189"><a href="#cb82-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-190"><a href="#cb82-190" aria-hidden="true" tabindex="-1"></a><span class="co"># regress Y on A with control</span></span>
<span id="cb82-191"><a href="#cb82-191" aria-hidden="true" tabindex="-1"></a>fit_fork_controlled  <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A <span class="sc">+</span> L)</span>
<span id="cb82-192"><a href="#cb82-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-193"><a href="#cb82-193" aria-hidden="true" tabindex="-1"></a><span class="co"># A and Y are no longer associated, conditioning worked.</span></span>
<span id="cb82-194"><a href="#cb82-194" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_fork_controlled)</span>
<span id="cb82-195"><a href="#cb82-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-196"><a href="#cb82-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-197"><a href="#cb82-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-198"><a href="#cb82-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-199"><a href="#cb82-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-200"><a href="#cb82-200" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mediation and causation</span></span>
<span id="cb82-201"><a href="#cb82-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-202"><a href="#cb82-202" aria-hidden="true" tabindex="-1"></a>Suppose we were interested in the causal effect of X on Y.  We have a direct effect of X on Y as well as an indirect effect of X on Y through M. We use <span class="in">`ggdag`</span> to draw the DAG:</span>
<span id="cb82-203"><a href="#cb82-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-204"><a href="#cb82-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-207"><a href="#cb82-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-208"><a href="#cb82-208" aria-hidden="true" tabindex="-1"></a>graph_mediation <span class="ot">&lt;-</span> <span class="fu">dagify</span>(Y <span class="sc">~</span>  M,</span>
<span id="cb82-209"><a href="#cb82-209" aria-hidden="true" tabindex="-1"></a>                 M <span class="sc">~</span> A,</span>
<span id="cb82-210"><a href="#cb82-210" aria-hidden="true" tabindex="-1"></a>                <span class="at">exposure =</span> <span class="st">"A"</span>,</span>
<span id="cb82-211"><a href="#cb82-211" aria-hidden="true" tabindex="-1"></a>                <span class="at">outcome =</span> <span class="st">"Y"</span>) <span class="sc">|&gt;</span></span>
<span id="cb82-212"><a href="#cb82-212" aria-hidden="true" tabindex="-1"></a>  ggdag<span class="sc">::</span><span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"tree"</span>)</span>
<span id="cb82-213"><a href="#cb82-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-214"><a href="#cb82-214" aria-hidden="true" tabindex="-1"></a>graph_mediation <span class="sc">|&gt;</span></span>
<span id="cb82-215"><a href="#cb82-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>() <span class="sc">+</span>   </span>
<span id="cb82-216"><a href="#cb82-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span> </span>
<span id="cb82-217"><a href="#cb82-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mediation Graph"</span>)</span>
<span id="cb82-218"><a href="#cb82-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-219"><a href="#cb82-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-220"><a href="#cb82-220" aria-hidden="true" tabindex="-1"></a>Here is another way</span>
<span id="cb82-221"><a href="#cb82-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-224"><a href="#cb82-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-225"><a href="#cb82-225" aria-hidden="true" tabindex="-1"></a>graph_mediation_full <span class="ot">&lt;-</span> <span class="fu">ggdag_mediation_triangle</span>(<span class="at">x =</span> <span class="st">"A"</span>, </span>
<span id="cb82-226"><a href="#cb82-226" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">"Y"</span>, </span>
<span id="cb82-227"><a href="#cb82-227" aria-hidden="true" tabindex="-1"></a>                         <span class="at">m =</span> <span class="st">"M"</span>, </span>
<span id="cb82-228"><a href="#cb82-228" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x_y_associated =</span> <span class="cn">FALSE</span>) </span>
<span id="cb82-229"><a href="#cb82-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-230"><a href="#cb82-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-231"><a href="#cb82-231" aria-hidden="true" tabindex="-1"></a>graph_mediation_full <span class="sc">+</span>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span> </span>
<span id="cb82-232"><a href="#cb82-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fully Mediated Graph"</span>)</span>
<span id="cb82-233"><a href="#cb82-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-234"><a href="#cb82-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-235"><a href="#cb82-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-236"><a href="#cb82-236" aria-hidden="true" tabindex="-1"></a>What should we condition on if we are interested in the causal effect of changes in X on changes in Y?</span>
<span id="cb82-237"><a href="#cb82-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-238"><a href="#cb82-238" aria-hidden="true" tabindex="-1"></a>We can pose the question to <span class="in">`ggdag`</span>:</span>
<span id="cb82-239"><a href="#cb82-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-242"><a href="#cb82-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-243"><a href="#cb82-243" aria-hidden="true" tabindex="-1"></a><span class="co"># ask ggdag which variables to condition on:</span></span>
<span id="cb82-244"><a href="#cb82-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-245"><a href="#cb82-245" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>(graph_fork)</span>
<span id="cb82-246"><a href="#cb82-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-247"><a href="#cb82-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-248"><a href="#cb82-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-249"><a href="#cb82-249" aria-hidden="true" tabindex="-1"></a>'Backdoor Paths Unconditionally Closed' means that, assuming the DAG we have drawn is correct, we may obtain an unbiased estimate of X on Y without including additional variables. </span>
<span id="cb82-250"><a href="#cb82-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-251"><a href="#cb82-251" aria-hidden="true" tabindex="-1"></a>Later we shall understand why this is the case.^<span class="co">[</span><span class="ot">We shall see there is no "backdoor path" from X to Y that would bias our estimate, hence the estimate X-&gt;Y is an unbiased causal estimate -- again, conditional on our DAG.</span><span class="co">]</span></span>
<span id="cb82-252"><a href="#cb82-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-253"><a href="#cb82-253" aria-hidden="true" tabindex="-1"></a>For now, we can enrich our language for causal inference by considering the concept of <span class="in">`d-connected`</span> and <span class="in">`d-separated`</span>:</span>
<span id="cb82-254"><a href="#cb82-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-255"><a href="#cb82-255" aria-hidden="true" tabindex="-1"></a>Two variables are <span class="in">`d-connected`</span> if information flows between them (condional on the graph), and they are <span class="in">`d-separated`</span> if they are conditionally independent of each other.</span>
<span id="cb82-256"><a href="#cb82-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-259"><a href="#cb82-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-260"><a href="#cb82-260" aria-hidden="true" tabindex="-1"></a><span class="co"># use this code to examine d-connectedness</span></span>
<span id="cb82-261"><a href="#cb82-261" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_dconnected</span>(graph_mediation)</span>
<span id="cb82-262"><a href="#cb82-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-263"><a href="#cb82-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-264"><a href="#cb82-264" aria-hidden="true" tabindex="-1"></a>In this case, d-connection is a good thing because we can estimate the causal effect of A on Y. </span>
<span id="cb82-265"><a href="#cb82-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-266"><a href="#cb82-266" aria-hidden="true" tabindex="-1"></a>In other cases, d-connection will spoil the model. We have seen this for omitted variable bias. A and Y are d-separated conditional on L, and that's our motivation for including L. These concepts are tricky, but they get easier with practice. </span>
<span id="cb82-267"><a href="#cb82-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-268"><a href="#cb82-268" aria-hidden="true" tabindex="-1"></a>To add some grit to our exploration of mediation lets simulate data that are consistent with our mediation DAG</span>
<span id="cb82-269"><a href="#cb82-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-270"><a href="#cb82-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-271"><a href="#cb82-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE, include = TRUE}</span></span>
<span id="cb82-272"><a href="#cb82-272" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb82-273"><a href="#cb82-273" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb82-274"><a href="#cb82-274" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)<span class="co"># sim x</span></span>
<span id="cb82-275"><a href="#cb82-275" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N , x) <span class="co"># sim X -&gt; M</span></span>
<span id="cb82-276"><a href="#cb82-276" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N , x <span class="sc">+</span> m) <span class="co"># sim M -&gt; Y</span></span>
<span id="cb82-277"><a href="#cb82-277" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, m, y)</span>
<span id="cb82-278"><a href="#cb82-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-279"><a href="#cb82-279" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb82-280"><a href="#cb82-280" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">x_s =</span> <span class="fu">scale</span>(x),</span>
<span id="cb82-281"><a href="#cb82-281" aria-hidden="true" tabindex="-1"></a>                <span class="at">m_s =</span> <span class="fu">scale</span>(m))</span>
<span id="cb82-282"><a href="#cb82-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-283"><a href="#cb82-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-284"><a href="#cb82-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-285"><a href="#cb82-285" aria-hidden="true" tabindex="-1"></a>First we ask, is X is related to Y?</span>
<span id="cb82-286"><a href="#cb82-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-289"><a href="#cb82-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-290"><a href="#cb82-290" aria-hidden="true" tabindex="-1"></a>fit_mediation <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x_s, <span class="at">data =</span> df)</span>
<span id="cb82-291"><a href="#cb82-291" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_mediation)</span>
<span id="cb82-292"><a href="#cb82-292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-293"><a href="#cb82-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-294"><a href="#cb82-294" aria-hidden="true" tabindex="-1"></a>Yes.</span>
<span id="cb82-295"><a href="#cb82-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-296"><a href="#cb82-296" aria-hidden="true" tabindex="-1"></a>Next we ask, is A related to Y conditional on M? </span>
<span id="cb82-297"><a href="#cb82-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-300"><a href="#cb82-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-301"><a href="#cb82-301" aria-hidden="true" tabindex="-1"></a>fit_total_mediated_effect <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x_s <span class="sc">+</span> m_s, <span class="at">data =</span> df)</span>
<span id="cb82-302"><a href="#cb82-302" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_total_mediated_effect) <span class="sc">|&gt;</span> parameters<span class="sc">::</span><span class="fu">print_html</span>()</span>
<span id="cb82-303"><a href="#cb82-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-304"><a href="#cb82-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-305"><a href="#cb82-305" aria-hidden="true" tabindex="-1"></a>Yes, but notice this is a different question. The effect of X is attenuated because M contributes to the causal effect of Y. </span>
<span id="cb82-306"><a href="#cb82-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-307"><a href="#cb82-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-310"><a href="#cb82-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-311"><a href="#cb82-311" aria-hidden="true" tabindex="-1"></a>fit_total_effect <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x_s, <span class="at">data =</span> df)</span>
<span id="cb82-312"><a href="#cb82-312" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_total_effect) <span class="sc">|&gt;</span> parameters<span class="sc">::</span><span class="fu">print_html</span>()</span>
<span id="cb82-313"><a href="#cb82-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-314"><a href="#cb82-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-315"><a href="#cb82-315" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pipe confounding (full mediation)</span></span>
<span id="cb82-316"><a href="#cb82-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-317"><a href="#cb82-317" aria-hidden="true" tabindex="-1"></a>Suppose we are interested in the effect of x on y, in a scenario when m fully mediates the relationship of x on y.</span>
<span id="cb82-318"><a href="#cb82-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-321"><a href="#cb82-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-322"><a href="#cb82-322" aria-hidden="true" tabindex="-1"></a><span class="fu">mediation_triangle</span>(</span>
<span id="cb82-323"><a href="#cb82-323" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb82-324"><a href="#cb82-324" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb82-325"><a href="#cb82-325" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="cn">NULL</span>,</span>
<span id="cb82-326"><a href="#cb82-326" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_y_associated =</span> <span class="cn">FALSE</span></span>
<span id="cb82-327"><a href="#cb82-327" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb82-328"><a href="#cb82-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span>
<span id="cb82-329"><a href="#cb82-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-330"><a href="#cb82-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-331"><a href="#cb82-331" aria-hidden="true" tabindex="-1"></a>What variables do we need to include to obtain an unbiased estimate of X on Y?</span>
<span id="cb82-332"><a href="#cb82-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-333"><a href="#cb82-333" aria-hidden="true" tabindex="-1"></a>Let's fill out this example out by imagining an experiment. </span>
<span id="cb82-334"><a href="#cb82-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-335"><a href="#cb82-335" aria-hidden="true" tabindex="-1"></a>Suppose we want to know whether a ritual action condition (X) influences charity (Y). We have good reason to assume the effect of X on Y happens *entirely* through perceived social cohesion (M):  </span>
<span id="cb82-336"><a href="#cb82-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-337"><a href="#cb82-337" aria-hidden="true" tabindex="-1"></a>X$\to$M$\to$Z or </span>
<span id="cb82-338"><a href="#cb82-338" aria-hidden="true" tabindex="-1"></a>ritual $\to$ social cohesion $\to$ charity</span>
<span id="cb82-339"><a href="#cb82-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-340"><a href="#cb82-340" aria-hidden="true" tabindex="-1"></a>Lets simulate some data</span>
<span id="cb82-341"><a href="#cb82-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-344"><a href="#cb82-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-345"><a href="#cb82-345" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb82-346"><a href="#cb82-346" aria-hidden="true" tabindex="-1"></a><span class="co"># Participants</span></span>
<span id="cb82-347"><a href="#cb82-347" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb82-348"><a href="#cb82-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-349"><a href="#cb82-349" aria-hidden="true" tabindex="-1"></a><span class="co"># initial charitable giving</span></span>
<span id="cb82-350"><a href="#cb82-350" aria-hidden="true" tabindex="-1"></a>c0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N ,<span class="dv">10</span> ,<span class="dv">2</span>)</span>
<span id="cb82-351"><a href="#cb82-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-352"><a href="#cb82-352" aria-hidden="true" tabindex="-1"></a><span class="co"># assign treatments and simulate charitable giving and increase in social cohesion</span></span>
<span id="cb82-353"><a href="#cb82-353" aria-hidden="true" tabindex="-1"></a>ritual <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span> , <span class="at">each =</span> N<span class="sc">/</span><span class="dv">2</span> )</span>
<span id="cb82-354"><a href="#cb82-354" aria-hidden="true" tabindex="-1"></a>cohesion <span class="ot">&lt;-</span> ritual <span class="sc">*</span> <span class="fu">rnorm</span>(N,.<span class="dv">5</span>,.<span class="dv">2</span>)</span>
<span id="cb82-355"><a href="#cb82-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-356"><a href="#cb82-356" aria-hidden="true" tabindex="-1"></a><span class="co"># increase in charity</span></span>
<span id="cb82-357"><a href="#cb82-357" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> c0 <span class="sc">+</span> ritual <span class="sc">*</span> cohesion </span>
<span id="cb82-358"><a href="#cb82-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-359"><a href="#cb82-359" aria-hidden="true" tabindex="-1"></a><span class="co"># dataframe</span></span>
<span id="cb82-360"><a href="#cb82-360" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">c0 =</span> c0 , </span>
<span id="cb82-361"><a href="#cb82-361" aria-hidden="true" tabindex="-1"></a>                 <span class="at">c1=</span>c1 , </span>
<span id="cb82-362"><a href="#cb82-362" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ritual =</span> ritual , </span>
<span id="cb82-363"><a href="#cb82-363" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cohesion =</span> cohesion )</span>
<span id="cb82-364"><a href="#cb82-364" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(d)</span>
<span id="cb82-365"><a href="#cb82-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-366"><a href="#cb82-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-367"><a href="#cb82-367" aria-hidden="true" tabindex="-1"></a>Does the ritual increase charity?</span>
<span id="cb82-368"><a href="#cb82-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-369"><a href="#cb82-369" aria-hidden="true" tabindex="-1"></a>If we only include the ritual condition in the model, we find that ritual condition reliable predicts increases in charitable giving:</span>
<span id="cb82-370"><a href="#cb82-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-373"><a href="#cb82-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-374"><a href="#cb82-374" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb82-375"><a href="#cb82-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(c1 <span class="sc">~</span>  c0 <span class="sc">+</span> ritual, <span class="at">data =</span> d)</span>
<span id="cb82-376"><a href="#cb82-376" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb82-377"><a href="#cb82-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-378"><a href="#cb82-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-379"><a href="#cb82-379" aria-hidden="true" tabindex="-1"></a>Does the ritual increase charity adjusting for levels of social cohesion?</span>
<span id="cb82-380"><a href="#cb82-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-383"><a href="#cb82-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-384"><a href="#cb82-384" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb82-385"><a href="#cb82-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(c1 <span class="sc">~</span>  c0 <span class="sc">+</span> ritual <span class="sc">+</span> cohesion, <span class="at">data =</span> d)</span>
<span id="cb82-386"><a href="#cb82-386" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb82-387"><a href="#cb82-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-388"><a href="#cb82-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-389"><a href="#cb82-389" aria-hidden="true" tabindex="-1"></a>The answer is that the (direct) effect of ritual entirely drops out when we include both ritual and social cohesion. Why is this? The answer is that once our model knows <span class="in">`m`</span> it does not obtain any new information by knowing <span class="in">`x`</span>.</span>
<span id="cb82-390"><a href="#cb82-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-391"><a href="#cb82-391" aria-hidden="true" tabindex="-1"></a>If we were interested in assessing x$\to$y but x were to effect y through m (i.e x$\to$m$\to$y) then conditioning on m would **block the path** from x$\to$y. Including m leads to **Pipe Confounding**.</span>
<span id="cb82-392"><a href="#cb82-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-393"><a href="#cb82-393" aria-hidden="true" tabindex="-1"></a>In experiments we should never condition on a post-treatment variable.</span>
<span id="cb82-394"><a href="#cb82-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-395"><a href="#cb82-395" aria-hidden="true" tabindex="-1"></a><span class="fu">## Masked relationships</span></span>
<span id="cb82-396"><a href="#cb82-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-397"><a href="#cb82-397" aria-hidden="true" tabindex="-1"></a>Imagine two variables were to affect an outcome. Both are correlated with each other. One affects the outcome positively and the other affects the outcome negatively. How shall we investigate the causal role of the focal predictor?</span>
<span id="cb82-398"><a href="#cb82-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-399"><a href="#cb82-399" aria-hidden="true" tabindex="-1"></a>Consider two correlated variables that jointly predict Political conservatism (C), religion (R). Imagine that one variable has a positive effect and the other has a negative effect on distress (K6).</span>
<span id="cb82-400"><a href="#cb82-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-401"><a href="#cb82-401" aria-hidden="true" tabindex="-1"></a>First consider this relationship, where conservatism causes religion</span>
<span id="cb82-402"><a href="#cb82-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-405"><a href="#cb82-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-406"><a href="#cb82-406" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb82-407"><a href="#cb82-407" aria-hidden="true" tabindex="-1"></a>dag_m1 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(K <span class="sc">~</span> C <span class="sc">+</span> R,</span>
<span id="cb82-408"><a href="#cb82-408" aria-hidden="true" tabindex="-1"></a>                 R <span class="sc">~</span> C,</span>
<span id="cb82-409"><a href="#cb82-409" aria-hidden="true" tabindex="-1"></a>                 <span class="at">exposure =</span> <span class="st">"C"</span>,</span>
<span id="cb82-410"><a href="#cb82-410" aria-hidden="true" tabindex="-1"></a>                 <span class="at">outcome =</span> <span class="st">"K"</span>) <span class="sc">|&gt;</span></span>
<span id="cb82-411"><a href="#cb82-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"tree"</span>)</span>
<span id="cb82-412"><a href="#cb82-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-413"><a href="#cb82-413" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb82-414"><a href="#cb82-414" aria-hidden="true" tabindex="-1"></a>dag_m1<span class="sc">|&gt;</span></span>
<span id="cb82-415"><a href="#cb82-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span>
<span id="cb82-416"><a href="#cb82-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-417"><a href="#cb82-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-418"><a href="#cb82-418" aria-hidden="true" tabindex="-1"></a>We can simulate the data:</span>
<span id="cb82-419"><a href="#cb82-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-422"><a href="#cb82-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-423"><a href="#cb82-423" aria-hidden="true" tabindex="-1"></a><span class="co"># C -&gt; K &lt;- R</span></span>
<span id="cb82-424"><a href="#cb82-424" aria-hidden="true" tabindex="-1"></a><span class="co"># C -&gt; R</span></span>
<span id="cb82-425"><a href="#cb82-425" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb82-426"><a href="#cb82-426" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb82-427"><a href="#cb82-427" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n )</span>
<span id="cb82-428"><a href="#cb82-428" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n , C )</span>
<span id="cb82-429"><a href="#cb82-429" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n , R <span class="sc">-</span> C )</span>
<span id="cb82-430"><a href="#cb82-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-431"><a href="#cb82-431" aria-hidden="true" tabindex="-1"></a>d_sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K=</span>K,<span class="at">R=</span>R,<span class="at">C=</span>C)</span>
<span id="cb82-432"><a href="#cb82-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-433"><a href="#cb82-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-434"><a href="#cb82-434" aria-hidden="true" tabindex="-1"></a>First we only condition on conservatism</span>
<span id="cb82-435"><a href="#cb82-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-438"><a href="#cb82-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-439"><a href="#cb82-439" aria-hidden="true" tabindex="-1"></a>ms1 <span class="ot">&lt;-</span> parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb82-440"><a href="#cb82-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(K  <span class="sc">~</span> C, <span class="at">data =</span> d_sim)</span>
<span id="cb82-441"><a href="#cb82-441" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-442"><a href="#cb82-442" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ms1)</span>
<span id="cb82-443"><a href="#cb82-443" aria-hidden="true" tabindex="-1"></a>ms1</span>
<span id="cb82-444"><a href="#cb82-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-445"><a href="#cb82-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-446"><a href="#cb82-446" aria-hidden="true" tabindex="-1"></a>Next, only religion:</span>
<span id="cb82-447"><a href="#cb82-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-450"><a href="#cb82-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-451"><a href="#cb82-451" aria-hidden="true" tabindex="-1"></a>ms2<span class="ot">&lt;-</span> parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb82-452"><a href="#cb82-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(K  <span class="sc">~</span> R, <span class="at">data =</span> d_sim)</span>
<span id="cb82-453"><a href="#cb82-453" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-454"><a href="#cb82-454" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ms2)</span>
<span id="cb82-455"><a href="#cb82-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-456"><a href="#cb82-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-457"><a href="#cb82-457" aria-hidden="true" tabindex="-1"></a>When we add both C and R, we see them "pop" in opposite directions, as is typical of masking:</span>
<span id="cb82-458"><a href="#cb82-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-461"><a href="#cb82-461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-462"><a href="#cb82-462" aria-hidden="true" tabindex="-1"></a>ms3<span class="ot">&lt;-</span> parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb82-463"><a href="#cb82-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(K  <span class="sc">~</span> C <span class="sc">+</span> R, <span class="at">data =</span> d_sim)</span>
<span id="cb82-464"><a href="#cb82-464" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-465"><a href="#cb82-465" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ms3)</span>
<span id="cb82-466"><a href="#cb82-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-467"><a href="#cb82-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-468"><a href="#cb82-468" aria-hidden="true" tabindex="-1"></a>Note that when you ask <span class="in">`ggdag`</span> to assess how to obtain an unbiased estimate of C on K it will tell you you don't need to condition on R.</span>
<span id="cb82-469"><a href="#cb82-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-472"><a href="#cb82-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-473"><a href="#cb82-473" aria-hidden="true" tabindex="-1"></a>dag_m1<span class="sc">|&gt;</span></span>
<span id="cb82-474"><a href="#cb82-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_adjustment_set</span>()</span>
<span id="cb82-475"><a href="#cb82-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-476"><a href="#cb82-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-477"><a href="#cb82-477" aria-hidden="true" tabindex="-1"></a>Yet recall when we just assessed the relationship of C on K we got this:</span>
<span id="cb82-478"><a href="#cb82-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-481"><a href="#cb82-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-482"><a href="#cb82-482" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ms1)</span>
<span id="cb82-483"><a href="#cb82-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-484"><a href="#cb82-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-485"><a href="#cb82-485" aria-hidden="true" tabindex="-1"></a>Is the DAG wrong? </span>
<span id="cb82-486"><a href="#cb82-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-487"><a href="#cb82-487" aria-hidden="true" tabindex="-1"></a>No. The fact that C$\to$R is positive and R$\to$K is negative means that if we were to increase C, we wouldn't reliably increase K. The total effect of C just isn't reliable</span>
<span id="cb82-488"><a href="#cb82-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-489"><a href="#cb82-489" aria-hidden="true" tabindex="-1"></a><span class="fu">## Collider Confounding</span></span>
<span id="cb82-490"><a href="#cb82-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-491"><a href="#cb82-491" aria-hidden="true" tabindex="-1"></a>The selection-distortion effect (Berkson's paradox)</span>
<span id="cb82-492"><a href="#cb82-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-493"><a href="#cb82-493" aria-hidden="true" tabindex="-1"></a>This example is from the book **Statistical Rethinking**.  Imagine in science there is no relationship between the newsworthiness of science and its trustworthiness. Imagine further that selection committees make decisions on the basis of the both newsworthiness and the trustworthiness of scientific proposals.</span>
<span id="cb82-494"><a href="#cb82-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-495"><a href="#cb82-495" aria-hidden="true" tabindex="-1"></a>This presents us with the following graph</span>
<span id="cb82-496"><a href="#cb82-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-497"><a href="#cb82-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r code_folding = TRUE}</span></span>
<span id="cb82-498"><a href="#cb82-498" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="ot">&lt;-</span> <span class="fu">dagify</span>(S <span class="sc">~</span> N,</span>
<span id="cb82-499"><a href="#cb82-499" aria-hidden="true" tabindex="-1"></a>                 S <span class="sc">~</span> T,</span>
<span id="cb82-500"><a href="#cb82-500" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"S"</span> <span class="ot">=</span> <span class="st">"Selection"</span>,</span>
<span id="cb82-501"><a href="#cb82-501" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"N"</span> <span class="ot">=</span> <span class="st">"Newsworthy"</span>,</span>
<span id="cb82-502"><a href="#cb82-502" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"T"</span> <span class="ot">=</span> <span class="st">"Trustworthy"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb82-503"><a href="#cb82-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"nicely"</span>)</span>
<span id="cb82-504"><a href="#cb82-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-505"><a href="#cb82-505" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb82-506"><a href="#cb82-506" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="sc">|&gt;</span></span>
<span id="cb82-507"><a href="#cb82-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>(<span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels =</span> <span class="st">"label"</span>) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span>
<span id="cb82-508"><a href="#cb82-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-509"><a href="#cb82-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-510"><a href="#cb82-510" aria-hidden="true" tabindex="-1"></a>When two arrows enter into an variable, it opens a path of information between the two variables.</span>
<span id="cb82-511"><a href="#cb82-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-512"><a href="#cb82-512" aria-hidden="true" tabindex="-1"></a>Very often this openning of information has disasterous implications. *In the human sciences, included variable bias is a woefully underrated problem*.</span>
<span id="cb82-513"><a href="#cb82-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-514"><a href="#cb82-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  code_folding = TRUE}</span></span>
<span id="cb82-515"><a href="#cb82-515" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_dseparated</span>(</span>
<span id="cb82-516"><a href="#cb82-516" aria-hidden="true" tabindex="-1"></a>  dag_sd,</span>
<span id="cb82-517"><a href="#cb82-517" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="st">"T"</span>,</span>
<span id="cb82-518"><a href="#cb82-518" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="st">"N"</span>,</span>
<span id="cb82-519"><a href="#cb82-519" aria-hidden="true" tabindex="-1"></a>  <span class="at">controlling_for =</span> <span class="st">"S"</span>,</span>
<span id="cb82-520"><a href="#cb82-520" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-521"><a href="#cb82-521" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels =</span> <span class="st">"label"</span></span>
<span id="cb82-522"><a href="#cb82-522" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span>
<span id="cb82-523"><a href="#cb82-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-524"><a href="#cb82-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-525"><a href="#cb82-525" aria-hidden="true" tabindex="-1"></a>We can use the <span class="in">`ggdag package`</span> to find colliders among our variables:</span>
<span id="cb82-526"><a href="#cb82-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-529"><a href="#cb82-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-530"><a href="#cb82-530" aria-hidden="true" tabindex="-1"></a><span class="co"># code for finding colliders</span></span>
<span id="cb82-531"><a href="#cb82-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-532"><a href="#cb82-532" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_collider</span>(dag_sd,</span>
<span id="cb82-533"><a href="#cb82-533" aria-hidden="true" tabindex="-1"></a>                      <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-534"><a href="#cb82-534" aria-hidden="true" tabindex="-1"></a>                      <span class="at">use_labels =</span> <span class="st">"label"</span>)</span>
<span id="cb82-535"><a href="#cb82-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-536"><a href="#cb82-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-537"><a href="#cb82-537" aria-hidden="true" tabindex="-1"></a>The following simulation (by Solomon Kurz) illustrates the selection-distortion effect, which Richard McElreath discusses in *Statistical Rethinking*:</span>
<span id="cb82-538"><a href="#cb82-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-539"><a href="#cb82-539" aria-hidden="true" tabindex="-1"></a>First simulated uncorrelated variables and a process of selection for sub-populations score high on both indicators.</span>
<span id="cb82-540"><a href="#cb82-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-541"><a href="#cb82-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  code_folding = TRUE}</span></span>
<span id="cb82-542"><a href="#cb82-542" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate selection distortion effect, following Solomon Kurz</span></span>
<span id="cb82-543"><a href="#cb82-543" aria-hidden="true" tabindex="-1"></a><span class="co"># https://bookdown.org/content/4857/the-haunted-dag-the-causal-terror.html</span></span>
<span id="cb82-544"><a href="#cb82-544" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb82-545"><a href="#cb82-545" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># number of grant proposals</span></span>
<span id="cb82-546"><a href="#cb82-546" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># proportion to select</span></span>
<span id="cb82-547"><a href="#cb82-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-548"><a href="#cb82-548" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb82-549"><a href="#cb82-549" aria-hidden="true" tabindex="-1"></a>  <span class="co"># uncorrelated newsworthiness and trustworthiness</span></span>
<span id="cb82-550"><a href="#cb82-550" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb82-551"><a href="#cb82-551" aria-hidden="true" tabindex="-1"></a>    <span class="at">newsworthiness  =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb82-552"><a href="#cb82-552" aria-hidden="true" tabindex="-1"></a>    <span class="at">trustworthiness =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb82-553"><a href="#cb82-553" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb82-554"><a href="#cb82-554" aria-hidden="true" tabindex="-1"></a>  <span class="co"># total_score</span></span>
<span id="cb82-555"><a href="#cb82-555" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_score =</span> newsworthiness <span class="sc">+</span> trustworthiness) <span class="sc">|&gt;</span></span>
<span id="cb82-556"><a href="#cb82-556" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select top 10% of combined scores</span></span>
<span id="cb82-557"><a href="#cb82-557" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">ifelse</span>(total_score <span class="sc">&gt;=</span> <span class="fu">quantile</span>(total_score, <span class="dv">1</span> <span class="sc">-</span> p), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb82-558"><a href="#cb82-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-559"><a href="#cb82-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-560"><a href="#cb82-560" aria-hidden="true" tabindex="-1"></a>Next filter out the high scoring examples, and assess their correlation.</span>
<span id="cb82-561"><a href="#cb82-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-562"><a href="#cb82-562" aria-hidden="true" tabindex="-1"></a>Note that the act of selection *induces* a correlation within our dataset.</span>
<span id="cb82-563"><a href="#cb82-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-566"><a href="#cb82-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-567"><a href="#cb82-567" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb82-568"><a href="#cb82-568" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(selected <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb82-569"><a href="#cb82-569" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(newsworthiness, trustworthiness) <span class="sc">|&gt;</span> </span>
<span id="cb82-570"><a href="#cb82-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb82-571"><a href="#cb82-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-572"><a href="#cb82-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-573"><a href="#cb82-573" aria-hidden="true" tabindex="-1"></a>This makes it seems as if there is a relationship between Trustworthiness and Newsworthiness in science, even when there isn't any.</span>
<span id="cb82-574"><a href="#cb82-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-575"><a href="#cb82-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  code_folding = TRUE}</span></span>
<span id="cb82-576"><a href="#cb82-576" aria-hidden="true" tabindex="-1"></a><span class="co"># we'll need this for the annotation</span></span>
<span id="cb82-577"><a href="#cb82-577" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb82-578"><a href="#cb82-578" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb82-579"><a href="#cb82-579" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb82-580"><a href="#cb82-580" aria-hidden="true" tabindex="-1"></a>    <span class="at">newsworthiness  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb82-581"><a href="#cb82-581" aria-hidden="true" tabindex="-1"></a>    <span class="at">trustworthiness =</span> <span class="fu">c</span>(<span class="fl">2.25</span>, <span class="sc">-</span><span class="fl">2.5</span>),</span>
<span id="cb82-582"><a href="#cb82-582" aria-hidden="true" tabindex="-1"></a>    <span class="at">selected        =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb82-583"><a href="#cb82-583" aria-hidden="true" tabindex="-1"></a>    <span class="at">label           =</span> <span class="fu">c</span>(<span class="st">"selected"</span>, <span class="st">"rejected"</span>)</span>
<span id="cb82-584"><a href="#cb82-584" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb82-585"><a href="#cb82-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-586"><a href="#cb82-586" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span></span>
<span id="cb82-587"><a href="#cb82-587" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> newsworthiness, <span class="at">y =</span> trustworthiness, <span class="at">color =</span> selected)) <span class="sc">+</span></span>
<span id="cb82-588"><a href="#cb82-588" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> selected), <span class="at">alpha =</span> <span class="dv">3</span> <span class="sc">/</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb82-589"><a href="#cb82-589" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb82-590"><a href="#cb82-590" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb82-591"><a href="#cb82-591" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(</span>
<span id="cb82-592"><a href="#cb82-592" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d <span class="sc">|&gt;</span> <span class="fu">filter</span>(selected <span class="sc">==</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-593"><a href="#cb82-593" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb82-594"><a href="#cb82-594" aria-hidden="true" tabindex="-1"></a>    <span class="at">fullrange =</span> T,</span>
<span id="cb82-595"><a href="#cb82-595" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb82-596"><a href="#cb82-596" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> F,</span>
<span id="cb82-597"><a href="#cb82-597" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb82-598"><a href="#cb82-598" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb82-599"><a href="#cb82-599" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = c("black", "lightblue")) +</span></span>
<span id="cb82-600"><a href="#cb82-600" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb82-601"><a href="#cb82-601" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">3.9</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb82-602"><a href="#cb82-602" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(d<span class="sc">$</span>trustworthiness)) <span class="sc">+</span></span>
<span id="cb82-603"><a href="#cb82-603" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb82-604"><a href="#cb82-604" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">"Newsworthy"</span>) <span class="sc">+</span></span>
<span id="cb82-605"><a href="#cb82-605" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"Trustworthy"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb82-606"><a href="#cb82-606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-607"><a href="#cb82-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-608"><a href="#cb82-608" aria-hidden="true" tabindex="-1"></a>Once we know a proposal has been selected, if it is newsworthy we can predict that it is less trustworthy. Our simulation produces this prediction even though we simulated a world in which there is no relationship between trustworthiness and newsworthiness.</span>
<span id="cb82-609"><a href="#cb82-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-610"><a href="#cb82-610" aria-hidden="true" tabindex="-1"></a>Selection bias is commonplace.</span>
<span id="cb82-611"><a href="#cb82-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-612"><a href="#cb82-612" aria-hidden="true" tabindex="-1"></a><span class="fu">## Collider bias within experiments</span></span>
<span id="cb82-613"><a href="#cb82-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-614"><a href="#cb82-614" aria-hidden="true" tabindex="-1"></a>We noted that conditioning on a post-treatment variable can induce bias by blocking the path between the experimental manipulation and the outcome. However, such conditioning can open a path even when there is no experimental effect.</span>
<span id="cb82-615"><a href="#cb82-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-616"><a href="#cb82-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  code_folding = TRUE}</span></span>
<span id="cb82-617"><a href="#cb82-617" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb82-618"><a href="#cb82-618" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> C0 <span class="sc">+</span> U,</span>
<span id="cb82-619"><a href="#cb82-619" aria-hidden="true" tabindex="-1"></a>  Ch <span class="sc">~</span> U <span class="sc">+</span> R,</span>
<span id="cb82-620"><a href="#cb82-620" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb82-621"><a href="#cb82-621" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R"</span> <span class="ot">=</span> <span class="st">"Ritual"</span>,</span>
<span id="cb82-622"><a href="#cb82-622" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C1"</span> <span class="ot">=</span> <span class="st">"Charity-post"</span>,</span>
<span id="cb82-623"><a href="#cb82-623" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C0"</span> <span class="ot">=</span> <span class="st">"Charity-pre"</span>,</span>
<span id="cb82-624"><a href="#cb82-624" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ch"</span> <span class="ot">=</span> <span class="st">"Cohesion"</span>,</span>
<span id="cb82-625"><a href="#cb82-625" aria-hidden="true" tabindex="-1"></a>    <span class="st">"U"</span> <span class="ot">=</span> <span class="st">"Religiousness (Unmeasured)"</span></span>
<span id="cb82-626"><a href="#cb82-626" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb82-627"><a href="#cb82-627" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"R"</span>,</span>
<span id="cb82-628"><a href="#cb82-628" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"C1"</span>,</span>
<span id="cb82-629"><a href="#cb82-629" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"U"</span></span>
<span id="cb82-630"><a href="#cb82-630" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb82-631"><a href="#cb82-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="fu">c</span>(<span class="st">"Ch"</span>,<span class="st">"C0"</span>))  </span>
<span id="cb82-632"><a href="#cb82-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-633"><a href="#cb82-633" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="sc">|&gt;</span></span>
<span id="cb82-634"><a href="#cb82-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>( <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-635"><a href="#cb82-635" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>)</span>
<span id="cb82-636"><a href="#cb82-636" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-637"><a href="#cb82-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-638"><a href="#cb82-638" aria-hidden="true" tabindex="-1"></a>How do we avoid collider-bias here?</span>
<span id="cb82-639"><a href="#cb82-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-640"><a href="#cb82-640" aria-hidden="true" tabindex="-1"></a>Note what happens if we condition on cohesion?</span>
<span id="cb82-641"><a href="#cb82-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-644"><a href="#cb82-644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-645"><a href="#cb82-645" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="sc">|&gt;</span></span>
<span id="cb82-646"><a href="#cb82-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_collider</span>(</span>
<span id="cb82-647"><a href="#cb82-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-648"><a href="#cb82-648" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span></span>
<span id="cb82-649"><a href="#cb82-649" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb82-650"><a href="#cb82-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Cohesion is a collider that opens a path from ritual to charity"</span>)</span>
<span id="cb82-651"><a href="#cb82-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-652"><a href="#cb82-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-653"><a href="#cb82-653" aria-hidden="true" tabindex="-1"></a>Don't condition on a post-treatment variable!</span>
<span id="cb82-654"><a href="#cb82-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-657"><a href="#cb82-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-658"><a href="#cb82-658" aria-hidden="true" tabindex="-1"></a>dag_ex3 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb82-659"><a href="#cb82-659" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> C0,</span>
<span id="cb82-660"><a href="#cb82-660" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> U,</span>
<span id="cb82-661"><a href="#cb82-661" aria-hidden="true" tabindex="-1"></a>  Ch <span class="sc">~</span> U <span class="sc">+</span> R,</span>
<span id="cb82-662"><a href="#cb82-662" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb82-663"><a href="#cb82-663" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R"</span> <span class="ot">=</span> <span class="st">"Ritual"</span>,</span>
<span id="cb82-664"><a href="#cb82-664" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C1"</span> <span class="ot">=</span> <span class="st">"Charity-post"</span>,</span>
<span id="cb82-665"><a href="#cb82-665" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C0"</span> <span class="ot">=</span> <span class="st">"Charity-pre"</span>,</span>
<span id="cb82-666"><a href="#cb82-666" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ch"</span> <span class="ot">=</span> <span class="st">"Cohesion"</span>,</span>
<span id="cb82-667"><a href="#cb82-667" aria-hidden="true" tabindex="-1"></a>    <span class="st">"U"</span> <span class="ot">=</span> <span class="st">"Religiousness (Unmeasured)"</span></span>
<span id="cb82-668"><a href="#cb82-668" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb82-669"><a href="#cb82-669" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"R"</span>,</span>
<span id="cb82-670"><a href="#cb82-670" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"C1"</span>,</span>
<span id="cb82-671"><a href="#cb82-671" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"U"</span></span>
<span id="cb82-672"><a href="#cb82-672" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-673"><a href="#cb82-673" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_adjustment_set</span>(dag_ex3)</span>
<span id="cb82-674"><a href="#cb82-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-675"><a href="#cb82-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-676"><a href="#cb82-676" aria-hidden="true" tabindex="-1"></a><span class="fu">## Taxonomy of confounding</span></span>
<span id="cb82-677"><a href="#cb82-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-678"><a href="#cb82-678" aria-hidden="true" tabindex="-1"></a>There is good news. Remember, ultimately are only four basic types of confounding:</span>
<span id="cb82-679"><a href="#cb82-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-680"><a href="#cb82-680" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Fork (omitted variable bias)</span></span>
<span id="cb82-681"><a href="#cb82-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-684"><a href="#cb82-684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-685"><a href="#cb82-685" aria-hidden="true" tabindex="-1"></a><span class="fu">confounder_triangle</span>(<span class="at">x =</span> <span class="st">"Coffee"</span>,</span>
<span id="cb82-686"><a href="#cb82-686" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="st">"Lung Cancer"</span>,</span>
<span id="cb82-687"><a href="#cb82-687" aria-hidden="true" tabindex="-1"></a>                    <span class="at">z =</span> <span class="st">"Smoking"</span>) <span class="sc">|&gt;</span></span>
<span id="cb82-688"><a href="#cb82-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dconnected</span>(<span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-689"><a href="#cb82-689" aria-hidden="true" tabindex="-1"></a>                   <span class="at">use_labels =</span> <span class="st">"label"</span>)</span>
<span id="cb82-690"><a href="#cb82-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-691"><a href="#cb82-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-692"><a href="#cb82-692" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Pipe (fully mediated effects)</span></span>
<span id="cb82-693"><a href="#cb82-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-696"><a href="#cb82-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-697"><a href="#cb82-697" aria-hidden="true" tabindex="-1"></a><span class="fu">mediation_triangle</span>(</span>
<span id="cb82-698"><a href="#cb82-698" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb82-699"><a href="#cb82-699" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb82-700"><a href="#cb82-700" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="cn">NULL</span>,</span>
<span id="cb82-701"><a href="#cb82-701" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_y_associated =</span> <span class="cn">FALSE</span></span>
<span id="cb82-702"><a href="#cb82-702" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb82-703"><a href="#cb82-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">|&gt;</span></span>
<span id="cb82-704"><a href="#cb82-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span>
<span id="cb82-705"><a href="#cb82-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-706"><a href="#cb82-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-707"><a href="#cb82-707" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Collider</span></span>
<span id="cb82-708"><a href="#cb82-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-711"><a href="#cb82-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-712"><a href="#cb82-712" aria-hidden="true" tabindex="-1"></a><span class="fu">collider_triangle</span>() <span class="sc">|&gt;</span></span>
<span id="cb82-713"><a href="#cb82-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dseparated</span>(<span class="at">controlling_for =</span> <span class="st">"m"</span>)</span>
<span id="cb82-714"><a href="#cb82-714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-715"><a href="#cb82-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-716"><a href="#cb82-716" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confounding by proxy</span></span>
<span id="cb82-717"><a href="#cb82-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-718"><a href="#cb82-718" aria-hidden="true" tabindex="-1"></a>If we "control for" a descendant of a collider, we will introduce collider bias.</span>
<span id="cb82-719"><a href="#cb82-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-722"><a href="#cb82-722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-723"><a href="#cb82-723" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb82-724"><a href="#cb82-724" aria-hidden="true" tabindex="-1"></a>  Z <span class="sc">~</span> X,</span>
<span id="cb82-725"><a href="#cb82-725" aria-hidden="true" tabindex="-1"></a>  Z <span class="sc">~</span> Y,</span>
<span id="cb82-726"><a href="#cb82-726" aria-hidden="true" tabindex="-1"></a>  D <span class="sc">~</span> Z,</span>
<span id="cb82-727"><a href="#cb82-727" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb82-728"><a href="#cb82-728" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Z"</span> <span class="ot">=</span> <span class="st">"Collider"</span>,</span>
<span id="cb82-729"><a href="#cb82-729" aria-hidden="true" tabindex="-1"></a>    <span class="st">"D"</span> <span class="ot">=</span> <span class="st">"Descendant"</span>,</span>
<span id="cb82-730"><a href="#cb82-730" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X"</span> <span class="ot">=</span> <span class="st">"X"</span>,</span>
<span id="cb82-731"><a href="#cb82-731" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y"</span> <span class="ot">=</span> <span class="st">"Y"</span></span>
<span id="cb82-732"><a href="#cb82-732" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb82-733"><a href="#cb82-733" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"X"</span>,</span>
<span id="cb82-734"><a href="#cb82-734" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"Y"</span></span>
<span id="cb82-735"><a href="#cb82-735" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb82-736"><a href="#cb82-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="st">"D"</span>) </span>
<span id="cb82-737"><a href="#cb82-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-738"><a href="#cb82-738" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="sc">|&gt;</span></span>
<span id="cb82-739"><a href="#cb82-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dseparated</span>(</span>
<span id="cb82-740"><a href="#cb82-740" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="st">"X"</span>,</span>
<span id="cb82-741"><a href="#cb82-741" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="st">"Y"</span>,</span>
<span id="cb82-742"><a href="#cb82-742" aria-hidden="true" tabindex="-1"></a>    <span class="at">controlling_for =</span> <span class="st">"D"</span>,</span>
<span id="cb82-743"><a href="#cb82-743" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-744"><a href="#cb82-744" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span></span>
<span id="cb82-745"><a href="#cb82-745" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb82-746"><a href="#cb82-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"X --&gt; Y, controlling for D"</span>,</span>
<span id="cb82-747"><a href="#cb82-747" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="st">"D induces collider bias"</span>)</span>
<span id="cb82-748"><a href="#cb82-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-749"><a href="#cb82-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-750"><a href="#cb82-750" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rules for avoiding confounding</span></span>
<span id="cb82-751"><a href="#cb82-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-752"><a href="#cb82-752" aria-hidden="true" tabindex="-1"></a>From *Statistical Rethinking*, p.286</span>
<span id="cb82-753"><a href="#cb82-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-754"><a href="#cb82-754" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; List all of the paths connecting X (the potential cause of interest) and Y (the outcome).</span></span>
<span id="cb82-755"><a href="#cb82-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-756"><a href="#cb82-756" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Classify each path by whether it is open or closed. A path is open unless it contains a collider.</span></span>
<span id="cb82-757"><a href="#cb82-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-758"><a href="#cb82-758" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Classify each path by whether it is a backdoor path. A backdoor path has an arrow entering X.</span></span>
<span id="cb82-759"><a href="#cb82-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-760"><a href="#cb82-760" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; If there are any open backdoor paths, decide which variable(s) to condition on to close it (if possible).</span></span>
<span id="cb82-761"><a href="#cb82-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-762"><a href="#cb82-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-763"><a href="#cb82-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-766"><a href="#cb82-766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-767"><a href="#cb82-767" aria-hidden="true" tabindex="-1"></a><span class="co"># Examle</span></span>
<span id="cb82-768"><a href="#cb82-768" aria-hidden="true" tabindex="-1"></a><span class="co"># call ggdag model</span></span>
<span id="cb82-769"><a href="#cb82-769" aria-hidden="true" tabindex="-1"></a><span class="co"># write relationships:</span></span>
<span id="cb82-770"><a href="#cb82-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-771"><a href="#cb82-771" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb82-772"><a href="#cb82-772" aria-hidden="true" tabindex="-1"></a>dg_1 <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">dagify</span>(</span>
<span id="cb82-773"><a href="#cb82-773" aria-hidden="true" tabindex="-1"></a>  b <span class="sc">~</span>  im <span class="sc">+</span> ordr <span class="sc">+</span> rel <span class="sc">+</span> sr  <span class="sc">+</span> st,</span>
<span id="cb82-774"><a href="#cb82-774" aria-hidden="true" tabindex="-1"></a>  rel <span class="sc">~</span>  age <span class="sc">+</span> ses <span class="sc">+</span> edu <span class="sc">+</span> male <span class="sc">+</span> cny,</span>
<span id="cb82-775"><a href="#cb82-775" aria-hidden="true" tabindex="-1"></a>  ses <span class="sc">~</span> cny <span class="sc">+</span> edu <span class="sc">+</span> age,</span>
<span id="cb82-776"><a href="#cb82-776" aria-hidden="true" tabindex="-1"></a>  edu <span class="sc">~</span> cny <span class="sc">+</span> male <span class="sc">+</span> age,</span>
<span id="cb82-777"><a href="#cb82-777" aria-hidden="true" tabindex="-1"></a>  im <span class="sc">~</span> mem <span class="sc">+</span> rel <span class="sc">+</span> cny,</span>
<span id="cb82-778"><a href="#cb82-778" aria-hidden="true" tabindex="-1"></a>  mem <span class="sc">~</span> age <span class="sc">+</span> edu <span class="sc">+</span> ordr,</span>
<span id="cb82-779"><a href="#cb82-779" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"sr"</span>,</span>
<span id="cb82-780"><a href="#cb82-780" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"b"</span>,</span>
<span id="cb82-781"><a href="#cb82-781" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb82-782"><a href="#cb82-782" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b"</span> <span class="ot">=</span> <span class="st">"statement credibility"</span>,</span>
<span id="cb82-783"><a href="#cb82-783" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sr"</span> <span class="ot">=</span> <span class="st">"source"</span>,</span>
<span id="cb82-784"><a href="#cb82-784" aria-hidden="true" tabindex="-1"></a>    <span class="st">"st"</span> <span class="ot">=</span> <span class="st">"statement"</span>,</span>
<span id="cb82-785"><a href="#cb82-785" aria-hidden="true" tabindex="-1"></a>    <span class="st">"im"</span> <span class="ot">=</span> <span class="st">"importance"</span>,</span>
<span id="cb82-786"><a href="#cb82-786" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mem"</span> <span class="ot">=</span> <span class="st">"memory"</span>,</span>
<span id="cb82-787"><a href="#cb82-787" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s"</span> <span class="ot">=</span> <span class="st">"source"</span>,</span>
<span id="cb82-788"><a href="#cb82-788" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rel"</span> <span class="ot">=</span> <span class="st">"religious"</span>,</span>
<span id="cb82-789"><a href="#cb82-789" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cny"</span> <span class="ot">=</span> <span class="st">"country"</span>,</span>
<span id="cb82-790"><a href="#cb82-790" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mem"</span> <span class="ot">=</span> <span class="st">"memory"</span>,</span>
<span id="cb82-791"><a href="#cb82-791" aria-hidden="true" tabindex="-1"></a>    <span class="st">"male"</span> <span class="ot">=</span> <span class="st">"male"</span>,</span>
<span id="cb82-792"><a href="#cb82-792" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ordr"</span> <span class="ot">=</span> <span class="st">"presentation order"</span>,</span>
<span id="cb82-793"><a href="#cb82-793" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ses"</span> <span class="ot">=</span> <span class="st">"perceived SES"</span>,</span>
<span id="cb82-794"><a href="#cb82-794" aria-hidden="true" tabindex="-1"></a>    <span class="st">"edu"</span> <span class="ot">=</span> <span class="st">"education"</span>,</span>
<span id="cb82-795"><a href="#cb82-795" aria-hidden="true" tabindex="-1"></a>    <span class="st">"age"</span> <span class="ot">=</span> <span class="st">"age"</span></span>
<span id="cb82-796"><a href="#cb82-796" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb82-797"><a href="#cb82-797" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb82-798"><a href="#cb82-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="st">"rel"</span>)</span>
<span id="cb82-799"><a href="#cb82-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-800"><a href="#cb82-800" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_collider</span>(dg_1, <span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels =</span> <span class="st">"label"</span>)</span>
<span id="cb82-801"><a href="#cb82-801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-802"><a href="#cb82-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-803"><a href="#cb82-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-804"><a href="#cb82-804" aria-hidden="true" tabindex="-1"></a>Note the colliders induced from the "controls" that we had included in the study:</span>
<span id="cb82-805"><a href="#cb82-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-808"><a href="#cb82-808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-809"><a href="#cb82-809" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">ggdag_dseparated</span>(</span>
<span id="cb82-810"><a href="#cb82-810" aria-hidden="true" tabindex="-1"></a>  dg_1,</span>
<span id="cb82-811"><a href="#cb82-811" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="st">"sr"</span>,</span>
<span id="cb82-812"><a href="#cb82-812" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="st">"b"</span>,</span>
<span id="cb82-813"><a href="#cb82-813" aria-hidden="true" tabindex="-1"></a>  <span class="at">controlling_for =</span> <span class="fu">c</span>(<span class="st">"ses"</span>, <span class="st">"age"</span>, <span class="st">"cny"</span>, <span class="st">"im"</span>, <span class="st">"edu"</span>, <span class="st">"mem"</span>, <span class="st">"male"</span>, <span class="st">"rel"</span>),</span>
<span id="cb82-814"><a href="#cb82-814" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-815"><a href="#cb82-815" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels  =</span> <span class="st">"label"</span></span>
<span id="cb82-816"><a href="#cb82-816" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb82-817"><a href="#cb82-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span></span>
<span id="cb82-818"><a href="#cb82-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Collider Confounding occurs when we `control for` a bunch of variables"</span>)</span>
<span id="cb82-819"><a href="#cb82-819" aria-hidden="true" tabindex="-1"></a>p3</span>
<span id="cb82-820"><a href="#cb82-820" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-821"><a href="#cb82-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-822"><a href="#cb82-822" aria-hidden="true" tabindex="-1"></a>How do we fix the problem? Think hard about the causal network and let <span class="in">`ggdag`</span> do the work.</span>
<span id="cb82-823"><a href="#cb82-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-826"><a href="#cb82-826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-827"><a href="#cb82-827" aria-hidden="true" tabindex="-1"></a><span class="co"># find adjustment set</span></span>
<span id="cb82-828"><a href="#cb82-828" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>(dg_1,</span>
<span id="cb82-829"><a href="#cb82-829" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-830"><a href="#cb82-830" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">use_labels  =</span> <span class="st">"label"</span>) <span class="sc">+</span></span>
<span id="cb82-831"><a href="#cb82-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span></span>
<span id="cb82-832"><a href="#cb82-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Adjustment set"</span>,</span>
<span id="cb82-833"><a href="#cb82-833" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtite =</span> <span class="st">"Model for Source credibility from belief "</span>)</span>
<span id="cb82-834"><a href="#cb82-834" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb82-835"><a href="#cb82-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-836"><a href="#cb82-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-837"><a href="#cb82-837" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inference depends on assumptions that are not contained in the data.</span></span>
<span id="cb82-838"><a href="#cb82-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-839"><a href="#cb82-839" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; regression itself does not provide the evidence you need to justify a causal model. Instead, you need some science." -- Richard McElreath: "Statistical Rethinking, Chapter 6"</span></span>
<span id="cb82-840"><a href="#cb82-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-841"><a href="#cb82-841" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "...the data alone can never tell you which causal model is correct"- Richard McElreath: "Statistical Rethinking" Chapter 5</span></span>
<span id="cb82-842"><a href="#cb82-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-843"><a href="#cb82-843" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "The parameter estimates will always depend upon what you believe about the causal model, because typically several (or very many) causal models are consistent with any one set of parameter estimates." "Statistical Rethinking" Chapter 5</span></span>
<span id="cb82-844"><a href="#cb82-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-845"><a href="#cb82-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-846"><a href="#cb82-846" aria-hidden="true" tabindex="-1"></a>Suppose we assume that the source condition affects religion, say through priming. We then have the following dag:</span>
<span id="cb82-847"><a href="#cb82-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-850"><a href="#cb82-850" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-851"><a href="#cb82-851" aria-hidden="true" tabindex="-1"></a><span class="do">## adding religion to effect on edu</span></span>
<span id="cb82-852"><a href="#cb82-852" aria-hidden="true" tabindex="-1"></a>dg_3 <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">dagify</span>(</span>
<span id="cb82-853"><a href="#cb82-853" aria-hidden="true" tabindex="-1"></a>  b <span class="sc">~</span>  im <span class="sc">+</span> ordr <span class="sc">+</span> rel  <span class="sc">+</span> st <span class="sc">+</span> sr,</span>
<span id="cb82-854"><a href="#cb82-854" aria-hidden="true" tabindex="-1"></a>  rel <span class="sc">~</span>  age <span class="sc">+</span> ses <span class="sc">+</span> edu <span class="sc">+</span> male <span class="sc">+</span> cny <span class="sc">+</span> sr,</span>
<span id="cb82-855"><a href="#cb82-855" aria-hidden="true" tabindex="-1"></a>  ses <span class="sc">~</span> cny <span class="sc">+</span> edu <span class="sc">+</span> age,</span>
<span id="cb82-856"><a href="#cb82-856" aria-hidden="true" tabindex="-1"></a>  edu <span class="sc">~</span> cny <span class="sc">+</span> male <span class="sc">+</span> age,</span>
<span id="cb82-857"><a href="#cb82-857" aria-hidden="true" tabindex="-1"></a>  im <span class="sc">~</span> mem <span class="sc">+</span> rel <span class="sc">+</span> cny,</span>
<span id="cb82-858"><a href="#cb82-858" aria-hidden="true" tabindex="-1"></a>  mem <span class="sc">~</span> age <span class="sc">+</span> edu <span class="sc">+</span> ordr,</span>
<span id="cb82-859"><a href="#cb82-859" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"rel"</span>,</span>
<span id="cb82-860"><a href="#cb82-860" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"b"</span>,</span>
<span id="cb82-861"><a href="#cb82-861" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb82-862"><a href="#cb82-862" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b"</span> <span class="ot">=</span> <span class="st">"statement credibility"</span>,</span>
<span id="cb82-863"><a href="#cb82-863" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sr"</span> <span class="ot">=</span> <span class="st">"source"</span>,</span>
<span id="cb82-864"><a href="#cb82-864" aria-hidden="true" tabindex="-1"></a>    <span class="st">"st"</span> <span class="ot">=</span> <span class="st">"statement"</span>,</span>
<span id="cb82-865"><a href="#cb82-865" aria-hidden="true" tabindex="-1"></a>    <span class="st">"im"</span> <span class="ot">=</span> <span class="st">"importance"</span>,</span>
<span id="cb82-866"><a href="#cb82-866" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mem"</span> <span class="ot">=</span> <span class="st">"memory"</span>,</span>
<span id="cb82-867"><a href="#cb82-867" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s"</span> <span class="ot">=</span> <span class="st">"source"</span>,</span>
<span id="cb82-868"><a href="#cb82-868" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rel"</span> <span class="ot">=</span> <span class="st">"religious"</span>,</span>
<span id="cb82-869"><a href="#cb82-869" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cny"</span> <span class="ot">=</span> <span class="st">"country"</span>,</span>
<span id="cb82-870"><a href="#cb82-870" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mem"</span> <span class="ot">=</span> <span class="st">"memory"</span>,</span>
<span id="cb82-871"><a href="#cb82-871" aria-hidden="true" tabindex="-1"></a>    <span class="st">"male"</span> <span class="ot">=</span> <span class="st">"male"</span>,</span>
<span id="cb82-872"><a href="#cb82-872" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ordr"</span> <span class="ot">=</span> <span class="st">"presentation order"</span>,</span>
<span id="cb82-873"><a href="#cb82-873" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ses"</span> <span class="ot">=</span> <span class="st">"perceived SES"</span>,</span>
<span id="cb82-874"><a href="#cb82-874" aria-hidden="true" tabindex="-1"></a>    <span class="st">"edu"</span> <span class="ot">=</span> <span class="st">"education"</span>,</span>
<span id="cb82-875"><a href="#cb82-875" aria-hidden="true" tabindex="-1"></a>    <span class="st">"age"</span> <span class="ot">=</span> <span class="st">"age"</span></span>
<span id="cb82-876"><a href="#cb82-876" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb82-877"><a href="#cb82-877" aria-hidden="true" tabindex="-1"></a>)<span class="sc">|&gt;</span></span>
<span id="cb82-878"><a href="#cb82-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="st">"rel"</span>)</span>
<span id="cb82-879"><a href="#cb82-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-880"><a href="#cb82-880" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(dg_3, <span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels  =</span> <span class="st">"label"</span>)</span>
<span id="cb82-881"><a href="#cb82-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-882"><a href="#cb82-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-883"><a href="#cb82-883" aria-hidden="true" tabindex="-1"></a>We turn to our trusted oracle, and and ask: "What do we condition on to obtain an unbiased causal estimate?"</span>
<span id="cb82-884"><a href="#cb82-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-885"><a href="#cb82-885" aria-hidden="true" tabindex="-1"></a>The oracle replies:</span>
<span id="cb82-886"><a href="#cb82-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-889"><a href="#cb82-889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-890"><a href="#cb82-890" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>(</span>
<span id="cb82-891"><a href="#cb82-891" aria-hidden="true" tabindex="-1"></a>  dg_3,</span>
<span id="cb82-892"><a href="#cb82-892" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"sr"</span>,</span>
<span id="cb82-893"><a href="#cb82-893" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"b"</span>,</span>
<span id="cb82-894"><a href="#cb82-894" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-895"><a href="#cb82-895" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels  =</span> <span class="st">"label"</span></span>
<span id="cb82-896"><a href="#cb82-896" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb82-897"><a href="#cb82-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag_blank</span>() <span class="sc">+</span></span>
<span id="cb82-898"><a href="#cb82-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Adjustment set"</span>,</span>
<span id="cb82-899"><a href="#cb82-899" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtite =</span> <span class="st">"Model for Source credibility from belief "</span>)</span>
<span id="cb82-900"><a href="#cb82-900" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-901"><a href="#cb82-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-902"><a href="#cb82-902" aria-hidden="true" tabindex="-1"></a>Your data cannot answer your question.</span>
<span id="cb82-903"><a href="#cb82-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-904"><a href="#cb82-904" aria-hidden="true" tabindex="-1"></a><span class="fu">## More examples of counfounding/de-confounding</span></span>
<span id="cb82-905"><a href="#cb82-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-906"><a href="#cb82-906" aria-hidden="true" tabindex="-1"></a>Here's another example from recent NZAVS research</span>
<span id="cb82-907"><a href="#cb82-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-910"><a href="#cb82-910" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-911"><a href="#cb82-911" aria-hidden="true" tabindex="-1"></a>tidy_ggdag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb82-912"><a href="#cb82-912" aria-hidden="true" tabindex="-1"></a>  WB <span class="sc">~</span> belief <span class="sc">+</span> age_within <span class="sc">+</span> age_between <span class="sc">+</span> partner <span class="sc">+</span> nzdep <span class="sc">+</span> urban <span class="sc">+</span> male <span class="sc">+</span> pols <span class="sc">+</span> empl,</span>
<span id="cb82-913"><a href="#cb82-913" aria-hidden="true" tabindex="-1"></a>  WB <span class="sc">~</span><span class="er">~</span> partner,</span>
<span id="cb82-914"><a href="#cb82-914" aria-hidden="true" tabindex="-1"></a>  belief <span class="sc">~</span> age_within <span class="sc">+</span> age_between <span class="sc">+</span> male <span class="sc">+</span> ethn,</span>
<span id="cb82-915"><a href="#cb82-915" aria-hidden="true" tabindex="-1"></a>  partner <span class="sc">~</span> nzdep <span class="sc">+</span> age_within <span class="sc">+</span> age_between <span class="sc">+</span> belief, </span>
<span id="cb82-916"><a href="#cb82-916" aria-hidden="true" tabindex="-1"></a>  nzdep <span class="sc">~</span> empl <span class="sc">+</span> age_within <span class="sc">+</span> age_between,</span>
<span id="cb82-917"><a href="#cb82-917" aria-hidden="true" tabindex="-1"></a>  pols <span class="sc">~</span> age_within <span class="sc">+</span> age_between <span class="sc">+</span> empl <span class="sc">+</span> ethn,</span>
<span id="cb82-918"><a href="#cb82-918" aria-hidden="true" tabindex="-1"></a>  empl <span class="sc">~</span>  edu <span class="sc">+</span> ethn <span class="sc">+</span> age_within <span class="sc">+</span> age_between,</span>
<span id="cb82-919"><a href="#cb82-919" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span>  <span class="st">"belief"</span>,</span>
<span id="cb82-920"><a href="#cb82-920" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span>   <span class="st">"WB"</span>)<span class="sc">|&gt;</span></span>
<span id="cb82-921"><a href="#cb82-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>()</span>
<span id="cb82-922"><a href="#cb82-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-923"><a href="#cb82-923" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb82-924"><a href="#cb82-924" aria-hidden="true" tabindex="-1"></a>tidy_ggdag <span class="sc">|&gt;</span></span>
<span id="cb82-925"><a href="#cb82-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span>
<span id="cb82-926"><a href="#cb82-926" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-927"><a href="#cb82-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-928"><a href="#cb82-928" aria-hidden="true" tabindex="-1"></a>We can examine which variables to select, conditional on the causal assumptions of this dag</span>
<span id="cb82-929"><a href="#cb82-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-930"><a href="#cb82-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-933"><a href="#cb82-933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-934"><a href="#cb82-934" aria-hidden="true" tabindex="-1"></a><span class="co"># graph adjustment sets</span></span>
<span id="cb82-935"><a href="#cb82-935" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>(tidy_ggdag, <span class="at">node_size =</span> <span class="dv">14</span>) <span class="sc">+</span> </span>
<span id="cb82-936"><a href="#cb82-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span>
<span id="cb82-937"><a href="#cb82-937" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-938"><a href="#cb82-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-939"><a href="#cb82-939" aria-hidden="true" tabindex="-1"></a>This method reveals two adjustments sets: {age, employment, male,</span>
<span id="cb82-940"><a href="#cb82-940" aria-hidden="true" tabindex="-1"></a>political conservativism, and time}, and {age, ethnicty, male, and</span>
<span id="cb82-941"><a href="#cb82-941" aria-hidden="true" tabindex="-1"></a>time.} We report the second set because employment is likely to contain</span>
<span id="cb82-942"><a href="#cb82-942" aria-hidden="true" tabindex="-1"></a>more measurement error: some are not employed because they cannot find</span>
<span id="cb82-943"><a href="#cb82-943" aria-hidden="true" tabindex="-1"></a>employment, others because they are not seeking employment (e.g.</span>
<span id="cb82-944"><a href="#cb82-944" aria-hidden="true" tabindex="-1"></a>retirement).</span>
<span id="cb82-945"><a href="#cb82-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-946"><a href="#cb82-946" aria-hidden="true" tabindex="-1"></a><span class="fu">### Unmeasured causes</span></span>
<span id="cb82-947"><a href="#cb82-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-948"><a href="#cb82-948" aria-hidden="true" tabindex="-1"></a>Return to the previous example of R and C on K6 distress, but imagine an underlying common cause of both C and R (say childhood upbringing) called "U":</span>
<span id="cb82-949"><a href="#cb82-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-952"><a href="#cb82-952" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-953"><a href="#cb82-953" aria-hidden="true" tabindex="-1"></a>dag_m3 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb82-954"><a href="#cb82-954" aria-hidden="true" tabindex="-1"></a>  K <span class="sc">~</span> C <span class="sc">+</span> R,</span>
<span id="cb82-955"><a href="#cb82-955" aria-hidden="true" tabindex="-1"></a>  C <span class="sc">~</span> U,</span>
<span id="cb82-956"><a href="#cb82-956" aria-hidden="true" tabindex="-1"></a>  R <span class="sc">~</span> U,</span>
<span id="cb82-957"><a href="#cb82-957" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"C"</span>,</span>
<span id="cb82-958"><a href="#cb82-958" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"K"</span>,</span>
<span id="cb82-959"><a href="#cb82-959" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"U"</span></span>
<span id="cb82-960"><a href="#cb82-960" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb82-961"><a href="#cb82-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"nicely"</span>)</span>
<span id="cb82-962"><a href="#cb82-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-963"><a href="#cb82-963" aria-hidden="true" tabindex="-1"></a>dag_m3 <span class="sc">|&gt;</span></span>
<span id="cb82-964"><a href="#cb82-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span>
<span id="cb82-965"><a href="#cb82-965" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-966"><a href="#cb82-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-967"><a href="#cb82-967" aria-hidden="true" tabindex="-1"></a>How do we assess the relationship of C on K?</span>
<span id="cb82-968"><a href="#cb82-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-969"><a href="#cb82-969" aria-hidden="true" tabindex="-1"></a>We can close the backdoor from U through R by conditioning on R</span>
<span id="cb82-970"><a href="#cb82-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-973"><a href="#cb82-973" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-974"><a href="#cb82-974" aria-hidden="true" tabindex="-1"></a>ggdag<span class="sc">::</span><span class="fu">ggdag_adjustment_set</span>(dag_m3)</span>
<span id="cb82-975"><a href="#cb82-975" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-976"><a href="#cb82-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-977"><a href="#cb82-977" aria-hidden="true" tabindex="-1"></a>Aside, we can simulate this relationship using the following code:</span>
<span id="cb82-978"><a href="#cb82-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-981"><a href="#cb82-981" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-982"><a href="#cb82-982" aria-hidden="true" tabindex="-1"></a><span class="co"># C -&gt; K &lt;- R</span></span>
<span id="cb82-983"><a href="#cb82-983" aria-hidden="true" tabindex="-1"></a><span class="co"># C &lt;- U -&gt; R</span></span>
<span id="cb82-984"><a href="#cb82-984" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb82-985"><a href="#cb82-985" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n )</span>
<span id="cb82-986"><a href="#cb82-986" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n , U )</span>
<span id="cb82-987"><a href="#cb82-987" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n , U )</span>
<span id="cb82-988"><a href="#cb82-988" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( n , R <span class="sc">-</span> C )</span>
<span id="cb82-989"><a href="#cb82-989" aria-hidden="true" tabindex="-1"></a>d_sim3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> K, <span class="at">R =</span> R, <span class="at">U =</span> U, <span class="at">C =</span> C )</span>
<span id="cb82-990"><a href="#cb82-990" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-991"><a href="#cb82-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-992"><a href="#cb82-992" aria-hidden="true" tabindex="-1"></a><span class="fu">### What is the relationship between smoking and cardiac arrest?</span></span>
<span id="cb82-993"><a href="#cb82-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-994"><a href="#cb82-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-995"><a href="#cb82-995" aria-hidden="true" tabindex="-1"></a>This example is from the <span class="in">`ggdag`</span> package, by Malcolm Barrett <span class="co">[</span><span class="ot">here</span><span class="co">](https://ggdag.malco.io/)</span></span>
<span id="cb82-996"><a href="#cb82-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-999"><a href="#cb82-999" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1000"><a href="#cb82-1000" aria-hidden="true" tabindex="-1"></a>smoking_ca_dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb82-1001"><a href="#cb82-1001" aria-hidden="true" tabindex="-1"></a>  cardiacarrest <span class="sc">~</span> cholesterol,</span>
<span id="cb82-1002"><a href="#cb82-1002" aria-hidden="true" tabindex="-1"></a>  cholesterol <span class="sc">~</span> smoking <span class="sc">+</span> weight,</span>
<span id="cb82-1003"><a href="#cb82-1003" aria-hidden="true" tabindex="-1"></a>  smoking <span class="sc">~</span> unhealthy,</span>
<span id="cb82-1004"><a href="#cb82-1004" aria-hidden="true" tabindex="-1"></a>  weight <span class="sc">~</span> unhealthy,</span>
<span id="cb82-1005"><a href="#cb82-1005" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb82-1006"><a href="#cb82-1006" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cardiacarrest"</span> <span class="ot">=</span> <span class="st">"Cardiac</span><span class="sc">\n</span><span class="st"> Arrest"</span>,</span>
<span id="cb82-1007"><a href="#cb82-1007" aria-hidden="true" tabindex="-1"></a>    <span class="st">"smoking"</span> <span class="ot">=</span> <span class="st">"Smoking"</span>,</span>
<span id="cb82-1008"><a href="#cb82-1008" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cholesterol"</span> <span class="ot">=</span> <span class="st">"Cholesterol"</span>,</span>
<span id="cb82-1009"><a href="#cb82-1009" aria-hidden="true" tabindex="-1"></a>    <span class="st">"unhealthy"</span> <span class="ot">=</span> <span class="st">"Unhealthy</span><span class="sc">\n</span><span class="st"> Lifestyle"</span>,</span>
<span id="cb82-1010"><a href="#cb82-1010" aria-hidden="true" tabindex="-1"></a>    <span class="st">"weight"</span> <span class="ot">=</span> <span class="st">"Weight"</span></span>
<span id="cb82-1011"><a href="#cb82-1011" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb82-1012"><a href="#cb82-1012" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"unhealthy"</span>,</span>
<span id="cb82-1013"><a href="#cb82-1013" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"smoking"</span>,</span>
<span id="cb82-1014"><a href="#cb82-1014" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"cardiacarrest"</span></span>
<span id="cb82-1015"><a href="#cb82-1015" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-1016"><a href="#cb82-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1017"><a href="#cb82-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(smoking_ca_dag,</span>
<span id="cb82-1018"><a href="#cb82-1018" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-1019"><a href="#cb82-1019" aria-hidden="true" tabindex="-1"></a>      <span class="at">use_labels =</span> <span class="st">"label"</span>)</span>
<span id="cb82-1020"><a href="#cb82-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1021"><a href="#cb82-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1022"><a href="#cb82-1022" aria-hidden="true" tabindex="-1"></a>What do we condition on to close any open backdoor paths, while avoiding colliders? We imagine that unhealthy lifestyle is unmeasured.</span>
<span id="cb82-1023"><a href="#cb82-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1026"><a href="#cb82-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1027"><a href="#cb82-1027" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_adjustment_set</span>(</span>
<span id="cb82-1028"><a href="#cb82-1028" aria-hidden="true" tabindex="-1"></a>  smoking_ca_dag,</span>
<span id="cb82-1029"><a href="#cb82-1029" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-1030"><a href="#cb82-1030" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels =</span> <span class="st">"label"</span>,</span>
<span id="cb82-1031"><a href="#cb82-1031" aria-hidden="true" tabindex="-1"></a>  <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb82-1032"><a href="#cb82-1032" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-1033"><a href="#cb82-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1034"><a href="#cb82-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1035"><a href="#cb82-1035" aria-hidden="true" tabindex="-1"></a>What if we control for cholesterol?</span>
<span id="cb82-1036"><a href="#cb82-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1039"><a href="#cb82-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1040"><a href="#cb82-1040" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_dseparated</span>(</span>
<span id="cb82-1041"><a href="#cb82-1041" aria-hidden="true" tabindex="-1"></a>  smoking_ca_dag,</span>
<span id="cb82-1042"><a href="#cb82-1042" aria-hidden="true" tabindex="-1"></a>  <span class="at">controlling_for =</span> <span class="fu">c</span>(<span class="st">"weight"</span>, <span class="st">"cholesterol"</span>),</span>
<span id="cb82-1043"><a href="#cb82-1043" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-1044"><a href="#cb82-1044" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels =</span> <span class="st">"label"</span>,</span>
<span id="cb82-1045"><a href="#cb82-1045" aria-hidden="true" tabindex="-1"></a>  <span class="at">collider_lines =</span> <span class="cn">FALSE</span></span>
<span id="cb82-1046"><a href="#cb82-1046" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-1047"><a href="#cb82-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1048"><a href="#cb82-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1049"><a href="#cb82-1049" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Controlling for intermediate variables may also induce bias, because it decomposes the total effect of x on y into its parts. (ggdag documentation)</span></span>
<span id="cb82-1050"><a href="#cb82-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1051"><a href="#cb82-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">### Selection bias in sampling</span></span>
<span id="cb82-1052"><a href="#cb82-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1053"><a href="#cb82-1053" aria-hidden="true" tabindex="-1"></a>This example is from <span class="ot">&lt;https://ggdag.malco.io/articles/bias-structures.html&gt;</span></span>
<span id="cb82-1054"><a href="#cb82-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1055"><a href="#cb82-1055" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Let's say we're doing a case-control study and want to assess the effect of smoking on glioma, a type of brain cancer. We have a group of glioma patients at a hospital and want to compare them to a group of controls, so we pick people in the hospital with a broken bone, since that seems to have nothing to do with brain cancer. However, perhaps there is some unknown confounding between smoking and being in the hospital with a broken bone, like being prone to reckless behavior. In the normal population, there is no causal effect of smoking on glioma, but in our case, we're selecting on people who have been hospitalized, which opens up a back-door path:</span></span>
<span id="cb82-1056"><a href="#cb82-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1059"><a href="#cb82-1059" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1060"><a href="#cb82-1060" aria-hidden="true" tabindex="-1"></a>coords_mine <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb82-1061"><a href="#cb82-1061" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>name,           <span class="sc">~</span>x,  <span class="sc">~</span>y,</span>
<span id="cb82-1062"><a href="#cb82-1062" aria-hidden="true" tabindex="-1"></a>  <span class="st">"glioma"</span>,         <span class="dv">1</span>,   <span class="dv">2</span>,</span>
<span id="cb82-1063"><a href="#cb82-1063" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hospitalized"</span>,   <span class="dv">2</span>,   <span class="dv">3</span>,</span>
<span id="cb82-1064"><a href="#cb82-1064" aria-hidden="true" tabindex="-1"></a>  <span class="st">"broken_bone"</span>,    <span class="dv">3</span>,   <span class="dv">2</span>,</span>
<span id="cb82-1065"><a href="#cb82-1065" aria-hidden="true" tabindex="-1"></a>  <span class="st">"reckless"</span>,       <span class="dv">4</span>,   <span class="dv">1</span>,</span>
<span id="cb82-1066"><a href="#cb82-1066" aria-hidden="true" tabindex="-1"></a>  <span class="st">"smoking"</span>,        <span class="dv">5</span>,   <span class="dv">2</span></span>
<span id="cb82-1067"><a href="#cb82-1067" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-1068"><a href="#cb82-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1069"><a href="#cb82-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(hospitalized <span class="sc">~</span> broken_bone <span class="sc">+</span> glioma,</span>
<span id="cb82-1070"><a href="#cb82-1070" aria-hidden="true" tabindex="-1"></a>       broken_bone <span class="sc">~</span> reckless,</span>
<span id="cb82-1071"><a href="#cb82-1071" aria-hidden="true" tabindex="-1"></a>       smoking <span class="sc">~</span> reckless,</span>
<span id="cb82-1072"><a href="#cb82-1072" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">hospitalized =</span> <span class="st">"Hospitalization"</span>,</span>
<span id="cb82-1073"><a href="#cb82-1073" aria-hidden="true" tabindex="-1"></a>                  <span class="at">broken_bone =</span> <span class="st">"Broken Bone"</span>,</span>
<span id="cb82-1074"><a href="#cb82-1074" aria-hidden="true" tabindex="-1"></a>                  <span class="at">glioma =</span> <span class="st">"Glioma"</span>,</span>
<span id="cb82-1075"><a href="#cb82-1075" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reckless =</span> <span class="st">"Reckless </span><span class="sc">\n</span><span class="st">Behavior"</span>,</span>
<span id="cb82-1076"><a href="#cb82-1076" aria-hidden="true" tabindex="-1"></a>                  <span class="at">smoking =</span> <span class="st">"Smoking"</span>),</span>
<span id="cb82-1077"><a href="#cb82-1077" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> coords_mine) <span class="sc">|&gt;</span> </span>
<span id="cb82-1078"><a href="#cb82-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dconnected</span>(<span class="st">"glioma"</span>, <span class="st">"smoking"</span>, <span class="at">controlling_for =</span> <span class="st">"hospitalized"</span>, </span>
<span id="cb82-1079"><a href="#cb82-1079" aria-hidden="true" tabindex="-1"></a>                   <span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels =</span> <span class="st">"label"</span>, <span class="at">collider_lines =</span> <span class="cn">FALSE</span>)</span>
<span id="cb82-1080"><a href="#cb82-1080" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1081"><a href="#cb82-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1082"><a href="#cb82-1082" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Even though smoking doesn't actually cause glioma, it will appear as if there is an association. Actually, in this case, it may make smoking appear to be protective against glioma, since controls are more likely to be smokers.</span></span>
<span id="cb82-1083"><a href="#cb82-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1084"><a href="#cb82-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">### Selection bias in longitudinal research</span></span>
<span id="cb82-1085"><a href="#cb82-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1086"><a href="#cb82-1086" aria-hidden="true" tabindex="-1"></a>Suppose we want to estimate the effect of ethnicity on ecological orientation in a longitudinal dataset where there is selection bias from homeownership (it is easier to reach homeowners by the mail.)</span>
<span id="cb82-1087"><a href="#cb82-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1088"><a href="#cb82-1088" aria-hidden="true" tabindex="-1"></a>Suppose the following DAG:</span>
<span id="cb82-1089"><a href="#cb82-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1092"><a href="#cb82-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1093"><a href="#cb82-1093" aria-hidden="true" tabindex="-1"></a>dag_sel <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb82-1094"><a href="#cb82-1094" aria-hidden="true" tabindex="-1"></a>  retained <span class="sc">~</span> homeowner,</span>
<span id="cb82-1095"><a href="#cb82-1095" aria-hidden="true" tabindex="-1"></a>  homeowner <span class="sc">~</span> income <span class="sc">+</span> ethnicity,</span>
<span id="cb82-1096"><a href="#cb82-1096" aria-hidden="true" tabindex="-1"></a>  ecologicalvalues <span class="sc">~</span>  ethnicity <span class="sc">+</span> income,</span>
<span id="cb82-1097"><a href="#cb82-1097" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb82-1098"><a href="#cb82-1098" aria-hidden="true" tabindex="-1"></a>    <span class="at">retained =</span> <span class="st">"retained"</span>,</span>
<span id="cb82-1099"><a href="#cb82-1099" aria-hidden="true" tabindex="-1"></a>    <span class="at">homeowner =</span> <span class="st">"homeowner"</span>,</span>
<span id="cb82-1100"><a href="#cb82-1100" aria-hidden="true" tabindex="-1"></a>    <span class="at">ethnicity =</span> <span class="st">"ethnicity"</span>,</span>
<span id="cb82-1101"><a href="#cb82-1101" aria-hidden="true" tabindex="-1"></a>    <span class="at">income =</span> <span class="st">"income"</span>,</span>
<span id="cb82-1102"><a href="#cb82-1102" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecologicalvalues =</span> <span class="st">"Ecological </span><span class="sc">\n</span><span class="st"> Orientation"</span></span>
<span id="cb82-1103"><a href="#cb82-1103" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb82-1104"><a href="#cb82-1104" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"ethnicity"</span>,</span>
<span id="cb82-1105"><a href="#cb82-1105" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"ecologicalvalues"</span></span>
<span id="cb82-1106"><a href="#cb82-1106" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb82-1107"><a href="#cb82-1107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="st">"retained"</span>)</span>
<span id="cb82-1108"><a href="#cb82-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1109"><a href="#cb82-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1110"><a href="#cb82-1110" aria-hidden="true" tabindex="-1"></a>dag_sel <span class="sc">|&gt;</span></span>
<span id="cb82-1111"><a href="#cb82-1111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_adjust</span>(</span>
<span id="cb82-1112"><a href="#cb82-1112" aria-hidden="true" tabindex="-1"></a>    <span class="st">"retained"</span>,</span>
<span id="cb82-1113"><a href="#cb82-1113" aria-hidden="true" tabindex="-1"></a>    <span class="at">layout =</span> <span class="st">"mds"</span>,</span>
<span id="cb82-1114"><a href="#cb82-1114" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-1115"><a href="#cb82-1115" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>,</span>
<span id="cb82-1116"><a href="#cb82-1116" aria-hidden="true" tabindex="-1"></a>    <span class="at">collider_lines =</span> <span class="cn">FALSE</span></span>
<span id="cb82-1117"><a href="#cb82-1117" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb82-1118"><a href="#cb82-1118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1119"><a href="#cb82-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1120"><a href="#cb82-1120" aria-hidden="true" tabindex="-1"></a>Notice that "retained" falls downstream from a collider, "home ownership"</span>
<span id="cb82-1121"><a href="#cb82-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1124"><a href="#cb82-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1125"><a href="#cb82-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_collider</span>(dag_sel)</span>
<span id="cb82-1126"><a href="#cb82-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1127"><a href="#cb82-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1128"><a href="#cb82-1128" aria-hidden="true" tabindex="-1"></a>Because we are stratifying on "retained", we introduce collider bias in our estimate of ethnicity on ecological values.</span>
<span id="cb82-1129"><a href="#cb82-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1130"><a href="#cb82-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1133"><a href="#cb82-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1134"><a href="#cb82-1134" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_dseparated</span>(</span>
<span id="cb82-1135"><a href="#cb82-1135" aria-hidden="true" tabindex="-1"></a>  dag_sel,</span>
<span id="cb82-1136"><a href="#cb82-1136" aria-hidden="true" tabindex="-1"></a>  <span class="at">controlling_for =</span> <span class="st">"retained"</span>,</span>
<span id="cb82-1137"><a href="#cb82-1137" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-1138"><a href="#cb82-1138" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_labels =</span> <span class="st">"label"</span>,</span>
<span id="cb82-1139"><a href="#cb82-1139" aria-hidden="true" tabindex="-1"></a>  <span class="at">collider_lines =</span> <span class="cn">TRUE</span></span>
<span id="cb82-1140"><a href="#cb82-1140" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-1141"><a href="#cb82-1141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1142"><a href="#cb82-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1143"><a href="#cb82-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1144"><a href="#cb82-1144" aria-hidden="true" tabindex="-1"></a>However we have an adjustment set</span>
<span id="cb82-1145"><a href="#cb82-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1148"><a href="#cb82-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1149"><a href="#cb82-1149" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_adjustment_set</span>(dag_sel)</span>
<span id="cb82-1150"><a href="#cb82-1150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb82-1151"><a href="#cb82-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1152"><a href="#cb82-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">## Workflow</span></span>
<span id="cb82-1153"><a href="#cb82-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1154"><a href="#cb82-1154" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Import your data</span>
<span id="cb82-1155"><a href="#cb82-1155" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Check that data types are correct</span>
<span id="cb82-1156"><a href="#cb82-1156" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Graph your data</span>
<span id="cb82-1157"><a href="#cb82-1157" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Consider your question</span>
<span id="cb82-1158"><a href="#cb82-1158" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>If causal, draw your DAG/S</span>
<span id="cb82-1159"><a href="#cb82-1159" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Explain your DAG's</span>
<span id="cb82-1160"><a href="#cb82-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Write your model</span>
<span id="cb82-1161"><a href="#cb82-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Run your model</span>
<span id="cb82-1162"><a href="#cb82-1162" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Graph and interpret your results</span>
<span id="cb82-1163"><a href="#cb82-1163" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Return to your question, and assess what you have learned. </span>
<span id="cb82-1164"><a href="#cb82-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1165"><a href="#cb82-1165" aria-hidden="true" tabindex="-1"></a>(Typically there are multiple iterations between these steps in your workflow. Annotate your scripts; keep track of your decisions)</span>
<span id="cb82-1166"><a href="#cb82-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1167"><a href="#cb82-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1168"><a href="#cb82-1168" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb82-1169"><a href="#cb82-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1170"><a href="#cb82-1170" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>We control for variables to avoid omitted variable bias</span>
<span id="cb82-1171"><a href="#cb82-1171" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>Omitted variable bias is real, but also commonplace is included variable bias</span>
<span id="cb82-1172"><a href="#cb82-1172" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>Included variable biases arise from "pipes", "colliders", and conditioning on descendant of colliders.</span>
<span id="cb82-1173"><a href="#cb82-1173" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>The <span class="in">`ggdag`</span> package can help you to obtain causal inference, but it relies on assumptions that are not part of your data. </span>
<span id="cb82-1174"><a href="#cb82-1174" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>Clarify your assumption.</span>
<span id="cb82-1175"><a href="#cb82-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1176"><a href="#cb82-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1177"><a href="#cb82-1177" aria-hidden="true" tabindex="-1"></a><span class="fu">### Packages</span></span>
<span id="cb82-1178"><a href="#cb82-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1181"><a href="#cb82-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1182"><a href="#cb82-1182" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span>
<span id="cb82-1183"><a href="#cb82-1183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1184"><a href="#cb82-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1185"><a href="#cb82-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1186"><a href="#cb82-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1187"><a href="#cb82-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1188"><a href="#cb82-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">#### OTHER MATERIAL: </span></span>
<span id="cb82-1189"><a href="#cb82-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1190"><a href="#cb82-1190" aria-hidden="true" tabindex="-1"></a>Selection bias is commonplace.</span>
<span id="cb82-1191"><a href="#cb82-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1192"><a href="#cb82-1192" aria-hidden="true" tabindex="-1"></a><span class="fu">## Collider bias within experiments</span></span>
<span id="cb82-1193"><a href="#cb82-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1194"><a href="#cb82-1194" aria-hidden="true" tabindex="-1"></a>We noted that conditioning on a post-treatment variable can induce bias by blocking the path between the experimental manipulation and the outcome. However, such conditioning can open a path even when there is no experimental effect.</span>
<span id="cb82-1195"><a href="#cb82-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1196"><a href="#cb82-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  code_folding = TRUE}</span></span>
<span id="cb82-1197"><a href="#cb82-1197" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb82-1198"><a href="#cb82-1198" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> C0 <span class="sc">+</span> U,</span>
<span id="cb82-1199"><a href="#cb82-1199" aria-hidden="true" tabindex="-1"></a>  Ch <span class="sc">~</span> U <span class="sc">+</span> R,</span>
<span id="cb82-1200"><a href="#cb82-1200" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb82-1201"><a href="#cb82-1201" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R"</span> <span class="ot">=</span> <span class="st">"Ritual"</span>,</span>
<span id="cb82-1202"><a href="#cb82-1202" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C1"</span> <span class="ot">=</span> <span class="st">"Charity-post"</span>,</span>
<span id="cb82-1203"><a href="#cb82-1203" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C0"</span> <span class="ot">=</span> <span class="st">"Charity-pre"</span>,</span>
<span id="cb82-1204"><a href="#cb82-1204" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ch"</span> <span class="ot">=</span> <span class="st">"Cohesion"</span>,</span>
<span id="cb82-1205"><a href="#cb82-1205" aria-hidden="true" tabindex="-1"></a>    <span class="st">"U"</span> <span class="ot">=</span> <span class="st">"Religiousness (Unmeasured)"</span></span>
<span id="cb82-1206"><a href="#cb82-1206" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb82-1207"><a href="#cb82-1207" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"R"</span>,</span>
<span id="cb82-1208"><a href="#cb82-1208" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"C1"</span>,</span>
<span id="cb82-1209"><a href="#cb82-1209" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"U"</span></span>
<span id="cb82-1210"><a href="#cb82-1210" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb82-1211"><a href="#cb82-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="fu">c</span>(<span class="st">"Ch"</span>,<span class="st">"C0"</span>))  </span>
<span id="cb82-1212"><a href="#cb82-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1213"><a href="#cb82-1213" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="sc">|&gt;</span></span>
<span id="cb82-1214"><a href="#cb82-1214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>( <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-1215"><a href="#cb82-1215" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>)</span>
<span id="cb82-1216"><a href="#cb82-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1217"><a href="#cb82-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1218"><a href="#cb82-1218" aria-hidden="true" tabindex="-1"></a>How do we avoid collider-bias here?</span>
<span id="cb82-1219"><a href="#cb82-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1220"><a href="#cb82-1220" aria-hidden="true" tabindex="-1"></a>Note what happens if we condition on cohesion?</span>
<span id="cb82-1221"><a href="#cb82-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1224"><a href="#cb82-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1225"><a href="#cb82-1225" aria-hidden="true" tabindex="-1"></a>dag_ex2 <span class="sc">|&gt;</span></span>
<span id="cb82-1226"><a href="#cb82-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_collider</span>(</span>
<span id="cb82-1227"><a href="#cb82-1227" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-1228"><a href="#cb82-1228" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span></span>
<span id="cb82-1229"><a href="#cb82-1229" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb82-1230"><a href="#cb82-1230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Cohesion is a collider that opens a path from ritual to charity"</span>)</span>
<span id="cb82-1231"><a href="#cb82-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1232"><a href="#cb82-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1233"><a href="#cb82-1233" aria-hidden="true" tabindex="-1"></a>Don't condition on a post-treatment variable!</span>
<span id="cb82-1234"><a href="#cb82-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1237"><a href="#cb82-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1238"><a href="#cb82-1238" aria-hidden="true" tabindex="-1"></a>dag_ex3 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb82-1239"><a href="#cb82-1239" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> C0,</span>
<span id="cb82-1240"><a href="#cb82-1240" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">~</span> U,</span>
<span id="cb82-1241"><a href="#cb82-1241" aria-hidden="true" tabindex="-1"></a>  Ch <span class="sc">~</span> U <span class="sc">+</span> R,</span>
<span id="cb82-1242"><a href="#cb82-1242" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb82-1243"><a href="#cb82-1243" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R"</span> <span class="ot">=</span> <span class="st">"Ritual"</span>,</span>
<span id="cb82-1244"><a href="#cb82-1244" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C1"</span> <span class="ot">=</span> <span class="st">"Charity-post"</span>,</span>
<span id="cb82-1245"><a href="#cb82-1245" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C0"</span> <span class="ot">=</span> <span class="st">"Charity-pre"</span>,</span>
<span id="cb82-1246"><a href="#cb82-1246" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ch"</span> <span class="ot">=</span> <span class="st">"Cohesion"</span>,</span>
<span id="cb82-1247"><a href="#cb82-1247" aria-hidden="true" tabindex="-1"></a>    <span class="st">"U"</span> <span class="ot">=</span> <span class="st">"Religiousness (Unmeasured)"</span></span>
<span id="cb82-1248"><a href="#cb82-1248" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb82-1249"><a href="#cb82-1249" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"R"</span>,</span>
<span id="cb82-1250"><a href="#cb82-1250" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"C1"</span>,</span>
<span id="cb82-1251"><a href="#cb82-1251" aria-hidden="true" tabindex="-1"></a>  <span class="at">latent =</span> <span class="st">"U"</span></span>
<span id="cb82-1252"><a href="#cb82-1252" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-1253"><a href="#cb82-1253" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag_adjustment_set</span>(dag_ex3)</span>
<span id="cb82-1254"><a href="#cb82-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1255"><a href="#cb82-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1256"><a href="#cb82-1256" aria-hidden="true" tabindex="-1"></a><span class="fu">## Taxonomy of confounding</span></span>
<span id="cb82-1257"><a href="#cb82-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1258"><a href="#cb82-1258" aria-hidden="true" tabindex="-1"></a>There is good news. Remember, ultimately are only four basic types of confounding:</span>
<span id="cb82-1259"><a href="#cb82-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1260"><a href="#cb82-1260" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Fork (omitted variable bias)</span></span>
<span id="cb82-1261"><a href="#cb82-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1264"><a href="#cb82-1264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1265"><a href="#cb82-1265" aria-hidden="true" tabindex="-1"></a><span class="fu">confounder_triangle</span>(<span class="at">x =</span> <span class="st">"Coffee"</span>,</span>
<span id="cb82-1266"><a href="#cb82-1266" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="st">"Lung Cancer"</span>,</span>
<span id="cb82-1267"><a href="#cb82-1267" aria-hidden="true" tabindex="-1"></a>                    <span class="at">z =</span> <span class="st">"Smoking"</span>) <span class="sc">|&gt;</span></span>
<span id="cb82-1268"><a href="#cb82-1268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dconnected</span>(<span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-1269"><a href="#cb82-1269" aria-hidden="true" tabindex="-1"></a>                   <span class="at">use_labels =</span> <span class="st">"label"</span>)</span>
<span id="cb82-1270"><a href="#cb82-1270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1271"><a href="#cb82-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1272"><a href="#cb82-1272" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Pipe (fully mediated effects)</span></span>
<span id="cb82-1273"><a href="#cb82-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1276"><a href="#cb82-1276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1277"><a href="#cb82-1277" aria-hidden="true" tabindex="-1"></a><span class="fu">mediation_triangle</span>(</span>
<span id="cb82-1278"><a href="#cb82-1278" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb82-1279"><a href="#cb82-1279" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb82-1280"><a href="#cb82-1280" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="cn">NULL</span>,</span>
<span id="cb82-1281"><a href="#cb82-1281" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_y_associated =</span> <span class="cn">FALSE</span></span>
<span id="cb82-1282"><a href="#cb82-1282" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb82-1283"><a href="#cb82-1283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>(<span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">|&gt;</span></span>
<span id="cb82-1284"><a href="#cb82-1284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag</span>()</span>
<span id="cb82-1285"><a href="#cb82-1285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1286"><a href="#cb82-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1287"><a href="#cb82-1287" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Collider</span></span>
<span id="cb82-1288"><a href="#cb82-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1289"><a href="#cb82-1289" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confounding by proxy</span></span>
<span id="cb82-1290"><a href="#cb82-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1291"><a href="#cb82-1291" aria-hidden="true" tabindex="-1"></a>If we "control for" a descendant of a collider, we will introduce collider bias.</span>
<span id="cb82-1292"><a href="#cb82-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1295"><a href="#cb82-1295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-1296"><a href="#cb82-1296" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb82-1297"><a href="#cb82-1297" aria-hidden="true" tabindex="-1"></a>  Z <span class="sc">~</span> X,</span>
<span id="cb82-1298"><a href="#cb82-1298" aria-hidden="true" tabindex="-1"></a>  Z <span class="sc">~</span> Y,</span>
<span id="cb82-1299"><a href="#cb82-1299" aria-hidden="true" tabindex="-1"></a>  D <span class="sc">~</span> Z,</span>
<span id="cb82-1300"><a href="#cb82-1300" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb82-1301"><a href="#cb82-1301" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Z"</span> <span class="ot">=</span> <span class="st">"Collider"</span>,</span>
<span id="cb82-1302"><a href="#cb82-1302" aria-hidden="true" tabindex="-1"></a>    <span class="st">"D"</span> <span class="ot">=</span> <span class="st">"Descendant"</span>,</span>
<span id="cb82-1303"><a href="#cb82-1303" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X"</span> <span class="ot">=</span> <span class="st">"X"</span>,</span>
<span id="cb82-1304"><a href="#cb82-1304" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y"</span> <span class="ot">=</span> <span class="st">"Y"</span></span>
<span id="cb82-1305"><a href="#cb82-1305" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb82-1306"><a href="#cb82-1306" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"X"</span>,</span>
<span id="cb82-1307"><a href="#cb82-1307" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"Y"</span></span>
<span id="cb82-1308"><a href="#cb82-1308" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb82-1309"><a href="#cb82-1309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">control_for</span>(<span class="st">"D"</span>) </span>
<span id="cb82-1310"><a href="#cb82-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1311"><a href="#cb82-1311" aria-hidden="true" tabindex="-1"></a>dag_sd <span class="sc">|&gt;</span></span>
<span id="cb82-1312"><a href="#cb82-1312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggdag_dseparated</span>(</span>
<span id="cb82-1313"><a href="#cb82-1313" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="st">"X"</span>,</span>
<span id="cb82-1314"><a href="#cb82-1314" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="st">"Y"</span>,</span>
<span id="cb82-1315"><a href="#cb82-1315" aria-hidden="true" tabindex="-1"></a>    <span class="at">controlling_for =</span> <span class="st">"D"</span>,</span>
<span id="cb82-1316"><a href="#cb82-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-1317"><a href="#cb82-1317" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span></span>
<span id="cb82-1318"><a href="#cb82-1318" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb82-1319"><a href="#cb82-1319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"X --&gt; Y, controlling for D"</span>,</span>
<span id="cb82-1320"><a href="#cb82-1320" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="st">"D induces collider bias"</span>)</span>
<span id="cb82-1321"><a href="#cb82-1321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-1322"><a href="#cb82-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-1323"><a href="#cb82-1323" aria-hidden="true" tabindex="-1"></a>  </span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>