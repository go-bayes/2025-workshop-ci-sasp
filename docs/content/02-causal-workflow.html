<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-11-19">

<title>The Causal Workflow – Beyond Correlation: Causal Inference Workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-49a824ff064150fa59632921ab93e189.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-49a824ff064150fa59632921ab93e189.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-49a824ff064150fa59632921ab93e189.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-4947089e38dab0514c2468e552089eef.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-5475859673c8942321190077812ac913.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-4947089e38dab0514c2468e552089eef.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Beyond Correlation: Causal Inference Workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-workshop-content" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Workshop Content</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-workshop-content">    
        <li>
    <a class="dropdown-item" href="../content/00-background.html">
 <span class="dropdown-text">1. What is Causality?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/01-background.html">
 <span class="dropdown-text">2. Identification Using Causal DAGs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/02-causal-workflow.html">
 <span class="dropdown-text">3. Causal Workflow</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/03-interaction.html">
 <span class="dropdown-text">4. Average and Conditional Average Treatment Effects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../workshop-scripts/06-interpretation-2.html">
 <span class="dropdown-text">5. Code Review</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../simulations/01-simulation-population.html">
 <span class="dropdown-text">Simulations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../pdfs/bulbulia-hand-outs/S2-glossary.pdf">
 <span class="dropdown-text">Glossary (PDF)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../glossary-and-dags.html"> 
<span class="menu-text">Glossary &amp; DAGs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../reading.html"> 
<span class="menu-text">Reading</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/go-bayes"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">Go-Bayes</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-causal-workflow" id="toc-the-causal-workflow" class="nav-link active" data-scroll-target="#the-causal-workflow">The Causal Workflow</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">The Causal Workflow</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 19, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Readings for Workshop
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Barrett M (2023). <em>ggdag: Analyze and Create Elegant Directed Acyclic Graphs</em>. R package version 0.2.7.9000, <a href="https://github.com/malcolmbarrett/ggdag" class="uri">https://github.com/malcolmbarrett/ggdag</a>
<ul>
<li>“An Introduction to Directed Acyclic Graphs”, <a href="https://r-causal.github.io/ggdag/articles/intro-to-dags.html" class="uri">https://r-causal.github.io/ggdag/articles/intro-to-dags.html</a></li>
<li>“Common Structures of Bias”, <a href="https://r-causal.github.io/ggdag/articles/bias-structures.html" class="uri">https://r-causal.github.io/ggdag/articles/bias-structures.html</a></li>
</ul></li>
</ul>
</div>
</div>
<section id="the-causal-workflow" class="level2">
<h2 class="anchored" data-anchor-id="the-causal-workflow">The Causal Workflow</h2>
<ol type="1">
<li><p><strong>State a well-defined treatment.</strong><br>
Specify the hypothetical intervention precisely enough that every member of the target population could, in principle, receive it. For example, ‘weight loss’ is too vague—people lose weight via exercise, diet, depression, cancer, amputation, and more <span class="citation" data-cites="hernan2024WHATIF">(<a href="#ref-hernan2024WHATIF" role="doc-biblioref">Hernan and Robins 2020</a>)</span>. A clearer intervention is: <em>“engage in vigorous physical activity for <span class="math inline">\ge</span> 30 minutes per day”</em> <span class="citation" data-cites="hernan2008aObservationalStudiesAnalysedLike">(<a href="#ref-hernan2008aObservationalStudiesAnalysedLike" role="doc-biblioref">Miguel A. Hernán et al. 2008</a>)</span>. Precision here underwrites consistency (see step 5) and interpretability downstream.</p></li>
<li><p><strong>State a well-defined outcome.</strong><br>
Define the outcome so the causal contrast is meaningful and temporally anchored. ‘Well-being’ is underspecified; <em>‘psychological distress one year post-intervention measured with the Kessler-6’</em> is interpretable and reproducible <span class="citation" data-cites="kessler2002">(<a href="#ref-kessler2002" role="doc-biblioref">Kessler et al. 2002</a>)</span>. Include timing, scale, and instrument.</p></li>
<li><p><strong>Clarify the target population.</strong><br>
Say exactly <em>who</em> you aim to inform. Eligibility rules define the <strong>source population</strong>, but sampling and participation can yield a <strong>study population</strong> with a different distribution of effect modifiers <span class="citation" data-cites="dahabreh2019 dahabreh2019generalizing stuart2018generalizability bulbulia2024wierd">(<a href="#ref-dahabreh2019" role="doc-biblioref">Issa J. Dahabreh and Hernán 2019</a>; <a href="#ref-dahabreh2019generalizing" role="doc-biblioref">Issa J. Dahabreh et al. 2019</a>; <a href="#ref-stuart2018generalizability" role="doc-biblioref">Stuart, Ackerman, and Westreich 2018</a>; <a href="#ref-bulbulia2024wierd" role="doc-biblioref">Bulbulia 2024</a>)</span>. If you intend to generalise beyond the source population (transport), articulate the additional conditions and knowledge required <span class="citation" data-cites="deffner2022 bareinboim2013general westreich2017transportability dahabreh2019 pearl2022external">(<a href="#ref-deffner2022" role="doc-biblioref">Deffner, Rohrer, and McElreath 2022</a>; <a href="#ref-bareinboim2013general" role="doc-biblioref">Bareinboim and Pearl 2013</a>; <a href="#ref-westreich2017transportability" role="doc-biblioref">Westreich et al. 2017</a>; <a href="#ref-dahabreh2019" role="doc-biblioref">Issa J. Dahabreh and Hernán 2019</a>; <a href="#ref-pearl2022external" role="doc-biblioref">Pearl and Bareinboim 2022</a>)</span>.</p></li>
<li><p><strong>Evaluate whether treatment groups are exchangeable given measured covariates.</strong><br>
Make the case that potential outcomes are independent of treatment conditional on covariates, i.e., <span class="math inline">Y(a)\coprod A\mid X</span> <span class="citation" data-cites="neal2020introduction morgan2014 angrist2009mostly hernan2024WHATIF">(<a href="#ref-neal2020introduction" role="doc-biblioref">Neal 2020</a>; <a href="#ref-morgan2014" role="doc-biblioref">Morgan and Winship 2014</a>; <a href="#ref-angrist2009mostly" role="doc-biblioref">Angrist and Pischke 2009</a>; <a href="#ref-hernan2024WHATIF" role="doc-biblioref">Hernan and Robins 2020</a>)</span>. Use design and diagnostics (design diagrams/DAGs, subject-matter arguments, pre-treatment covariate balance, overlap checks). If exchangeability is doubtful, redesign (e.g., stronger measurement, alternative identification strategies) rather than rely solely on modelling.</p></li>
<li><p><strong>Ensure treatments to be compared satisfy causal consistency.</strong><br>
Consistency requires that, for units receiving a treatment <em>version</em> compatible with level <span class="math inline">a</span>, the observed outcome equals <span class="math inline">Y(a)</span>; it also presumes well-defined versions and no interference between units <span class="citation" data-cites="vanderweele2013 hernan2024WHATIF">(<a href="#ref-vanderweele2013" role="doc-biblioref">Tyler J. VanderWeele and Hernan 2013</a>; <a href="#ref-hernan2024WHATIF" role="doc-biblioref">Hernan and Robins 2020</a>)</span>. When multiple versions exist, either refine the intervention so versions are irrelevant to <span class="math inline">Y(a)</span>, or condition on version-defining covariates in ways that preserve your estimand.</p></li>
<li><p><strong>Check the positivity (overlap) assumption.</strong><br>
Each treatment level must occur with non-zero probability at every covariate profile needed for exchangeability—and, when versions exist, for consistency as well <span class="citation" data-cites="westreich2010">(<a href="#ref-westreich2010" role="doc-biblioref">Westreich and Cole 2010</a>)</span>. Diagnose limited overlap (propensity score distributions, extreme weights), and consider design-stage remedies (trimming, restriction, adaptive sampling) before estimation.</p></li>
<li><p><strong>Ensure measurement aligns with the scientific question.</strong><br>
Verify that constructs are captured by instruments whose error structures won’t distort the causal contrast of interest. Be explicit about likely forms of measurement error (classical, Berkson, differential, misclassification) and their structural implications for bias <span class="citation" data-cites="hernan2024WHATIF vanderweele2012MEASUREMENT bulbulia2024wierd">(<a href="#ref-hernan2024WHATIF" role="doc-biblioref">Hernan and Robins 2020</a>; <a href="#ref-vanderweele2012MEASUREMENT" role="doc-biblioref">Tyler J. VanderWeele and Hernán 2012</a>; <a href="#ref-bulbulia2024wierd" role="doc-biblioref">Bulbulia 2024</a>)</span>. Where feasible, incorporate validation studies, multiple indicators, or calibration models.</p></li>
<li><p><strong>Preserve representativeness from start to finish.</strong><br>
End-of-study analyses should reflect the target population’s distribution of effect modifiers. Differential attrition, non-response, or measurement processes tied to treatment and outcomes can induce selection bias in the presence of true effects <span class="citation" data-cites="hernan2017SELECTIONWITHOUTCOLLIDER hernan2017per hernan2004STRUCTURAL bulbulia2024wierd">(<a href="#ref-hernan2017SELECTIONWITHOUTCOLLIDER" role="doc-biblioref">M. A. Hernán 2017</a>; <a href="#ref-hernan2017per" role="doc-biblioref">Miguel A. Hernán and Robins 2017</a>; <a href="#ref-hernan2004STRUCTURAL" role="doc-biblioref">Miguel A. Hernán, Hernández-Díaz, and Robins 2004</a>; <a href="#ref-bulbulia2024wierd" role="doc-biblioref">Bulbulia 2024</a>)</span>. Plan and justify strategies such as inverse probability weighting for censoring, multiple imputation under defensible mechanisms, sensitivity analyses for missing not at random, and careful timing of measurements.</p></li>
<li><p><strong>Document the reasoning that supports steps 1–8.</strong><br>
Make assumptions, disagreements, and judgement calls legible: register or otherwise time-stamp your analytic plan; include identification arguments (e.g., DAGs), code, and data where possible; report robustness and sensitivity analyses; and explain decisions about design restrictions, modelling choices, and transportability <span class="citation" data-cites="ogburn2021">(<a href="#ref-ogburn2021" role="doc-biblioref">Ogburn and Shpitser 2021</a>)</span>. Transparent reasoning is a scientific result in its own right.</p></li>
</ol>
<!-- ### 1 Nine‑Step Causal Inference Workflow  -->
<!-- | Step | Requirement | Key Question(s) | Example Good vs. Poor Definition | Core Assumption | -->
<!-- |------|-------------|-----------------|----------------------------------|-----------------| -->
<!-- | **1** | **State a Well-Defined Treatment** | What specific hypothetical intervention will be applied to all population members? | ✅ "Weight loss by at least 30 minutes of vigorous exercise each day" <br> ❌ "Weight loss" (many pathways: diet, exercise, illness, surgery) | **Consistency** | -->
<!-- | **2** | **State a Well-Defined Outcome** | What specific outcome measure will be assessed, when, and how? | ✅ "Psychological distress measured one year after intervention using Kessler-6 scale" <br> ❌ "Well-being" (vague construct) | **Interpretability** | -->
<!-- | **3** | **Clarify the Target Population** | To whom will results generalise? How does the source population relate to the target? | ✅ "New Zealand adults aged 18+ as represented in NZAVS weighted by census demographics" <br> ❌ "People in general" | **Generalisability** | -->
<!-- | **4** | **Evaluate Exchangeability** | Are treatment groups independent of potential outcomes conditional on measured covariates? | Can we achieve conditional independence through measured confounders? Consider unmeasured confounding. | **Conditional Exchangeability** | -->
<!-- | **5** | **Ensure Causal Consistency** | Are treatment versions independent of potential outcomes conditional on covariates? | Do different ways of receiving "treatment" yield the same potential outcomes? | **Consistency** | -->
<!-- | **6** | **Check Positivity** | Is there non-zero probability of each treatment level at every covariate combination? | Examine overlap in treatment assignment across the full covariate space. | **Positivity** | -->
<!-- | **7** | **Evaluate Measurement Validity** | Do measures relate to scientific questions? What are sources of measurement error bias? | Consider structural features of measurement error and their impact on causal inference. | **Measurement Validity** | -->
<!-- | **8** | **Address Attrition and Selection** | Does the final study group represent the target population throughout the study period? | Develop strategies for attrition, non-response, and measurement error bias. | **Representativeness** | -->
<!-- | **9** | **Document Transparently** | Have all reasoning, evidence, and decisions for steps 1-8 been clearly communicated? | Provide thorough documentation including causal assumptions and disagreements. | **Transparency** | -->
<!-- ## STEP 1: Ask Your Causal Question -->
<!-- -   **State your question:** is my question clearly stated? If not, state it. -->
<!-- -   **Relevance:** have I explained its importance? If not, explain. -->
<!-- -   **Ethics** how might this question affect people? How might not investigating this question affect people?  -->
<!-- -   **Causality:** Is my question causal? If not, refine your question. -->
<!-- -   **Heterogeneous Treatment Effects**:  Do I want to examine who responds differently (CATE)? -->
<!-- -   **Subgroup analysis:** does my question involve a subgroup (e.g., cultural group)? If not, develop a subgroup analysis question. -->
<!-- -   **Explain the Framework:** can I explain the causal inference framework and convey the gist to non-specialists? -->
<!-- #### Determine Data Requirements -->
<!-- -   **Data types:** is treatment assignment in my data randomised?  -->
<!-- -   **Time-series data:** are my data time-series? If not, reconsider your causal question. -->
<!-- -   **Data waves:** do I have at least three waves of data? If not, beware of confounding control issues. -->
<!-- -   **Data source:** what are the biases in collection/reporting -->
<!-- #### Determine the Outcome -->
<!-- -   **Outcome variable:** is the outcome variable *Y* defined? If not, define it. -->
<!-- -   **Multiple outcomes:** are there multiple outcomes? If yes, explain and define them. -->
<!-- -   **Outcome relevance:** can I explain how the outcome variable/s relate to my question? If not, clarify. -->
<!-- -   **Outcome type:** is my outcome binary and rare? If yes, consider logistic regression. If my outcome is continuous, consider z-transforming it or categorising it (consult an expert). -->
<!-- -   **Outcome timing:** does the outcome appear after the exposure? It should. -->
<!-- #### Determine the Exposure -->
<!-- -   **Exposure variable:** is the exposure variable *A* defined? If not, define it. -->
<!-- -   **Multiple exposures:** are there multiple exposures? If yes, reassess; if only one exposure, proceed. -->
<!-- -   **Exposure relevance:** can I explain how the exposure variable relates to my question? If not, clarify. -->
<!-- -   **Positivity:** can we intervene on the exposure at all levels of the covariates? We should be able to. -->
<!-- -   **Consistency:** can I interpret what it means to intervene on the exposure?  -->
<!-- -   **Exchangeability:** are different versions of the exposure conditionally exchangeable given measured baseline confounders? They should be. -->
<!-- -   **Exposure type:** is the exposure binary or continuous? -->
<!-- -   **Shift intervention**: Am I contrasting static interventions or modified treatment policies?   -->
<!-- -   **Exposure timing:** Does the exposure appear before the outcome? It should. -->
<!-- #### Account for Confounders -->
<!-- -   **Baseline confounders:** Have I defined my baseline confounders *L*? I should have. -->
<!-- -   **Justification:** Can I explain how the baseline confounders could affect both *A* and *Y*? I should be able to. -->
<!-- -   **Timing:** Are the baseline confounders measured before the exposure? They should be. -->
<!-- -   **Inclusion:** Is the baseline measure of the exposure and the baseline outcome included in the set of baseline confounders? They should be. -->
<!-- -   **Sufficiency:** Are the baseline confounders sufficient to ensure balance on the exposure, such that *A* is independent of *Y* given *L*? If not, plan a sensitivity analysis. -->
<!-- -   **Confounder type:** Are the confounders continuous or binary? If so, consider converting them to z-scores. If they are categorical with three or more levels, do not convert them to z-scores. -->
<!-- #### Draw a Causal Diagram with Unmeasured Confounders -->
<!-- -   **Unmeasured confounders:** Does previous science suggest the presence of unmeasured confounders? If not, expand your understanding. -->
<!-- -   **Causal diagram:** Have I drawn a causal diagram (DAG) to highlight both measured and unmeasured sources of confounding?  -->
<!-- -   **Measurement error:** Have I described potential biases from measurement errors? If not, we'll discuss later. -->
<!-- -   **Temporal order:** Does my DAG have time indicators to ensure correct temporal order? It should. -->
<!-- -   **Time consistency:** Is my DAG organized so that time follows in a consistent direction? It should. -->
<!-- #### Identify the Estimand -->
<!-- - ATE or CATE or both? -->
<!-- #### Understanding Source and Target Populations -->
<!-- -   **Populations identified:** Have I explained how my sample relates to my target populations? I should have. -->
<!-- -   **Generalisability and transportability:** Have I considered whether my results generalise different populations?  I should have. -->
<!-- #### Set Eligibility Criteria -->
<!-- -   **Criteria stated:** Have I stated the eligibility criteria for the study? I should have. -->
<!-- #### Describe Sample Characteristics -->
<!-- -   **Descriptive statistics:** have I provided descriptive statistics for demographic information taken at baseline? I should have. -->
<!-- -   **Exposure change:** Have I demonstrated the magnitudes of change in the exposure from baseline to the exposure interval? I should have. -->
<!-- -   **References:** Have I included references for more information about the sample? I should have. -->
<!-- #### Addressing Missing Data -->
<!-- -   **Missing data checks:** Have I checked for missing data? I should have. -->
<!-- -   **Missing data plan:** If there is missing data, have I described how I will address it? I should have. -->
<!-- #### Selecting the Model Approach: If Not Using Machine Learning  -->
<!-- -   **Approach decision:** Have I decided on using G-computation, IPTW, or Doubly-Robust Estimation? I should have. -->
<!-- -   **Interactions:** If not using machine learning, have I included the interaction of the exposure and baseline covariates? I should have. -->
<!-- -   **Big data:** If I have a large data set, should I include the interaction of the exposure, group, and baseline confounders? I should consider it. -->
<!-- -   **Model specification:** have I double-checked the model specification? I should. -->
<!-- -   **Outcome assessment:** If the outcome is rare and binary, have I specified logistic regression? If it's continuous, have I considered converting it to z-scores? -->
<!--   -   **Sensitivity analysis:** am I planning a sensitivity analysis using simulation? If yes, describe it (e.g. E-values.) -->
<!-- #### Machine Learing -->
<!-- Have I explained how causal forests work  -- also the workshop R package -->
<!-- ### Clarify unmeasured pre-treatment covariates -->
<!-- Let **U** denoted unmeasured pre-treatment covariates that may potentially bias the statistical association between *A* and *Y* independently of the measured covariates. -->
<!-- #### Consider: -->
<!-- -   To affect *Y* and *A*, *U* must occur before *A*. -->
<!-- -   It is useful to draw a causal diagramme to illustrate all potential sources of bias. -->
<!-- -   Causal diagrammes are qualitative tools that require specialist expertise. We cannot typically obtain a causal graph from the data. -->
<!-- -   A causal diagramme should include only as much information as is required to assess confounding. See @fig-dag-outcomewide for an example. -->
<!-- -   Because we cannot ensure the absence of unmeasured confounders in observational settings, it is vital to conduct sensitivity analyses for the results. For sensitivity analyeses, we use E-values. -->
<!-- ### Choose the scale for a causal contrast -->
<!-- Difference/ Risk ratio?  -->
<!-- #### Consider: -->
<!-- -   In the causal inference literature, the concept we use to make sense of stratum specific comparisons is called "effect modification." -->
<!-- -   By inferring effects within strata, we may evaluate whether the effects of different exposures or treatments on some well-defined outcome (measured in some well-defined time-period after the exposure) differ depending on group measurement. -->
<!-- -   The logic of effect modification differs slightly from that of interaction. -->
<!-- #### Aside: extensions -->
<!-- For continuous exposures, we must stipulate the level of contrast for the exposure (e.g. weekly versus monthly church attendance): -->
<!--   $$ATE_{a,a'} = E[Y(a) - Y(a')]$$ -->
<!-- This essentially denotes an average treatment effect comparing the outcome under treatment level $A$ to the outcome under treatment level $A'$. Likewise: -->
<!--   $$ATE_{a/a'} = \frac{E[Y(a)]}{E[Y(a')]}$$ -->
<!-- This defines the contrast of $A$ and $A'$ on a ratio scale. -->
<!-- #### Describe the population(s) for whom the intended study is meant to generalise by distinguishing between source and target populations. -->
<!-- Consider the following concepts: -->
<!-- -   **Source population**: a source population is where we gather our data for a study. We pull our specific sample from this group. It needs to mirror the broader group for our conclusions to be valid and widely applicable.  -->
<!-- -   **Target population**: the target population is the larger group we aim to apply our study's results to. It could be defined by location, demographics, or specific conditions. The closer the source matches the target in ways that are relevant to our causal questions, the stronger our causal inferences about the target population will be. -->
<!--  -   **Generalisability** refers to the ability to apply the causal effects estimated from a sample to the population it was drawn from. In simpler terms, it deals with the extrapolation of causal knowledge from a sample to the broader population. This concept is also called "external validity". -->
<!--   $$\text{Generalisability} = PATE \approx ATE_{\text{sample}}$$ -->
<!-- -   **Transportability** refers to the ability to extrapolate causal effects learned from a source population to a target population when certain conditions are met. It deals with the transfer of causal knowledge across different settings or populations. -->
<!--   $$\text{Transportability} = ATE_{\text{target}} \approx f(ATE_{\text{source}}, T)$$ -->
<!-- where $f$ is a function and $T$ is a function that maps the results from our source population to another population. To achieve transportability, we need information about the source and target populations and an understanding of how the relationships between treatment, outcome, and covariates differ between the populations. Assessing transportability requires scientific knowledge. -->
<!-- ### Summary Step 1: Consider how much we need to do when asking a causal question! -->
<!-- We discover that asking a causal question is a multifaceted task. It demands careful definition of the outcome, including its timing, the exposure, and covariates. It also requires selecting the appropriate scale for causal contrast, controlling for confounding, and potentially adjusting for sample weights or stratification. Finally, when asking a causal question, we must consider for whom the results apply. Only after following these steps can we then ask: "How may we answer this causal question?" -->
<!-- ## STEP 2: Answer Your Question -->
<!-- #### Obtain longitudinal data -->
<!-- Note that causal inference from observational data turns on the appropriate temporal ordering of the key variables involved in the study. -->
<!-- Recall we have defined. -->
<!-- -   **A**: Our exposure or treatment variable, denoted as **A**. Here we consider the example of 'Church attendance'. -->
<!-- -   **Y**: The outcome variable we are interested in, represented by **Y**, is psychological distress. We operationalise this variable through the 'Kessler-6' distress scale. -->
<!-- -   **L**: The confounding variables, collectively referred to as **L**, represent factors that can independently influence both **A** and **Y**. For example, socio-economic status could be a confounder that impacts both the likelihood of church attendance and the levels of psychological distress. -->
<!-- Given the importance of temporal ordering, we must now define time: -->
<!-- -   **t** $\in$ T: Let $t$ denote within a multiwave panel study with **T** measurement intervals. -->
<!--  Where $t/\text{{exposure}}$ denotes the measurement interval for the exposure. Longitudinal data collection provides us the ability to establish a causal model such that: -->
<!-- $$t_{confounders} < t_{exposure}< t_{outcome}$$ -->
<!-- To minimise the posibility of time-varying confounding and obtain the clearest effect estimates, we should acquire the most recent values of $\mathbf{L}$ preceding $A$ and the latest values of $A$ before $Y$. -->
<!-- Note in @fig-dag-outcomewide, We use the prefixes "t0, t1, and t2" to denote temporal ordering. We include in the set of baseline confounders the pre-exposure measurement of *A* and *Y*. This allows for more substantial confounding control. For unmeasured confounder to affect both the exposure and the outcome, it would need to do so independently of the pre-exposure confounders. Additionally, including the baseline exposure gives us an effect estimate for the incidence exposure, rather than the prevelance of the exposure. This helps us to assess the expected change in the outcome were we to initate a change in the exposure. -->
<!-- ### Include the measured exposure with baseline covariates -->
<!-- Controlling for prior exposure enables the interpretation of the effect estimate as a change in the exposure in a manner akin to a randomised trial. We propose that the effect estimate with prior control for the exposure estimates the "incidence exposure" rather than the "prevalence exposure" [@danaei2012]. It is crucial to estimate the incidence exposure because if the effects of an exposure are harmful in the short term such that these effects are not subsequently measured, a failure to adjust for prior exposure will yield the illusion that the exposure is beneficial. Furthermore, this approach aids in controlling for unmeasured confounding. For such a confounder to explain away the observed exposure-outcome association, it would need to do so independently of the prior level of the exposure and outcome. -->
<!-- ### State the eligibility criteria for participation -->
<!-- This step is invaluable for assessing whether we are answering the causal question that we have asked. -->
<!-- #### Consider: -->
<!-- -   Generalisability: we cannot evaluate inferences to a target group from the source population if we do not describe the source population -->
<!-- -   Eligibility criteria will help us to ensure whether we have correctly evaluated potential measurement bias/error in our instruments. For example, the New Zealand Attitudes and Values Study is a National Probability study of New Zealanders. Individuals were randomly selected from the country's electoral roll. From these invitations there was typically less than 15% response rate. How might this process of recruitment affect generalisability and transportability of our results? -->
<!-- - Aside: discuss per protocol effects/ intention to treat effects -->
<!-- ### Determine how missing data will be handled -->
<!-- -  As we consider in this workshop, loss to follow up and non-response opens sources for bias. We must develop a strategy for handling missing data. -->
<!-- ### State a statistical model -->
<!-- The models you considered on Day 1 of this workshop are G-computation, Inverse Probability of Treatement Weighting, and Doubly-Robust estimation. -->
<!-- ### Reporting -->
<!-- Consider the following ideas about how to report your model: -->
<!-- -   **Estimator**: Doubly robust where possible. -->
<!-- -   **Propensity Score Reporting:** Detail the process of propensity score derivation, including the model used and any variable transformations. -->
<!-- -   **WeightIt Package:** Explicitly mention the use of the 'WeightIt' package in R, including any specific options or parameters used in the propensity score estimation process. -->
<!-- -   **Method Variations:** Report if different methods were used to obtain propensity scores, and the reasons behind the choice of methods such as 'ebal', 'energy', and 'ps'. -->
<!-- -   **Continuous Exposures:** Highlight that for continuous exposures, only the 'energy' option was used for propensity score estimation. -->
<!-- -  **Binary Exposure** Justify your cutpoints by referencing theory/existing knowledge *in advance* of conducting the analysis. -->
<!-- -   **Subgroup Estimation:** Confirm that the propensity scores for subgroups were estimated separately, and discuss how the weights were subsequently combined with the original data. -->
<!-- -   **Covariate Balance:** Include a Love plot to visually represent covariate balance on the exposure both before and after weighting. -->
<!-- -   **Weighting Algorithm Statistics:** Report the statistics for the weighting algorithms as provided by the WeightIt package, including any measures of balance or fit. -->
<!-- -   **Outcome Regression Model:** Clearly report the type of regression model used to estimate outcome model coefficients (e.g., linear regression, Poisson, binomial), and mention if the exposure was interacted with the baseline covariates. Do not report model coefficients as these have no interpretation. -->
<!-- -   **Subgroup Interaction:** Address whether the subgroup was included separately as an interaction in the outcome model, and if the model successfully converged. -->
<!-- -   **Machine Learning Using `lmtp`** If using the `lmtp` package, do a stratified analysis. (see today's lab) -->
<!-- -   **Model coefficients:** note that the model coefficients should not be interpreted, as they are not meaningful in this context. -->
<!-- -   **Confidence intervals and standard errors:** Describe the methods used to derive confidence intervals and standard errors, noting the use of the 'clarify' package in R for simulation based inference. -->
<!-- ### Example of how to report a doubly robust method in your report -->
<!-- The Doubly Robust Estimation method for Subgroup Analysis Estimator is a sophisticated tool combining features of both IPTW and G-computation methods, providing unbiased estimates if either the propensity score or outcome model is correctly specified. The process involves five main steps: -->
<!-- **Step 1** involves the estimation of the propensity score, a measure of the conditional probability of exposure given the covariates and the subgroup indicator. This score is calculated using statistical models such as logistic regression, with the model choice depending on the nature of the data and exposure. Weights for each individual are then calculated using this propensity score. These weights depend on the exposure status and are computed differently for exposed and unexposed individuals. The estimation of propensity scores is performed separately within each subgroup stratum. -->
<!-- **Step 2** focuses on fitting a weighted outcome model, making use of the previously calculated weights from the propensity scores. This model estimates the outcome conditional on exposure, covariates, and subgroup, integrating the weights into the estimation process. Unlike in propensity score model estimation, covariates are included as variables in the outcome model. This inclusion makes the method doubly robust - providing a consistent effect estimate if either the propensity score or the outcome model is correctly specified, thereby reducing the assumption of correct model specification. -->
<!-- **Step 3** entails the simulation of potential outcomes for each individual in each subgroup. These hypothetical scenarios assume universal exposure to the intervention within each subgroup, regardless of actual exposure levels. The expectation of potential outcomes is calculated for each individual in each subgroup, using individual-specific weights. These scenarios are performed for both the current and alternative interventions. -->
<!-- **Step 4** is the estimation of the average causal effect for each subgroup, achieved by comparing the computed expected values of potential outcomes under each intervention level. The difference represents the average causal effect of changing the exposure within each subgroup.  -->
<!-- **Step 5** involves comparing differences in causal effects across groups by calculating the differences in the estimated causal effects between different subgroups. Confidence intervals and standard errors for these calculations are determined using simulation-based inference methods [@greifer2023]. This step allows for a comprehensive comparison of the impact of different interventions across various subgroups, while encorporating uncertainty. -->
<!-- ### Inference -->
<!-- Consider the following ideas about what to discuss in one's findings: -->
<!--                                                                                                                           Consider the following ideas about what to discuss in one's findings. The order of exposition might be different. -->
<!-- 1.  **Summary of results**:  What did you find? -->
<!-- 2. **Interpretation of E-values:** Interpret the E-values used for sensitivity analysis. State what they represent in terms of the robustness of the findings to potential unmeasured confounding. -->
<!-- 3.  **Causal Effect Interpretation:** What is the interest of the effect, if any, if an effect was observed? Interpret the average causal effect of changing the exposure level within each subgroup, and discuss its relevance to the research question.  -->
<!-- 4.  **Comparison of Subgroups:** Discuss how differences in causal effect estimates between different subgroups, if observed, or if not observed, contribute to the overall findings of the study. -->
<!-- 5.  **Uncertainty and Confidence Intervals:** Consider the uncertainty around the estimated causal effects, and interpret the confidence intervals to understand the precision of the estimates. -->
<!-- 6.  **Generalisability and Transportability:** Reflect on the generalizability of the study results to other contexts or populations. Discuss any factors that might influence the transportability of the causal effects found in the study. (Again see lecture 9.) -->
<!-- 7.  **Assumptions and Limitations:** Reflect on the assumptions made during the study and identify any limitations in the methodology that could affect the interpretation of results. State that the implications of different intervention levels on potential outcomes are not analysed.  -->
<!-- 8.  **Theoretical Relevance**: How are these findings relevant to existing theories.  -->
<!-- 9.  **Replication and Future Research:** Consider how the study could be replicated or expanded upon in future research, and how the findings contribute to the existing body of knowledge in the field. -->
<!-- 10. **Real-world Implications:** Discuss the real-world implications of the findings, and how they could be applied in policy, practice, or further research. -->
<!-- ## Appendix A: Details of Estimation Approaches -->
<!-- ### G-computation for Subgroup Analysis Estimator -->
<!-- **Step 1:** Estimate the outcome model. Fit a model for the outcome $Y$, conditional on the exposure $A$, the covariates $L$, and subgroup indicator $G$. This model can be a linear regression, logistic regression, or another statistical model. The goal is to capture the relationship between the outcome, exposure, confounders, and subgroups. -->
<!-- $$ \hat{E}(Y|A,L,G) = f_Y(A,L,G; \theta_Y) $$ -->
<!-- This equation represents the expected value of the outcome $Y$ given the exposure $A$, covariates $L$, and subgroup $G$, as modelled by the function $f_Y$ with parameters $\theta_Y$. This formulation allows for the prediction of the average outcome $Y$ given certain values of $A$, $L$, and $G$. -->
<!-- **Step 2:** Simulate potential outcomes. For each individual in each subgroup, predict their potential outcome under the intervention $A=a$ using the estimated outcome model: -->
<!-- $$\hat{E}[Y(a)|G=g] = \frac{1}{N_g} \sum_{i:G_i=g} \hat{E}[Y|A=a, L=L_i, G=g; \hat{\theta}_Y]$$ -->
<!-- We also predict the potential outcome for everyone in each subgroup under the causal contrast, setting the intervention for everyone in that group to $A=a'$: -->
<!--                                                                                                                        $$\hat{E}[Y(a')|G=g] = \frac{1}{N_g} \sum_{i:G_i=g} \hat{E}[Y|A=a', L=L_i, G=g; \hat{\theta}_Y]$$ -->
<!--   In these equations, $Y$ represents the potential outcome, $A$ is the intervention, $L$ are the covariates, $G=g$ represents the subgroup, and $\theta_Y$ are the parameters of the outcome model. -->
<!--   **Step 3:** Calculate the estimated difference for each subgroup $g$: -->
<!--     $$\hat{\delta}_g = \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g]$$ -->
<!-- This difference $\hat{\delta}_g$ represents the average causal effect of changing the exposure from level $a'$ to level $a$ within each subgroup $g$. -->
<!-- We use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. -->
<!-- **Step 4:** Compare differences in causal effects by subgroups: -->
<!--  $$\hat{\gamma} = \hat{\delta}_g - \hat{\delta}_{g'}$$ -->
<!-- where, -->
<!-- $$\hat{\gamma} = \overbrace{\big( \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g] \big)}^{\hat{\delta}_g} - \overbrace{\big( \hat{E}[Y(a)|G=g'] - \hat{E}[Y(a')|G=g'] \big)}^{\hat{\delta}_{g'}}$$ -->
<!-- This difference $\hat{\gamma}$ represents the difference in the average causal effects between the subgroups $g$ and $g'$. It measures the difference in effect of the exposure $A$ within subgroup $G$ on the outcome $Y$.[^note_care]  -->
<!-- [^note_care]: $A$ and $G$ on $Y$ might not be additive. We assume that the potential confounders $L$ are sufficient to control for confounding. See Appendix -->
<!-- We again use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. -->
<!-- ### Inverse Probability of Treatment Weighting (IPTW) for Subgroup Analysis Estimator -->
<!-- **Step 1:** Estimate the propensity score. The propensity score $e(L, G)$ is the conditional probability of the exposure $A = 1$, given the covariates $L$ and subgroup indicator $G$. This can be modeled using logistic regression or other suitable methods, depending on the nature of the data and the exposure. -->
<!-- $$\hat{e} = P(A = 1 | L, G) = f_A(L, G; \theta_A)$$ -->
<!-- Here, $f_A(L, G; \theta_A)$ is a function (statistical model) that estimates the probability of the exposure $A = 1$ given covariates $L$ and subgroup $G$. Then, we calculate the weights for each individual, denoted as $v$, using the estimated propensity score: -->
<!-- $$ -->
<!-- v = -->
<!-- \begin{cases} -->
<!-- \frac{1}{\hat{e}} & \text{if } A = 1 \\ -->
<!-- \frac{1}{1-\hat{e}} & \text{if } A = 0 -->
<!-- \end{cases} -->
<!-- $$ -->
<!-- **Step 2:** Fit a weighted outcome model. Using the weights calculated from the estimated propensity scores, fit a model for the outcome $Y$, conditional on the exposure $A$ and subgroup $G$. This can be represented as: -->
<!-- $$ \hat{E}(Y|A, G; V) = f_Y(A, G ; \theta_Y, V) $$ -->
<!-- In this model, $f_Y$ is a function (such as a weighted regression model) with parameters $θ_Y$. -->
<!-- **Step 3:** Simulate potential outcomes. For each individual in each subgroup, simulate their potential outcome under the hypothetical scenario where everyone in the subgroup is exposed to the intervention $A=a$ regardless of their actual exposure level: -->
<!-- $$\hat{E}(Y(a)|G=g) = \hat{E}[Y|A=a,G=g; \hat{\theta}_Y, v]$$ -->
<!-- And also under the hypothetical scenario where everyone is exposed to intervention $A=a'$: -->
<!-- $$\hat{E}(Y(a')|G=g) = \hat{E}[Y|A=a',G=g; \hat{\theta}_Y, v]$$ -->
<!-- **Step 4:** Estimate the average causal effect for each subgroup as the difference in the predicted outcomes: -->
<!-- $$\hat{\delta}_g = \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g]$$ -->
<!-- The estimated difference $\hat{\delta}_g$ represents the average causal effect within group $g$. -->
<!-- **Step 5:** Compare differences in causal effects by groups. Compute the differences in the estimated causal effects between different subgroups: -->
<!--     $$\hat{\gamma} = \hat{\delta}_g - \hat{\delta}_{g'}$$ -->
<!-- where, -->
<!-- $$\hat{\gamma} = \overbrace{\big( \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g] \big)}^{\hat{\delta}_g} - \overbrace{\big( \hat{E}[Y(a)|G=g'] - \hat{E}[Y(a')|G=g'] \big)}^{\hat{\delta}_{g'}}$$ -->
<!-- This $\hat{\gamma}$ represents the difference in the average causal effects between the subgroups $g$ and $g'$. -->
<!-- We again use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. -->
<!-- ### Doubly Robust Estimation for Subgroup Analysis Estimator -->
<!-- It appears that the Doubly Robust Estimation explanation for subgroup analysis is already clear and correct, covering all the necessary steps in the process. Nevertheless, there's a slight confusion in step 4. The difference $\delta_g$ is not defined within the document. I assume that you intended to write $\hat{\delta}_g$. Here's the corrected version: -->
<!-- ### Doubly Robust Estimation for Subgroup Analysis Estimator -->
<!-- Doubly Robust Estimation is a powerful technique that combines the strengths of both the IPTW and G-computation methods. It uses both the propensity score model and the outcome model, which makes it doubly robust: it produces unbiased estimates if either one of the models is correctly specified. -->
<!-- **Step 1** Estimate the propensity score. The propensity score $\hat{e}(L, G)$ is the conditional probability of the exposure $A = 1$, given the covariates $L$ and subgroup indicator $G$. This can be modeled using logistic regression or other suitable methods, depending on the nature of the data and the exposure. -->
<!-- $$\hat{e} = P(A = 1 | L, G) = f_A(L, G; \theta_A)$$ -->
<!-- Here, $f_A(L, G; \theta_A)$ is a function (statistical model) that estimates the probability of the exposure $A = 1$ given covariates $L$ and subgroup $G$. Then, we calculate the weights for each individual, denoted as $v$, using the estimated propensity score: -->
<!-- $$ -->
<!-- v =  -->
<!-- \begin{cases}  -->
<!-- \frac{1}{\hat{e}} & \text{if } A = 1 \\ -->
<!-- \frac{1}{1-\hat{e}} & \text{if } A = 0  -->
<!-- \end{cases} -->
<!-- $$ -->
<!-- **Step 2** Fit a weighted outcome model. Using the weights calculated from the estimated propensity scores, fit a model for the outcome $Y$, conditional on the exposure $A$, covariates $L$, and subgroup $G$. -->
<!-- $$ \hat{E}(Y|A, L, G; V) = f_Y(A, L, G ; \theta_Y, V) $$ -->
<!-- **Step 3** For each individual in each subgroup, simulate their potential outcome under the hypothetical scenario where everyone in the subgroup is exposed to the intervention $A=a$ regardless of their actual exposure level: -->
<!-- $$\hat{E}(Y(a)|G=g) = \hat{E}[Y|A=a,G=g; L,\hat{\theta}_Y, v]$$ -->
<!-- And also under the hypothetical scenario where everyone in each subgroup is exposed to intervention $A=a'$: -->
<!--   $$\hat{E}(Y(a')|G=g) = \hat{E}[Y|A=a',G=g; L; \hat{\theta}_Y, v]$$ -->
<!-- **Step 4** Estimate the average causal effect for each subgroup. Compute the estimated expected value of the potential outcomes under each intervention level for each subgroup: -->
<!--     $$\hat{\delta}_g = \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g]$$ -->
<!-- The estimated difference $\hat{\delta}_g$ represents the average causal effect of changing the exposure from level $a'$ to level $a$ within each subgroup. -->
<!-- **Step 5** Compare differences in causal effects by groups. Compute the differences in the estimated causal effects between different subgroups: -->
<!-- $$\hat{\gamma} = \hat{\delta}_g - \hat{\delta}_{g'}$$ -->
<!-- where, -->
<!-- $$\hat{\gamma} = \overbrace{\big( \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g] \big)}^{\hat{\delta}_g} - \overbrace{\big( \hat{E}[Y(a)|G=g'] - \hat{E}[Y(a')|G=g'] \big)}^{\hat{\delta}_{g'}}$$ -->
<!-- We again use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. -->
<!-- ## Appendix B: G-computation for Subgroup Analysis Estimator with Non-Additive Effects -->
<!-- **Step 1:** Estimate the outcome model. Fit a model for the outcome $Y$, conditional on the exposure $A$, the covariates $L$, subgroup indicator $G$, and interactions between $A$ and $G$. This model can be a linear regression, logistic regression, or another statistical model. The goal is to capture the relationship between the outcome, exposure, confounders, subgroups, and their interactions. -->
<!-- $$ \hat{E}(Y|A,L,G,AG) = f_Y(A,L,G,AG; \theta_Y) $$ -->
<!--   This equation represents the expected value of the outcome $Y$ given the exposure $A$, covariates $L$, subgroup $G$, and interaction term $AG$, as modeled by the function $f_Y$ with parameters $\theta_Y$.  -->
<!-- **Step 2:** Simulate potential outcomes. For each individual in each subgroup, predict their potential outcome under the intervention $A=a$ using the estimated outcome model: -->
<!--   $$\hat{E}(Y(a)|G=g) = \hat{E}[Y|A=a,L,G=g,AG=ag; \hat{\theta}_Y]$$ -->
<!-- We also predict the potential outcome for everyone in each subgroup under the causal contrast, setting the intervention for everyone in that group to $A=a'$: -->
<!-- $$\hat{E}(Y(a')|G=g) = \hat{E}[Y|A=a',L,G=g,AG=a'g; \hat{\theta}_Y]$$ -->
<!-- **Step 3:** Calculate the estimated difference for each subgroup $g$: -->
<!--   $$\hat{\delta}_g = \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g]$$ -->
<!-- **Step 4:** Compare differences in causal effects by subgroups: -->
<!-- $$\hat{\gamma} = \hat{\delta}_g - \hat{\delta}_{g'}$$ -->
<!--   where, -->
<!-- $$\hat{\gamma} = \overbrace{\big( \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g] \big)}^{\hat{\delta}_g} - \overbrace{\big( \hat{E}[Y(a)|G=g'] - \hat{E}[Y(a')|G=g'] \big)}^{\hat{\delta}_{g'}}$$ -->
<!-- This difference $\hat{\gamma}$ represents the difference in the average causal effects between the subgroups $g$ and $g'$, taking into account the interaction effect of the exposure $A$ and the subgroup $G$ on the outcome $Y$. -->
<!-- Note that the interaction term $AG$ (or $ag$ and $a'g$ in the potential outcomes) stands for the interaction between the exposure level and the subgroup. This term is necessary to accommodate the non-additive effects in the model. As before, we must ensure that potential confounders $L$ are sufficient to control for confounding.  -->
<!-- ## Appendix C: Doubly Robust Estimation for Subgroup Analysis Estimator with Interaction -->
<!-- Again, Doubly Robust Estimation combines the strengths of both the IPTW and G-computation methods. It uses both the propensity score model and the outcome model, which makes it doubly robust: it produces unbiased estimates if either one of the models is correctly specified. -->
<!-- **Step 1** Estimate the propensity score. The propensity score $e(L, G)$ is the conditional probability of the exposure $A = 1$, given the covariates $L$ and subgroup indicator $G$. This can be modeled using logistic regression or other suitable methods, depending on the nature of the data and the exposure. -->
<!-- $$e = P(A = 1 | L, G) = f_A(L, G; \theta_A)$$ -->
<!--   Here, $f_A(L, G; \theta_A)$ is a function (statistical model) that estimates the probability of the exposure $A = 1$ given covariates $L$ and subgroup $G$. Then, we calculate the weights for each individual, denoted as $v$, using the estimated propensity score: -->
<!-- $$ -->
<!--   v =  -->
<!--   \begin{cases}  -->
<!-- \frac{1}{\hat{e}} & \text{if } A = 1 \\ -->
<!-- \frac{1}{1-\hat{e}} & \text{if } A = 0  -->
<!-- \end{cases} -->
<!-- $$ -->
<!--   **Step 2** Fit a weighted outcome model. Using the weights calculated from the estimated propensity scores, fit a model for the outcome $Y$, conditional on the exposure $A$, covariates $L$, subgroup $G$ and the interaction between $A$ and $G$. -->
<!-- $$ \hat{E}(Y|A, L, G, AG; V) = f_Y(A, L, G, AG ; \theta_Y, V) $$ -->
<!--   **Step 3** For each individual in each subgroup, simulate their potential outcome under the hypothetical scenario where everyone in the subgroup is exposed to the intervention $A=a$ regardless of their actual exposure level: -->
<!--   $$\hat{E}(Y(a)|G=g) = \hat{E}[Y|A=a,G=g, AG=ag; L,\hat{\theta}_Y, v]$$ -->
<!-- And also under the hypothetical scenario where everyone in each subgroup is exposed to intervention $A=a'$: -->
<!-- $$\hat{E}(Y(a')|G=g) = \hat{E}[Y|A=a',G=g, AG=a'g; L; \hat{\theta}_Y, v]$$ -->
<!-- **Step 4** Estimate the average causal effect for each subgroup. Compute the estimated expected value of the potential outcomes under each intervention level for each subgroup: -->
<!--   $$\hat{\delta}_g = \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g]$$ -->
<!-- The estimated difference $\hat{\delta}_g$ represents the average causal effect of changing the exposure from level $a'$ to level $a$ within each subgroup. -->
<!-- **Step 5** Compare differences in causal effects by groups. Compute the differences in the estimated causal effects between different subgroups: -->
<!-- $$\hat{\gamma} = \hat{\delta}_g - \hat{\delta}_{g'}$$ -->
<!-- where, -->
<!-- $$\hat{\gamma} = \overbrace{\big( \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g] \big)}^{\hat{\delta}_g} - \overbrace{\big( \hat{E}[Y(a)|G=g'] - \hat{E}[Y(a')|G=g'] \big)}^{\hat{\delta}_{g'}}$$ -->
<!-- We again use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. -->
<!-- ## Appendix D: Marginal Structural Models for Estimating Population Average Treatment Effect with Interaction (Doubly Robust) -->
<!-- Sometimes we will only wish to estimate a marginal effect. In that case. -->
<!-- **Step 1** Estimate the propensity score. The propensity score $e(L)$ is the conditional probability of the exposure $A = 1$, given the covariates $L$ which contains the subgroup $G$. This can be modelled using logistic regression or other functions as described in @greifer2023 -->
<!-- $$\hat{e} = P(A = 1 | L) = f_A(L; \theta_A)$$ -->
<!-- Here, $f_A(L; \theta_A)$ is a function (a statistical model) that estimates the probability of the exposure $A = 1$ given covariates $L$. Then, we calculate the weights for each individual, denoted as $v$, using the estimated propensity score: -->
<!-- $$ -->
<!--   v =  -->
<!--   \begin{cases}  -->
<!-- \frac{1}{e} & \text{if } A = 1 \\ -->
<!-- \frac{1}{1-e} & \text{if } A = 0  -->
<!-- \end{cases} -->
<!-- $$ -->
<!-- **Step 2** Fit a weighted outcome model. Using the weights calculated from the estimated propensity scores, fit a model for the outcome $Y$, conditional on the exposure $A$ and covariates $L$. -->
<!-- $$ \hat{E}(Y|A, L; V) = f_Y(A, L; \theta_Y, V) $$ -->
<!-- This model should include terms for both the main effects of $A$ and $L$ and their interaction $AL$. -->
<!-- **Step 3** For the entire population, simulate the potential outcome under the hypothetical scenario where everyone is exposed to the intervention $A=a$ regardless of their actual exposure level: -->
<!--   $$\hat{E}(Y(a)) = \hat{E}[Y|A=a; L,\hat{\theta}_Y, v]$$ -->
<!-- And also under the hypothetical scenario where everyone is exposed to intervention $A=a'$: -->
<!-- $$\hat{E}(Y(a')) = \hat{E}[Y|A=a'; L; \hat{\theta}_Y, v]$$ -->
<!-- **Step 4** Estimate the average causal effect for the entire population. Compute the estimated expected value of the potential outcomes under each intervention level for the entire population: -->
<!-- $$\hat{\delta} = \hat{E}[Y(a)] - \hat{E}[Y(a')]$$ -->
<!-- The estimated difference $\hat{\delta}$ represents the average causal effect of changing the exposure from level $a'$ to level $a$ in the entire population. -->
<!-- We again use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. -->
<!-- ### Machine Learning -->
<!-- Example from https://osf.io/cnphs -->
<!-- > We perform statistical estimation using semi-parametric Targeted -->
<!-- Learning, specifically a Targeted Minimum Loss-based Estimation (TMLE) -->
<!-- estimator. TMLE is a robust method that combines machine learning -->
<!-- techniques with traditional statistical models to estimate causal -->
<!-- effects while providing valid statistical uncertainty measures for these -->
<!-- estimates [@van2012targeted; @van2014targeted]. -->
<!-- > TMLE operates through a two-step process that involves modelling both -->
<!-- the outcome and treatment (exposure). Initially, TMLE employs machine -->
<!-- learning algorithms to flexibly model the relationship between -->
<!-- treatments, covariates, and outcomes. This flexibility allows TMLE to -->
<!-- account for complex, high-dimensional covariate spaces -->
<!-- \emph{efficiently} without imposing restrictive model assumptions; -->
<!-- [@vanderlaan2011; @vanderlaan2018]. The outcome of this step is a set -->
<!-- of initial estimates for these relationships. -->
<!-- > The second step of TMLE involves ``targeting'' these initial estimates -->
<!-- by incorporating information about the observed data distribution to -->
<!-- improve the accuracy of the causal effect estimate. TMLE achieves this -->
<!-- precision through an iterative updating process, which adjusts the -->
<!-- initial estimates towards the true causal effect. This updating process -->
<!-- is guided by the efficient influence function, ensuring that the final -->
<!-- TMLE estimate is as close as possible, given the measures and data, to -->
<!-- the targeted causal effect while still being robust to -->
<!-- model-misspecification in either the outcome or the treatment model -->
<!-- [@van2014discussion]. -->
<!-- > Again, a central feature of TMLE is its double-robustness property. If -->
<!-- either the treatment model or the outcome model is correctly specified, -->
<!-- the TMLE estimator will consistently estimate the causal effect. -->
<!-- Additionally, we used cross-validation to avoid over-fitting, following -->
<!-- the pre-stated protocols in Bulbulia [@bulbulia2024PRACTICAL]. The integration of TMLE -->
<!-- and machine learning technologies reduces the dependence on restrictive -->
<!-- modelling assumptions and introduces an additional layer of robustness. -->
<!-- For further details of the specific targeted learning strategy we -->
<!-- favour, see [@hoffman2022, @hoffman2023]. We perform estimation using the -->
<!-- \texttt{lmtp} package [@williams2021]. We used the \texttt{superlearner} library for semi-parametric estimation with the predefined libraries \texttt{SL.ranger}, -->
<!-- \texttt{SL.glmnet}, and \texttt{SL.xgboost} [@xgboost2023; @polley2023; @Ranger2017]. We created graphs, tables and output reports using the \texttt{margot} package -->
<!-- [@margot2024]. -->
<!-- ### Sensitivity Analysis Using the E-value -->
<!-- > To assess the sensitivity of results to unmeasured confounding, we -->
<!-- report VanderWeele and Ding's ``E-value'' in all analyses -->
<!-- [@vanderweele2017]. The E-value quantifies the minimum strength of association (on the risk ratio scale) that an unmeasured confounder would need to have with both the exposure -->
<!-- and the outcome (after considering the measured covariates) to explain -->
<!-- away the observed exposure-outcome association -->
<!-- [@linden2020EVALUE; @vanderweele2020]. To -->
<!-- evaluate the strength of evidence, we use the bound of the E-value 95\% -->
<!-- confidence interval closest to 1. -->
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  - Chang W (2023). _extrafont: Tools for Using Fonts_. doi:10.32614/CRAN.package.extrafont &lt;https://doi.org/10.32614/CRAN.package.extrafont&gt;, R package version 0.19, &lt;https://CRAN.R-project.org/package=extrafont&gt;.
  - R Core Team (2025). _R: A Language and Environment for Statistical Computing_. R Foundation for Statistical Computing, Vienna, Austria. &lt;https://www.R-project.org/&gt;.
  - Xie Y (2025). _tinytex: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents_. R package version 0.57, &lt;https://github.com/rstudio/tinytex&gt;. Xie Y (2019). "TinyTeX: A lightweight, cross-platform, and easy-to-maintain LaTeX distribution based on TeX Live." _TUGboat_, *40*(1), 30-32. &lt;https://tug.org/TUGboat/Contents/contents40-1.html&gt;.</code></pre>
</div>
</div>
<hr>


<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-angrist2009mostly" class="csl-entry" role="listitem">
Angrist, Joshua D, and Jörn-Steffen Pischke. 2009. <em>Mostly Harmless Econometrics: An Empiricist’s Companion</em>. Princeton University Press.
</div>
<div id="ref-bareinboim2013general" class="csl-entry" role="listitem">
Bareinboim, Elias, and Judea Pearl. 2013. <span>“A General Algorithm for Deciding Transportability of Experimental Results.”</span> <em>Journal of Causal Inference</em> 1 (1): 107–34.
</div>
<div id="ref-bulbulia2024wierd" class="csl-entry" role="listitem">
Bulbulia, J. A. 2024. <span>“Methods in Causal Inference Part 3: Measurement Error and External Validity Threats.”</span> <em>Evolutionary Human Sciences</em> 6: e42. <a href="https://doi.org/10.1017/ehs.2024.33">https://doi.org/10.1017/ehs.2024.33</a>.
</div>
<div id="ref-dahabreh2019" class="csl-entry" role="listitem">
Dahabreh, Issa J., and Miguel A. Hernán. 2019. <span>“Extending Inferences from a Randomized Trial to a Target Population.”</span> <em>European Journal of Epidemiology</em> 34 (8): 719–22. <a href="https://doi.org/10.1007/s10654-019-00533-2">https://doi.org/10.1007/s10654-019-00533-2</a>.
</div>
<div id="ref-dahabreh2019generalizing" class="csl-entry" role="listitem">
Dahabreh, Issa J, James M Robins, Sebastien JP Haneuse, and Miguel A Hernán. 2019. <span>“Generalizing Causal Inferences from Randomized Trials: Counterfactual and Graphical Identification.”</span> <em>arXiv Preprint arXiv:1906.10792</em>.
</div>
<div id="ref-deffner2022" class="csl-entry" role="listitem">
Deffner, Dominik, Julia M. Rohrer, and Richard McElreath. 2022. <span>“A Causal Framework for Cross-Cultural Generalizability.”</span> <em>Advances in Methods and Practices in Psychological Science</em> 5 (3): 25152459221106366. <a href="https://doi.org/10.1177/25152459221106366">https://doi.org/10.1177/25152459221106366</a>.
</div>
<div id="ref-hernan2024WHATIF" class="csl-entry" role="listitem">
Hernan, M. A., and J. M. Robins. 2020. <em>Causal Inference: What If?</em> Chapman &amp; Hall/CRC Monographs on Statistics &amp; Applied Probab. Taylor &amp; Francis. <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/</a>.
</div>
<div id="ref-hernan2017SELECTIONWITHOUTCOLLIDER" class="csl-entry" role="listitem">
Hernán, M. A. 2017. <span>“Invited Commentary: Selection Bias Without Colliders | American Journal of Epidemiology | Oxford Academic.”</span> <em>American Journal of Epidemiology</em> 185 (11): 1048–50. <a href="https://doi.org/10.1093/aje/kwx077">https://doi.org/10.1093/aje/kwx077</a>.
</div>
<div id="ref-hernan2008aObservationalStudiesAnalysedLike" class="csl-entry" role="listitem">
Hernán, Miguel A., Alvaro Alonso, Roger Logan, Francine Grodstein, Karin B. Michels, Walter C. Willett, JoAnn E. Manson, and James M. Robins. 2008. <span>“Observational Studies Analyzed Like Randomized Experiments: An Application to Postmenopausal Hormone Therapy and Coronary Heart Disease.”</span> <em>Epidemiology</em> 19 (6): 766. <a href="https://doi.org/10.1097/EDE.0b013e3181875e61">https://doi.org/10.1097/EDE.0b013e3181875e61</a>.
</div>
<div id="ref-hernan2004STRUCTURAL" class="csl-entry" role="listitem">
Hernán, Miguel A., Sonia Hernández-Díaz, and James M. Robins. 2004. <span>“A Structural Approach to Selection Bias.”</span> <em>Epidemiology</em> 15 (5): 615–25. <a href="https://www.jstor.org/stable/20485961">https://www.jstor.org/stable/20485961</a>.
</div>
<div id="ref-hernan2017per" class="csl-entry" role="listitem">
Hernán, Miguel A, and James M Robins. 2017. <span>“Per-Protocol Analyses of Pragmatic Trials.”</span> <em>N Engl J Med</em> 377 (14): 1391–98.
</div>
<div id="ref-kessler2002" class="csl-entry" role="listitem">
Kessler, R.C., G. Andrews, L.J. Colpe, E. Hiripi, D.K. Mroczek, S.-L.T. Normand, E. E. Walters, and A.M. Zaslavsky. 2002. <span>“Short Screening Scales to Monitor Population Prevalences and Trends in Non-Specific Psychological Distress.”</span> <em>Psychological Medicine</em> 32 (6): 959–76. <a href="https://doi.org/10.1017/S0033291702006074">https://doi.org/10.1017/S0033291702006074</a>.
</div>
<div id="ref-morgan2014" class="csl-entry" role="listitem">
Morgan, Stephen L., and Christopher Winship. 2014. <em>Counterfactuals and Causal Inference: Methods and Principles for Social Research</em>. 2nd ed. Analytical Methods for Social Research. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9781107587991">https://doi.org/10.1017/CBO9781107587991</a>.
</div>
<div id="ref-neal2020introduction" class="csl-entry" role="listitem">
Neal, Brady. 2020. <span>“Introduction to Causal Inference from a Machine Learning Perspective.”</span> <em>Course Lecture Notes (Draft)</em>. <a href="https://www.bradyneal.com/Introduction_to_Causal_Inference-Dec17_2020-Neal.pdf">https://www.bradyneal.com/Introduction_to_Causal_Inference-Dec17_2020-Neal.pdf</a>.
</div>
<div id="ref-ogburn2021" class="csl-entry" role="listitem">
Ogburn, Elizabeth L., and Ilya Shpitser. 2021. <span>“Causal Modelling: The Two Cultures.”</span> <em>Observational Studies</em> 7 (1): 179–83. <a href="https://doi.org/10.1353/obs.2021.0006">https://doi.org/10.1353/obs.2021.0006</a>.
</div>
<div id="ref-pearl2022external" class="csl-entry" role="listitem">
Pearl, Judea, and Elias Bareinboim. 2022. <span>“External Validity: From Do-Calculus to Transportability Across Populations.”</span> In <em>Probabilistic and Causal Inference: The Works of Judea Pearl</em>, 451–82.
</div>
<div id="ref-stuart2018generalizability" class="csl-entry" role="listitem">
Stuart, Elizabeth A, Benjamin Ackerman, and Daniel Westreich. 2018. <span>“Generalizability of Randomized Trial Results to Target Populations: Design and Analysis Possibilities.”</span> <em>Research on Social Work Practice</em> 28 (5): 532–37.
</div>
<div id="ref-vanderweele2013" class="csl-entry" role="listitem">
VanderWeele, Tyler J, and Miguel A Hernan. 2013. <span>“Causal Inference Under Multiple Versions of Treatment.”</span> <em>Journal of Causal Inference</em> 1 (1): 1–20.
</div>
<div id="ref-vanderweele2012MEASUREMENT" class="csl-entry" role="listitem">
VanderWeele, Tyler J., and Miguel A. Hernán. 2012. <span>“Results on Differential and Dependent Measurement Error of the Exposure and the Outcome Using Signed Directed Acyclic Graphs.”</span> <em>American Journal of Epidemiology</em> 175 (12): 1303–10. <a href="https://doi.org/10.1093/aje/kwr458">https://doi.org/10.1093/aje/kwr458</a>.
</div>
<div id="ref-westreich2010" class="csl-entry" role="listitem">
Westreich, Daniel, and Stephen R. Cole. 2010. <span>“Invited commentary: positivity in practice.”</span> <em>American Journal of Epidemiology</em> 171 (6). <a href="https://doi.org/10.1093/aje/kwp436">https://doi.org/10.1093/aje/kwp436</a>.
</div>
<div id="ref-westreich2017transportability" class="csl-entry" role="listitem">
Westreich, Daniel, Jessie K Edwards, Catherine R Lesko, Elizabeth Stuart, and Stephen R Cole. 2017. <span>“Transportability of Trial Results Using Inverse Odds of Sampling Weights.”</span> <em>American Journal of Epidemiology</em> 186 (8): 1010–14.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "The Causal Workflow"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-NOV-19"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> /Users/joseph/GIT/templates/bib/references.bib</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    warnings: FALSE</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">    error: FALSE</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">    messages: FALSE</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: dracula</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools:</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: FALSE</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="an">html-math-method:</span><span class="co"> katex</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="an">cap-location:</span><span class="co"> margin</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co"># reference-location: margin</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># citation-location: margin</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/libs2.R")</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/funs.R")</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">ALERT</span><span class="co">: UNCOMMENT THIS AND DOWNLOAD THE FUNCTIONS FROM JB's GITHUB</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co"># source(</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   "https://raw.githubusercontent.com/go-bayes/templates/main/functions/experimental_funs.R"</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co"># source(</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   "https://raw.githubusercontent.com/go-bayes/templates/main/functions/experimental_funs.R"</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co"># for making graphs</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"extrafont"</span>)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"all"</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="fu">##  Readings for Workshop</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Barrett M (2023). _ggdag: Analyze and Create Elegant Directed Acyclic Graphs_. R package version 0.2.7.9000, <span class="ot">&lt;https://github.com/malcolmbarrett/ggdag&gt;</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>"An Introduction to Directed Acyclic Graphs", <span class="ot">&lt;https://r-causal.github.io/ggdag/articles/intro-to-dags.html&gt;</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>"Common Structures of Bias", <span class="ot">&lt;https://r-causal.github.io/ggdag/articles/bias-structures.html&gt;</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Causal Workflow</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**State a well-defined treatment.**  </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>   Specify the hypothetical intervention precisely enough that every member of the target population could, in principle, receive it. For example, 'weight loss' is too vague—people lose weight via exercise, diet, depression, cancer, amputation, and more <span class="co">[</span><span class="ot">@hernan2024WHATIF</span><span class="co">]</span>. A clearer intervention is: *"engage in vigorous physical activity for $\ge$ 30 minutes per day"* <span class="co">[</span><span class="ot">@hernan2008aObservationalStudiesAnalysedLike</span><span class="co">]</span>. Precision here underwrites consistency (see step 5) and interpretability downstream.</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**State a well-defined outcome.**  </span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>   Define the outcome so the causal contrast is meaningful and temporally anchored. ‘Well-being’ is underspecified; *'psychological distress one year post-intervention measured with the Kessler-6'* is interpretable and reproducible <span class="co">[</span><span class="ot">@kessler2002</span><span class="co">]</span>. Include timing, scale, and instrument.</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Clarify the target population.**  </span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>   Say exactly *who* you aim to inform. Eligibility rules define the **source population**, but sampling and participation can yield a **study population** with a different distribution of effect modifiers <span class="co">[</span><span class="ot">@dahabreh2019; @dahabreh2019generalizing; @stuart2018generalizability; @bulbulia2024wierd</span><span class="co">]</span>. If you intend to generalise beyond the source population (transport), articulate the additional conditions and knowledge required <span class="co">[</span><span class="ot">@deffner2022; @bareinboim2013general; @westreich2017transportability; @dahabreh2019; @pearl2022external</span><span class="co">]</span>.</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Evaluate whether treatment groups are exchangeable given measured covariates.**  </span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>   Make the case that potential outcomes are independent of treatment conditional on covariates, i.e., $Y(a)\coprod A\mid X$ <span class="co">[</span><span class="ot">@neal2020introduction; @morgan2014; @angrist2009mostly; @hernan2024WHATIF</span><span class="co">]</span>. Use design and diagnostics (design diagrams/DAGs, subject-matter arguments, pre-treatment covariate balance, overlap checks). If exchangeability is doubtful, redesign (e.g., stronger measurement, alternative identification strategies) rather than rely solely on modelling.</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Ensure treatments to be compared satisfy causal consistency.**  </span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>   Consistency requires that, for units receiving a treatment *version* compatible with level $a$, the observed outcome equals $Y(a)$; it also presumes well-defined versions and no interference between units <span class="co">[</span><span class="ot">@vanderweele2013; @hernan2024WHATIF</span><span class="co">]</span>. When multiple versions exist, either refine the intervention so versions are irrelevant to $Y(a)$, or condition on version-defining covariates in ways that preserve your estimand.</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Check the positivity (overlap) assumption.**  </span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>   Each treatment level must occur with non-zero probability at every covariate profile needed for exchangeability—and, when versions exist, for consistency as well <span class="co">[</span><span class="ot">@westreich2010</span><span class="co">]</span>. Diagnose limited overlap (propensity score distributions, extreme weights), and consider design-stage remedies (trimming, restriction, adaptive sampling) before estimation.</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**Ensure measurement aligns with the scientific question.**  </span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>   Verify that constructs are captured by instruments whose error structures won’t distort the causal contrast of interest. Be explicit about likely forms of measurement error (classical, Berkson, differential, misclassification) and their structural implications for bias <span class="co">[</span><span class="ot">@hernan2024WHATIF; @vanderweele2012MEASUREMENT; @bulbulia2024wierd</span><span class="co">]</span>. Where feasible, incorporate validation studies, multiple indicators, or calibration models.</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>**Preserve representativeness from start to finish.**  </span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>   End-of-study analyses should reflect the target population’s distribution of effect modifiers. Differential attrition, non-response, or measurement processes tied to treatment and outcomes can induce selection bias in the presence of true effects <span class="co">[</span><span class="ot">@hernan2017SELECTIONWITHOUTCOLLIDER; @hernan2017per; @hernan2004STRUCTURAL; @bulbulia2024wierd</span><span class="co">]</span>. Plan and justify strategies such as inverse probability weighting for censoring, multiple imputation under defensible mechanisms, sensitivity analyses for missing not at random, and careful timing of measurements.</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>**Document the reasoning that supports steps 1–8.**  </span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>   Make assumptions, disagreements, and judgement calls legible: register or otherwise time-stamp your analytic plan; include identification arguments (e.g., DAGs), code, and data where possible; report robustness and sensitivity analyses; and explain decisions about design restrictions, modelling choices, and transportability <span class="co">[</span><span class="ot">@ogburn2021</span><span class="co">]</span>. Transparent reasoning is a scientific result in its own right.</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> 1 Nine‑Step Causal Inference Workflow  --&gt;</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | Step | Requirement | Key Question(s) | Example Good vs. Poor Definition | Core Assumption | --&gt;</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- |------|-------------|-----------------|----------------------------------|-----------------| --&gt;</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | **1** | **State a Well-Defined Treatment** | What specific hypothetical intervention will be applied to all population members? | ✅ "Weight loss by at least 30 minutes of vigorous exercise each day" &lt;br&gt; ❌ "Weight loss" (many pathways: diet, exercise, illness, surgery) | **Consistency** | --&gt;</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | **2** | **State a Well-Defined Outcome** | What specific outcome measure will be assessed, when, and how? | ✅ "Psychological distress measured one year after intervention using Kessler-6 scale" &lt;br&gt; ❌ "Well-being" (vague construct) | **Interpretability** | --&gt;</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | **3** | **Clarify the Target Population** | To whom will results generalise? How does the source population relate to the target? | ✅ "New Zealand adults aged 18+ as represented in NZAVS weighted by census demographics" &lt;br&gt; ❌ "People in general" | **Generalisability** | --&gt;</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | **4** | **Evaluate Exchangeability** | Are treatment groups independent of potential outcomes conditional on measured covariates? | Can we achieve conditional independence through measured confounders? Consider unmeasured confounding. | **Conditional Exchangeability** | --&gt;</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | **5** | **Ensure Causal Consistency** | Are treatment versions independent of potential outcomes conditional on covariates? | Do different ways of receiving "treatment" yield the same potential outcomes? | **Consistency** | --&gt;</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | **6** | **Check Positivity** | Is there non-zero probability of each treatment level at every covariate combination? | Examine overlap in treatment assignment across the full covariate space. | **Positivity** | --&gt;</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | **7** | **Evaluate Measurement Validity** | Do measures relate to scientific questions? What are sources of measurement error bias? | Consider structural features of measurement error and their impact on causal inference. | **Measurement Validity** | --&gt;</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | **8** | **Address Attrition and Selection** | Does the final study group represent the target population throughout the study period? | Develop strategies for attrition, non-response, and measurement error bias. | **Representativeness** | --&gt;</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | **9** | **Document Transparently** | Have all reasoning, evidence, and decisions for steps 1-8 been clearly communicated? | Provide thorough documentation including causal assumptions and disagreements. | **Transparency** | --&gt;</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## STEP 1: Ask Your Causal Question --&gt;</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **State your question:** is my question clearly stated? If not, state it. --&gt;</span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Relevance:** have I explained its importance? If not, explain. --&gt;</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Ethics** how might this question affect people? How might not investigating this question affect people?  --&gt;</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Causality:** Is my question causal? If not, refine your question. --&gt;</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Heterogeneous Treatment Effects**:  Do I want to examine who responds differently (CATE)? --&gt;</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Subgroup analysis:** does my question involve a subgroup (e.g., cultural group)? If not, develop a subgroup analysis question. --&gt;</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Explain the Framework:** can I explain the causal inference framework and convey the gist to non-specialists? --&gt;</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Determine Data Requirements --&gt;</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Data types:** is treatment assignment in my data randomised?  --&gt;</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Time-series data:** are my data time-series? If not, reconsider your causal question. --&gt;</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Data waves:** do I have at least three waves of data? If not, beware of confounding control issues. --&gt;</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Data source:** what are the biases in collection/reporting --&gt;</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Determine the Outcome --&gt;</span></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Outcome variable:** is the outcome variable *Y* defined? If not, define it. --&gt;</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Multiple outcomes:** are there multiple outcomes? If yes, explain and define them. --&gt;</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Outcome relevance:** can I explain how the outcome variable/s relate to my question? If not, clarify. --&gt;</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Outcome type:** is my outcome binary and rare? If yes, consider logistic regression. If my outcome is continuous, consider z-transforming it or categorising it (consult an expert). --&gt;</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Outcome timing:** does the outcome appear after the exposure? It should. --&gt;</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Determine the Exposure --&gt;</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Exposure variable:** is the exposure variable *A* defined? If not, define it. --&gt;</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Multiple exposures:** are there multiple exposures? If yes, reassess; if only one exposure, proceed. --&gt;</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Exposure relevance:** can I explain how the exposure variable relates to my question? If not, clarify. --&gt;</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Positivity:** can we intervene on the exposure at all levels of the covariates? We should be able to. --&gt;</span></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Consistency:** can I interpret what it means to intervene on the exposure?  --&gt;</span></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Exchangeability:** are different versions of the exposure conditionally exchangeable given measured baseline confounders? They should be. --&gt;</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Exposure type:** is the exposure binary or continuous? --&gt;</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Shift intervention**: Am I contrasting static interventions or modified treatment policies?   --&gt;</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Exposure timing:** Does the exposure appear before the outcome? It should. --&gt;</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Account for Confounders --&gt;</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Baseline confounders:** Have I defined my baseline confounders *L*? I should have. --&gt;</span></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Justification:** Can I explain how the baseline confounders could affect both *A* and *Y*? I should be able to. --&gt;</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Timing:** Are the baseline confounders measured before the exposure? They should be. --&gt;</span></span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Inclusion:** Is the baseline measure of the exposure and the baseline outcome included in the set of baseline confounders? They should be. --&gt;</span></span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Sufficiency:** Are the baseline confounders sufficient to ensure balance on the exposure, such that *A* is independent of *Y* given *L*? If not, plan a sensitivity analysis. --&gt;</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Confounder type:** Are the confounders continuous or binary? If so, consider converting them to z-scores. If they are categorical with three or more levels, do not convert them to z-scores. --&gt;</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Draw a Causal Diagram with Unmeasured Confounders --&gt;</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Unmeasured confounders:** Does previous science suggest the presence of unmeasured confounders? If not, expand your understanding. --&gt;</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Causal diagram:** Have I drawn a causal diagram (DAG) to highlight both measured and unmeasured sources of confounding?  --&gt;</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Measurement error:** Have I described potential biases from measurement errors? If not, we'll discuss later. --&gt;</span></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Temporal order:** Does my DAG have time indicators to ensure correct temporal order? It should. --&gt;</span></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Time consistency:** Is my DAG organized so that time follows in a consistent direction? It should. --&gt;</span></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Identify the Estimand --&gt;</span></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- - ATE or CATE or both? --&gt;</span></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Understanding Source and Target Populations --&gt;</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Populations identified:** Have I explained how my sample relates to my target populations? I should have. --&gt;</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Generalisability and transportability:** Have I considered whether my results generalise different populations?  I should have. --&gt;</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Set Eligibility Criteria --&gt;</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Criteria stated:** Have I stated the eligibility criteria for the study? I should have. --&gt;</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Describe Sample Characteristics --&gt;</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Descriptive statistics:** have I provided descriptive statistics for demographic information taken at baseline? I should have. --&gt;</span></span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Exposure change:** Have I demonstrated the magnitudes of change in the exposure from baseline to the exposure interval? I should have. --&gt;</span></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **References:** Have I included references for more information about the sample? I should have. --&gt;</span></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Addressing Missing Data --&gt;</span></span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Missing data checks:** Have I checked for missing data? I should have. --&gt;</span></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Missing data plan:** If there is missing data, have I described how I will address it? I should have. --&gt;</span></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Selecting the Model Approach: If Not Using Machine Learning  --&gt;</span></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Approach decision:** Have I decided on using G-computation, IPTW, or Doubly-Robust Estimation? I should have. --&gt;</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Interactions:** If not using machine learning, have I included the interaction of the exposure and baseline covariates? I should have. --&gt;</span></span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Big data:** If I have a large data set, should I include the interaction of the exposure, group, and baseline confounders? I should consider it. --&gt;</span></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Model specification:** have I double-checked the model specification? I should. --&gt;</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Outcome assessment:** If the outcome is rare and binary, have I specified logistic regression? If it's continuous, have I considered converting it to z-scores? --&gt;</span></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   -   **Sensitivity analysis:** am I planning a sensitivity analysis using simulation? If yes, describe it (e.g. E-values.) --&gt;</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Machine Learing --&gt;</span></span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Have I explained how causal forests work  -- also the workshop R package --&gt;</span></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Clarify unmeasured pre-treatment covariates --&gt;</span></span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Let **U** denoted unmeasured pre-treatment covariates that may potentially bias the statistical association between *A* and *Y* independently of the measured covariates. --&gt;</span></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Consider: --&gt;</span></span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   To affect *Y* and *A*, *U* must occur before *A*. --&gt;</span></span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   It is useful to draw a causal diagramme to illustrate all potential sources of bias. --&gt;</span></span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   Causal diagrammes are qualitative tools that require specialist expertise. We cannot typically obtain a causal graph from the data. --&gt;</span></span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   A causal diagramme should include only as much information as is required to assess confounding. See @fig-dag-outcomewide for an example. --&gt;</span></span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   Because we cannot ensure the absence of unmeasured confounders in observational settings, it is vital to conduct sensitivity analyses for the results. For sensitivity analyeses, we use E-values. --&gt;</span></span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Choose the scale for a causal contrast --&gt;</span></span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Difference/ Risk ratio?  --&gt;</span></span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Consider: --&gt;</span></span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   In the causal inference literature, the concept we use to make sense of stratum specific comparisons is called "effect modification." --&gt;</span></span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   By inferring effects within strata, we may evaluate whether the effects of different exposures or treatments on some well-defined outcome (measured in some well-defined time-period after the exposure) differ depending on group measurement. --&gt;</span></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   The logic of effect modification differs slightly from that of interaction. --&gt;</span></span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Aside: extensions --&gt;</span></span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- For continuous exposures, we must stipulate the level of contrast for the exposure (e.g. weekly versus monthly church attendance): --&gt;</span></span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   $$ATE_{a,a'} = E[Y(a) - Y(a')]$$ --&gt;</span></span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This essentially denotes an average treatment effect comparing the outcome under treatment level $A$ to the outcome under treatment level $A'$. Likewise: --&gt;</span></span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   $$ATE_{a/a'} = \frac{E[Y(a)]}{E[Y(a')]}$$ --&gt;</span></span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This defines the contrast of $A$ and $A'$ on a ratio scale. --&gt;</span></span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Describe the population(s) for whom the intended study is meant to generalise by distinguishing between source and target populations. --&gt;</span></span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Consider the following concepts: --&gt;</span></span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Source population**: a source population is where we gather our data for a study. We pull our specific sample from this group. It needs to mirror the broader group for our conclusions to be valid and widely applicable.  --&gt;</span></span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Target population**: the target population is the larger group we aim to apply our study's results to. It could be defined by location, demographics, or specific conditions. The closer the source matches the target in ways that are relevant to our causal questions, the stronger our causal inferences about the target population will be. --&gt;</span></span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--  -   **Generalisability** refers to the ability to apply the causal effects estimated from a sample to the population it was drawn from. In simpler terms, it deals with the extrapolation of causal knowledge from a sample to the broader population. This concept is also called "external validity". --&gt;</span></span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   $$\text{Generalisability} = PATE \approx ATE_{\text{sample}}$$ --&gt;</span></span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Transportability** refers to the ability to extrapolate causal effects learned from a source population to a target population when certain conditions are met. It deals with the transfer of causal knowledge across different settings or populations. --&gt;</span></span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   $$\text{Transportability} = ATE_{\text{target}} \approx f(ATE_{\text{source}}, T)$$ --&gt;</span></span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- where $f$ is a function and $T$ is a function that maps the results from our source population to another population. To achieve transportability, we need information about the source and target populations and an understanding of how the relationships between treatment, outcome, and covariates differ between the populations. Assessing transportability requires scientific knowledge. --&gt;</span></span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Summary Step 1: Consider how much we need to do when asking a causal question! --&gt;</span></span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We discover that asking a causal question is a multifaceted task. It demands careful definition of the outcome, including its timing, the exposure, and covariates. It also requires selecting the appropriate scale for causal contrast, controlling for confounding, and potentially adjusting for sample weights or stratification. Finally, when asking a causal question, we must consider for whom the results apply. Only after following these steps can we then ask: "How may we answer this causal question?" --&gt;</span></span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## STEP 2: Answer Your Question --&gt;</span></span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Obtain longitudinal data --&gt;</span></span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Note that causal inference from observational data turns on the appropriate temporal ordering of the key variables involved in the study. --&gt;</span></span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Recall we have defined. --&gt;</span></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **A**: Our exposure or treatment variable, denoted as **A**. Here we consider the example of 'Church attendance'. --&gt;</span></span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Y**: The outcome variable we are interested in, represented by **Y**, is psychological distress. We operationalise this variable through the 'Kessler-6' distress scale. --&gt;</span></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **L**: The confounding variables, collectively referred to as **L**, represent factors that can independently influence both **A** and **Y**. For example, socio-economic status could be a confounder that impacts both the likelihood of church attendance and the levels of psychological distress. --&gt;</span></span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Given the importance of temporal ordering, we must now define time: --&gt;</span></span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **t** $\in$ T: Let $t$ denote within a multiwave panel study with **T** measurement intervals. --&gt;</span></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--  Where $t/\text{{exposure}}$ denotes the measurement interval for the exposure. Longitudinal data collection provides us the ability to establish a causal model such that: --&gt;</span></span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$t_{confounders} &lt; t_{exposure}&lt; t_{outcome}$$ --&gt;</span></span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- To minimise the posibility of time-varying confounding and obtain the clearest effect estimates, we should acquire the most recent values of $\mathbf{L}$ preceding $A$ and the latest values of $A$ before $Y$. --&gt;</span></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Note in @fig-dag-outcomewide, We use the prefixes "t0, t1, and t2" to denote temporal ordering. We include in the set of baseline confounders the pre-exposure measurement of *A* and *Y*. This allows for more substantial confounding control. For unmeasured confounder to affect both the exposure and the outcome, it would need to do so independently of the pre-exposure confounders. Additionally, including the baseline exposure gives us an effect estimate for the incidence exposure, rather than the prevelance of the exposure. This helps us to assess the expected change in the outcome were we to initate a change in the exposure. --&gt;</span></span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Include the measured exposure with baseline covariates --&gt;</span></span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Controlling for prior exposure enables the interpretation of the effect estimate as a change in the exposure in a manner akin to a randomised trial. We propose that the effect estimate with prior control for the exposure estimates the "incidence exposure" rather than the "prevalence exposure" [@danaei2012]. It is crucial to estimate the incidence exposure because if the effects of an exposure are harmful in the short term such that these effects are not subsequently measured, a failure to adjust for prior exposure will yield the illusion that the exposure is beneficial. Furthermore, this approach aids in controlling for unmeasured confounding. For such a confounder to explain away the observed exposure-outcome association, it would need to do so independently of the prior level of the exposure and outcome. --&gt;</span></span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> State the eligibility criteria for participation --&gt;</span></span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This step is invaluable for assessing whether we are answering the causal question that we have asked. --&gt;</span></span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Consider: --&gt;</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   Generalisability: we cannot evaluate inferences to a target group from the source population if we do not describe the source population --&gt;</span></span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   Eligibility criteria will help us to ensure whether we have correctly evaluated potential measurement bias/error in our instruments. For example, the New Zealand Attitudes and Values Study is a National Probability study of New Zealanders. Individuals were randomly selected from the country's electoral roll. From these invitations there was typically less than 15% response rate. How might this process of recruitment affect generalisability and transportability of our results? --&gt;</span></span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- - Aside: discuss per protocol effects/ intention to treat effects --&gt;</span></span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Determine how missing data will be handled --&gt;</span></span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -  As we consider in this workshop, loss to follow up and non-response opens sources for bias. We must develop a strategy for handling missing data. --&gt;</span></span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> State a statistical model --&gt;</span></span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The models you considered on Day 1 of this workshop are G-computation, Inverse Probability of Treatement Weighting, and Doubly-Robust estimation. --&gt;</span></span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Reporting --&gt;</span></span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Consider the following ideas about how to report your model: --&gt;</span></span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Estimator**: Doubly robust where possible. --&gt;</span></span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Propensity Score Reporting:** Detail the process of propensity score derivation, including the model used and any variable transformations. --&gt;</span></span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **WeightIt Package:** Explicitly mention the use of the 'WeightIt' package in R, including any specific options or parameters used in the propensity score estimation process. --&gt;</span></span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Method Variations:** Report if different methods were used to obtain propensity scores, and the reasons behind the choice of methods such as 'ebal', 'energy', and 'ps'. --&gt;</span></span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Continuous Exposures:** Highlight that for continuous exposures, only the 'energy' option was used for propensity score estimation. --&gt;</span></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -  **Binary Exposure** Justify your cutpoints by referencing theory/existing knowledge *in advance* of conducting the analysis. --&gt;</span></span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Subgroup Estimation:** Confirm that the propensity scores for subgroups were estimated separately, and discuss how the weights were subsequently combined with the original data. --&gt;</span></span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Covariate Balance:** Include a Love plot to visually represent covariate balance on the exposure both before and after weighting. --&gt;</span></span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Weighting Algorithm Statistics:** Report the statistics for the weighting algorithms as provided by the WeightIt package, including any measures of balance or fit. --&gt;</span></span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Outcome Regression Model:** Clearly report the type of regression model used to estimate outcome model coefficients (e.g., linear regression, Poisson, binomial), and mention if the exposure was interacted with the baseline covariates. Do not report model coefficients as these have no interpretation. --&gt;</span></span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Subgroup Interaction:** Address whether the subgroup was included separately as an interaction in the outcome model, and if the model successfully converged. --&gt;</span></span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Machine Learning Using `lmtp`** If using the `lmtp` package, do a stratified analysis. (see today's lab) --&gt;</span></span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Model coefficients:** note that the model coefficients should not be interpreted, as they are not meaningful in this context. --&gt;</span></span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Confidence intervals and standard errors:** Describe the methods used to derive confidence intervals and standard errors, noting the use of the 'clarify' package in R for simulation based inference. --&gt;</span></span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Example of how to report a doubly robust method in your report --&gt;</span></span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The Doubly Robust Estimation method for Subgroup Analysis Estimator is a sophisticated tool combining features of both IPTW and G-computation methods, providing unbiased estimates if either the propensity score or outcome model is correctly specified. The process involves five main steps: --&gt;</span></span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 1** involves the estimation of the propensity score, a measure of the conditional probability of exposure given the covariates and the subgroup indicator. This score is calculated using statistical models such as logistic regression, with the model choice depending on the nature of the data and exposure. Weights for each individual are then calculated using this propensity score. These weights depend on the exposure status and are computed differently for exposed and unexposed individuals. The estimation of propensity scores is performed separately within each subgroup stratum. --&gt;</span></span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 2** focuses on fitting a weighted outcome model, making use of the previously calculated weights from the propensity scores. This model estimates the outcome conditional on exposure, covariates, and subgroup, integrating the weights into the estimation process. Unlike in propensity score model estimation, covariates are included as variables in the outcome model. This inclusion makes the method doubly robust - providing a consistent effect estimate if either the propensity score or the outcome model is correctly specified, thereby reducing the assumption of correct model specification. --&gt;</span></span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 3** entails the simulation of potential outcomes for each individual in each subgroup. These hypothetical scenarios assume universal exposure to the intervention within each subgroup, regardless of actual exposure levels. The expectation of potential outcomes is calculated for each individual in each subgroup, using individual-specific weights. These scenarios are performed for both the current and alternative interventions. --&gt;</span></span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 4** is the estimation of the average causal effect for each subgroup, achieved by comparing the computed expected values of potential outcomes under each intervention level. The difference represents the average causal effect of changing the exposure within each subgroup.  --&gt;</span></span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 5** involves comparing differences in causal effects across groups by calculating the differences in the estimated causal effects between different subgroups. Confidence intervals and standard errors for these calculations are determined using simulation-based inference methods [@greifer2023]. This step allows for a comprehensive comparison of the impact of different interventions across various subgroups, while encorporating uncertainty. --&gt;</span></span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-336"><a href="#cb3-336" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Inference --&gt;</span></span>
<span id="cb3-337"><a href="#cb3-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-338"><a href="#cb3-338" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Consider the following ideas about what to discuss in one's findings: --&gt;</span></span>
<span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--                                                                                                                           Consider the following ideas about what to discuss in one's findings. The order of exposition might be different. --&gt;</span></span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 1.  **Summary of results**:  What did you find? --&gt;</span></span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 2. **Interpretation of E-values:** Interpret the E-values used for sensitivity analysis. State what they represent in terms of the robustness of the findings to potential unmeasured confounding. --&gt;</span></span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 3.  **Causal Effect Interpretation:** What is the interest of the effect, if any, if an effect was observed? Interpret the average causal effect of changing the exposure level within each subgroup, and discuss its relevance to the research question.  --&gt;</span></span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 4.  **Comparison of Subgroups:** Discuss how differences in causal effect estimates between different subgroups, if observed, or if not observed, contribute to the overall findings of the study. --&gt;</span></span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 5.  **Uncertainty and Confidence Intervals:** Consider the uncertainty around the estimated causal effects, and interpret the confidence intervals to understand the precision of the estimates. --&gt;</span></span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 6.  **Generalisability and Transportability:** Reflect on the generalizability of the study results to other contexts or populations. Discuss any factors that might influence the transportability of the causal effects found in the study. (Again see lecture 9.) --&gt;</span></span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 7.  **Assumptions and Limitations:** Reflect on the assumptions made during the study and identify any limitations in the methodology that could affect the interpretation of results. State that the implications of different intervention levels on potential outcomes are not analysed.  --&gt;</span></span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 8.  **Theoretical Relevance**: How are these findings relevant to existing theories.  --&gt;</span></span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 9.  **Replication and Future Research:** Consider how the study could be replicated or expanded upon in future research, and how the findings contribute to the existing body of knowledge in the field. --&gt;</span></span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 10. **Real-world Implications:** Discuss the real-world implications of the findings, and how they could be applied in policy, practice, or further research. --&gt;</span></span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## Appendix A: Details of Estimation Approaches --&gt;</span></span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> G-computation for Subgroup Analysis Estimator --&gt;</span></span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 1:** Estimate the outcome model. Fit a model for the outcome $Y$, conditional on the exposure $A$, the covariates $L$, and subgroup indicator $G$. This model can be a linear regression, logistic regression, or another statistical model. The goal is to capture the relationship between the outcome, exposure, confounders, and subgroups. --&gt;</span></span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ \hat{E}(Y|A,L,G) = f_Y(A,L,G; \theta_Y) $$ --&gt;</span></span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This equation represents the expected value of the outcome $Y$ given the exposure $A$, covariates $L$, and subgroup $G$, as modelled by the function $f_Y$ with parameters $\theta_Y$. This formulation allows for the prediction of the average outcome $Y$ given certain values of $A$, $L$, and $G$. --&gt;</span></span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 2:** Simulate potential outcomes. For each individual in each subgroup, predict their potential outcome under the intervention $A=a$ using the estimated outcome model: --&gt;</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{E}[Y(a)|G=g] = \frac{1}{N_g} \sum_{i:G_i=g} \hat{E}[Y|A=a, L=L_i, G=g; \hat{\theta}_Y]$$ --&gt;</span></span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We also predict the potential outcome for everyone in each subgroup under the causal contrast, setting the intervention for everyone in that group to $A=a'$: --&gt;</span></span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-378"><a href="#cb3-378" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--                                                                                                                        $$\hat{E}[Y(a')|G=g] = \frac{1}{N_g} \sum_{i:G_i=g} \hat{E}[Y|A=a', L=L_i, G=g; \hat{\theta}_Y]$$ --&gt;</span></span>
<span id="cb3-379"><a href="#cb3-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-380"><a href="#cb3-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-381"><a href="#cb3-381" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   In these equations, $Y$ represents the potential outcome, $A$ is the intervention, $L$ are the covariates, $G=g$ represents the subgroup, and $\theta_Y$ are the parameters of the outcome model. --&gt;</span></span>
<span id="cb3-382"><a href="#cb3-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-383"><a href="#cb3-383" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   **Step 3:** Calculate the estimated difference for each subgroup $g$: --&gt;</span></span>
<span id="cb3-384"><a href="#cb3-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-385"><a href="#cb3-385" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     $$\hat{\delta}_g = \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g]$$ --&gt;</span></span>
<span id="cb3-386"><a href="#cb3-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-387"><a href="#cb3-387" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This difference $\hat{\delta}_g$ represents the average causal effect of changing the exposure from level $a'$ to level $a$ within each subgroup $g$. --&gt;</span></span>
<span id="cb3-388"><a href="#cb3-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-389"><a href="#cb3-389" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. --&gt;</span></span>
<span id="cb3-390"><a href="#cb3-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-391"><a href="#cb3-391" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 4:** Compare differences in causal effects by subgroups: --&gt;</span></span>
<span id="cb3-392"><a href="#cb3-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-393"><a href="#cb3-393" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--  $$\hat{\gamma} = \hat{\delta}_g - \hat{\delta}_{g'}$$ --&gt;</span></span>
<span id="cb3-394"><a href="#cb3-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-395"><a href="#cb3-395" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- where, --&gt;</span></span>
<span id="cb3-396"><a href="#cb3-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-397"><a href="#cb3-397" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{\gamma} = \overbrace{\big( \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g] \big)}^{\hat{\delta}_g} - \overbrace{\big( \hat{E}[Y(a)|G=g'] - \hat{E}[Y(a')|G=g'] \big)}^{\hat{\delta}_{g'}}$$ --&gt;</span></span>
<span id="cb3-398"><a href="#cb3-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-399"><a href="#cb3-399" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This difference $\hat{\gamma}$ represents the difference in the average causal effects between the subgroups $g$ and $g'$. It measures the difference in effect of the exposure $A$ within subgroup $G$ on the outcome $Y$.[^note_care]  --&gt;</span></span>
<span id="cb3-400"><a href="#cb3-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-401"><a href="#cb3-401" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- [^note_care]: $A$ and $G$ on $Y$ might not be additive. We assume that the potential confounders $L$ are sufficient to control for confounding. See Appendix --&gt;</span></span>
<span id="cb3-402"><a href="#cb3-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-403"><a href="#cb3-403" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We again use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. --&gt;</span></span>
<span id="cb3-404"><a href="#cb3-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-405"><a href="#cb3-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-406"><a href="#cb3-406" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Inverse Probability of Treatment Weighting (IPTW) for Subgroup Analysis Estimator --&gt;</span></span>
<span id="cb3-407"><a href="#cb3-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-408"><a href="#cb3-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-409"><a href="#cb3-409" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 1:** Estimate the propensity score. The propensity score $e(L, G)$ is the conditional probability of the exposure $A = 1$, given the covariates $L$ and subgroup indicator $G$. This can be modeled using logistic regression or other suitable methods, depending on the nature of the data and the exposure. --&gt;</span></span>
<span id="cb3-410"><a href="#cb3-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-411"><a href="#cb3-411" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{e} = P(A = 1 | L, G) = f_A(L, G; \theta_A)$$ --&gt;</span></span>
<span id="cb3-412"><a href="#cb3-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-413"><a href="#cb3-413" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Here, $f_A(L, G; \theta_A)$ is a function (statistical model) that estimates the probability of the exposure $A = 1$ given covariates $L$ and subgroup $G$. Then, we calculate the weights for each individual, denoted as $v$, using the estimated propensity score: --&gt;</span></span>
<span id="cb3-414"><a href="#cb3-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-415"><a href="#cb3-415" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb3-416"><a href="#cb3-416" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- v = --&gt;</span></span>
<span id="cb3-417"><a href="#cb3-417" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \begin{cases} --&gt;</span></span>
<span id="cb3-418"><a href="#cb3-418" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \frac{1}{\hat{e}} &amp; \text{if } A = 1 \\ --&gt;</span></span>
<span id="cb3-419"><a href="#cb3-419" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \frac{1}{1-\hat{e}} &amp; \text{if } A = 0 --&gt;</span></span>
<span id="cb3-420"><a href="#cb3-420" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \end{cases} --&gt;</span></span>
<span id="cb3-421"><a href="#cb3-421" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb3-422"><a href="#cb3-422" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 2:** Fit a weighted outcome model. Using the weights calculated from the estimated propensity scores, fit a model for the outcome $Y$, conditional on the exposure $A$ and subgroup $G$. This can be represented as: --&gt;</span></span>
<span id="cb3-423"><a href="#cb3-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-424"><a href="#cb3-424" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ \hat{E}(Y|A, G; V) = f_Y(A, G ; \theta_Y, V) $$ --&gt;</span></span>
<span id="cb3-425"><a href="#cb3-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-426"><a href="#cb3-426" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- In this model, $f_Y$ is a function (such as a weighted regression model) with parameters $θ_Y$. --&gt;</span></span>
<span id="cb3-427"><a href="#cb3-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-428"><a href="#cb3-428" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 3:** Simulate potential outcomes. For each individual in each subgroup, simulate their potential outcome under the hypothetical scenario where everyone in the subgroup is exposed to the intervention $A=a$ regardless of their actual exposure level: --&gt;</span></span>
<span id="cb3-429"><a href="#cb3-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-430"><a href="#cb3-430" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{E}(Y(a)|G=g) = \hat{E}[Y|A=a,G=g; \hat{\theta}_Y, v]$$ --&gt;</span></span>
<span id="cb3-431"><a href="#cb3-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-432"><a href="#cb3-432" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- And also under the hypothetical scenario where everyone is exposed to intervention $A=a'$: --&gt;</span></span>
<span id="cb3-433"><a href="#cb3-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-434"><a href="#cb3-434" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{E}(Y(a')|G=g) = \hat{E}[Y|A=a',G=g; \hat{\theta}_Y, v]$$ --&gt;</span></span>
<span id="cb3-435"><a href="#cb3-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-436"><a href="#cb3-436" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 4:** Estimate the average causal effect for each subgroup as the difference in the predicted outcomes: --&gt;</span></span>
<span id="cb3-437"><a href="#cb3-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-438"><a href="#cb3-438" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{\delta}_g = \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g]$$ --&gt;</span></span>
<span id="cb3-439"><a href="#cb3-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-440"><a href="#cb3-440" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The estimated difference $\hat{\delta}_g$ represents the average causal effect within group $g$. --&gt;</span></span>
<span id="cb3-441"><a href="#cb3-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-442"><a href="#cb3-442" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 5:** Compare differences in causal effects by groups. Compute the differences in the estimated causal effects between different subgroups: --&gt;</span></span>
<span id="cb3-443"><a href="#cb3-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-444"><a href="#cb3-444" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     $$\hat{\gamma} = \hat{\delta}_g - \hat{\delta}_{g'}$$ --&gt;</span></span>
<span id="cb3-445"><a href="#cb3-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-446"><a href="#cb3-446" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- where, --&gt;</span></span>
<span id="cb3-447"><a href="#cb3-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-448"><a href="#cb3-448" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{\gamma} = \overbrace{\big( \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g] \big)}^{\hat{\delta}_g} - \overbrace{\big( \hat{E}[Y(a)|G=g'] - \hat{E}[Y(a')|G=g'] \big)}^{\hat{\delta}_{g'}}$$ --&gt;</span></span>
<span id="cb3-449"><a href="#cb3-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-450"><a href="#cb3-450" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This $\hat{\gamma}$ represents the difference in the average causal effects between the subgroups $g$ and $g'$. --&gt;</span></span>
<span id="cb3-451"><a href="#cb3-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-452"><a href="#cb3-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-453"><a href="#cb3-453" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We again use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. --&gt;</span></span>
<span id="cb3-454"><a href="#cb3-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-455"><a href="#cb3-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-456"><a href="#cb3-456" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Doubly Robust Estimation for Subgroup Analysis Estimator --&gt;</span></span>
<span id="cb3-457"><a href="#cb3-457" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- It appears that the Doubly Robust Estimation explanation for subgroup analysis is already clear and correct, covering all the necessary steps in the process. Nevertheless, there's a slight confusion in step 4. The difference $\delta_g$ is not defined within the document. I assume that you intended to write $\hat{\delta}_g$. Here's the corrected version: --&gt;</span></span>
<span id="cb3-458"><a href="#cb3-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-459"><a href="#cb3-459" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Doubly Robust Estimation for Subgroup Analysis Estimator --&gt;</span></span>
<span id="cb3-460"><a href="#cb3-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-461"><a href="#cb3-461" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Doubly Robust Estimation is a powerful technique that combines the strengths of both the IPTW and G-computation methods. It uses both the propensity score model and the outcome model, which makes it doubly robust: it produces unbiased estimates if either one of the models is correctly specified. --&gt;</span></span>
<span id="cb3-462"><a href="#cb3-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-463"><a href="#cb3-463" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 1** Estimate the propensity score. The propensity score $\hat{e}(L, G)$ is the conditional probability of the exposure $A = 1$, given the covariates $L$ and subgroup indicator $G$. This can be modeled using logistic regression or other suitable methods, depending on the nature of the data and the exposure. --&gt;</span></span>
<span id="cb3-464"><a href="#cb3-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-465"><a href="#cb3-465" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{e} = P(A = 1 | L, G) = f_A(L, G; \theta_A)$$ --&gt;</span></span>
<span id="cb3-466"><a href="#cb3-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-467"><a href="#cb3-467" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Here, $f_A(L, G; \theta_A)$ is a function (statistical model) that estimates the probability of the exposure $A = 1$ given covariates $L$ and subgroup $G$. Then, we calculate the weights for each individual, denoted as $v$, using the estimated propensity score: --&gt;</span></span>
<span id="cb3-468"><a href="#cb3-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-469"><a href="#cb3-469" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb3-470"><a href="#cb3-470" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- v =  --&gt;</span></span>
<span id="cb3-471"><a href="#cb3-471" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \begin{cases}  --&gt;</span></span>
<span id="cb3-472"><a href="#cb3-472" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \frac{1}{\hat{e}} &amp; \text{if } A = 1 \\ --&gt;</span></span>
<span id="cb3-473"><a href="#cb3-473" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \frac{1}{1-\hat{e}} &amp; \text{if } A = 0  --&gt;</span></span>
<span id="cb3-474"><a href="#cb3-474" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \end{cases} --&gt;</span></span>
<span id="cb3-475"><a href="#cb3-475" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb3-476"><a href="#cb3-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-477"><a href="#cb3-477" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 2** Fit a weighted outcome model. Using the weights calculated from the estimated propensity scores, fit a model for the outcome $Y$, conditional on the exposure $A$, covariates $L$, and subgroup $G$. --&gt;</span></span>
<span id="cb3-478"><a href="#cb3-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-479"><a href="#cb3-479" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ \hat{E}(Y|A, L, G; V) = f_Y(A, L, G ; \theta_Y, V) $$ --&gt;</span></span>
<span id="cb3-480"><a href="#cb3-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-481"><a href="#cb3-481" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 3** For each individual in each subgroup, simulate their potential outcome under the hypothetical scenario where everyone in the subgroup is exposed to the intervention $A=a$ regardless of their actual exposure level: --&gt;</span></span>
<span id="cb3-482"><a href="#cb3-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-483"><a href="#cb3-483" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{E}(Y(a)|G=g) = \hat{E}[Y|A=a,G=g; L,\hat{\theta}_Y, v]$$ --&gt;</span></span>
<span id="cb3-484"><a href="#cb3-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-485"><a href="#cb3-485" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- And also under the hypothetical scenario where everyone in each subgroup is exposed to intervention $A=a'$: --&gt;</span></span>
<span id="cb3-486"><a href="#cb3-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-487"><a href="#cb3-487" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   $$\hat{E}(Y(a')|G=g) = \hat{E}[Y|A=a',G=g; L; \hat{\theta}_Y, v]$$ --&gt;</span></span>
<span id="cb3-488"><a href="#cb3-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-489"><a href="#cb3-489" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 4** Estimate the average causal effect for each subgroup. Compute the estimated expected value of the potential outcomes under each intervention level for each subgroup: --&gt;</span></span>
<span id="cb3-490"><a href="#cb3-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-491"><a href="#cb3-491" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     $$\hat{\delta}_g = \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g]$$ --&gt;</span></span>
<span id="cb3-492"><a href="#cb3-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-493"><a href="#cb3-493" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The estimated difference $\hat{\delta}_g$ represents the average causal effect of changing the exposure from level $a'$ to level $a$ within each subgroup. --&gt;</span></span>
<span id="cb3-494"><a href="#cb3-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-495"><a href="#cb3-495" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 5** Compare differences in causal effects by groups. Compute the differences in the estimated causal effects between different subgroups: --&gt;</span></span>
<span id="cb3-496"><a href="#cb3-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-497"><a href="#cb3-497" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{\gamma} = \hat{\delta}_g - \hat{\delta}_{g'}$$ --&gt;</span></span>
<span id="cb3-498"><a href="#cb3-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-499"><a href="#cb3-499" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- where, --&gt;</span></span>
<span id="cb3-500"><a href="#cb3-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-501"><a href="#cb3-501" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{\gamma} = \overbrace{\big( \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g] \big)}^{\hat{\delta}_g} - \overbrace{\big( \hat{E}[Y(a)|G=g'] - \hat{E}[Y(a')|G=g'] \big)}^{\hat{\delta}_{g'}}$$ --&gt;</span></span>
<span id="cb3-502"><a href="#cb3-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-503"><a href="#cb3-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-504"><a href="#cb3-504" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We again use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. --&gt;</span></span>
<span id="cb3-505"><a href="#cb3-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-506"><a href="#cb3-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-507"><a href="#cb3-507" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## Appendix B: G-computation for Subgroup Analysis Estimator with Non-Additive Effects --&gt;</span></span>
<span id="cb3-508"><a href="#cb3-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-509"><a href="#cb3-509" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 1:** Estimate the outcome model. Fit a model for the outcome $Y$, conditional on the exposure $A$, the covariates $L$, subgroup indicator $G$, and interactions between $A$ and $G$. This model can be a linear regression, logistic regression, or another statistical model. The goal is to capture the relationship between the outcome, exposure, confounders, subgroups, and their interactions. --&gt;</span></span>
<span id="cb3-510"><a href="#cb3-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-511"><a href="#cb3-511" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ \hat{E}(Y|A,L,G,AG) = f_Y(A,L,G,AG; \theta_Y) $$ --&gt;</span></span>
<span id="cb3-512"><a href="#cb3-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-513"><a href="#cb3-513" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   This equation represents the expected value of the outcome $Y$ given the exposure $A$, covariates $L$, subgroup $G$, and interaction term $AG$, as modeled by the function $f_Y$ with parameters $\theta_Y$.  --&gt;</span></span>
<span id="cb3-514"><a href="#cb3-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-515"><a href="#cb3-515" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 2:** Simulate potential outcomes. For each individual in each subgroup, predict their potential outcome under the intervention $A=a$ using the estimated outcome model: --&gt;</span></span>
<span id="cb3-516"><a href="#cb3-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-517"><a href="#cb3-517" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   $$\hat{E}(Y(a)|G=g) = \hat{E}[Y|A=a,L,G=g,AG=ag; \hat{\theta}_Y]$$ --&gt;</span></span>
<span id="cb3-518"><a href="#cb3-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-519"><a href="#cb3-519" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We also predict the potential outcome for everyone in each subgroup under the causal contrast, setting the intervention for everyone in that group to $A=a'$: --&gt;</span></span>
<span id="cb3-520"><a href="#cb3-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-521"><a href="#cb3-521" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{E}(Y(a')|G=g) = \hat{E}[Y|A=a',L,G=g,AG=a'g; \hat{\theta}_Y]$$ --&gt;</span></span>
<span id="cb3-522"><a href="#cb3-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-523"><a href="#cb3-523" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 3:** Calculate the estimated difference for each subgroup $g$: --&gt;</span></span>
<span id="cb3-524"><a href="#cb3-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-525"><a href="#cb3-525" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   $$\hat{\delta}_g = \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g]$$ --&gt;</span></span>
<span id="cb3-526"><a href="#cb3-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-527"><a href="#cb3-527" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 4:** Compare differences in causal effects by subgroups: --&gt;</span></span>
<span id="cb3-528"><a href="#cb3-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-529"><a href="#cb3-529" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{\gamma} = \hat{\delta}_g - \hat{\delta}_{g'}$$ --&gt;</span></span>
<span id="cb3-530"><a href="#cb3-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-531"><a href="#cb3-531" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   where, --&gt;</span></span>
<span id="cb3-532"><a href="#cb3-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-533"><a href="#cb3-533" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{\gamma} = \overbrace{\big( \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g] \big)}^{\hat{\delta}_g} - \overbrace{\big( \hat{E}[Y(a)|G=g'] - \hat{E}[Y(a')|G=g'] \big)}^{\hat{\delta}_{g'}}$$ --&gt;</span></span>
<span id="cb3-534"><a href="#cb3-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-535"><a href="#cb3-535" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This difference $\hat{\gamma}$ represents the difference in the average causal effects between the subgroups $g$ and $g'$, taking into account the interaction effect of the exposure $A$ and the subgroup $G$ on the outcome $Y$. --&gt;</span></span>
<span id="cb3-536"><a href="#cb3-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-537"><a href="#cb3-537" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Note that the interaction term $AG$ (or $ag$ and $a'g$ in the potential outcomes) stands for the interaction between the exposure level and the subgroup. This term is necessary to accommodate the non-additive effects in the model. As before, we must ensure that potential confounders $L$ are sufficient to control for confounding.  --&gt;</span></span>
<span id="cb3-538"><a href="#cb3-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-539"><a href="#cb3-539" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## Appendix C: Doubly Robust Estimation for Subgroup Analysis Estimator with Interaction --&gt;</span></span>
<span id="cb3-540"><a href="#cb3-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-541"><a href="#cb3-541" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Again, Doubly Robust Estimation combines the strengths of both the IPTW and G-computation methods. It uses both the propensity score model and the outcome model, which makes it doubly robust: it produces unbiased estimates if either one of the models is correctly specified. --&gt;</span></span>
<span id="cb3-542"><a href="#cb3-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-543"><a href="#cb3-543" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 1** Estimate the propensity score. The propensity score $e(L, G)$ is the conditional probability of the exposure $A = 1$, given the covariates $L$ and subgroup indicator $G$. This can be modeled using logistic regression or other suitable methods, depending on the nature of the data and the exposure. --&gt;</span></span>
<span id="cb3-544"><a href="#cb3-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-545"><a href="#cb3-545" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$e = P(A = 1 | L, G) = f_A(L, G; \theta_A)$$ --&gt;</span></span>
<span id="cb3-546"><a href="#cb3-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-547"><a href="#cb3-547" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   Here, $f_A(L, G; \theta_A)$ is a function (statistical model) that estimates the probability of the exposure $A = 1$ given covariates $L$ and subgroup $G$. Then, we calculate the weights for each individual, denoted as $v$, using the estimated propensity score: --&gt;</span></span>
<span id="cb3-548"><a href="#cb3-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-549"><a href="#cb3-549" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb3-550"><a href="#cb3-550" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   v =  --&gt;</span></span>
<span id="cb3-551"><a href="#cb3-551" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   \begin{cases}  --&gt;</span></span>
<span id="cb3-552"><a href="#cb3-552" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \frac{1}{\hat{e}} &amp; \text{if } A = 1 \\ --&gt;</span></span>
<span id="cb3-553"><a href="#cb3-553" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \frac{1}{1-\hat{e}} &amp; \text{if } A = 0  --&gt;</span></span>
<span id="cb3-554"><a href="#cb3-554" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \end{cases} --&gt;</span></span>
<span id="cb3-555"><a href="#cb3-555" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb3-556"><a href="#cb3-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-557"><a href="#cb3-557" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   **Step 2** Fit a weighted outcome model. Using the weights calculated from the estimated propensity scores, fit a model for the outcome $Y$, conditional on the exposure $A$, covariates $L$, subgroup $G$ and the interaction between $A$ and $G$. --&gt;</span></span>
<span id="cb3-558"><a href="#cb3-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-559"><a href="#cb3-559" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ \hat{E}(Y|A, L, G, AG; V) = f_Y(A, L, G, AG ; \theta_Y, V) $$ --&gt;</span></span>
<span id="cb3-560"><a href="#cb3-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-561"><a href="#cb3-561" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   **Step 3** For each individual in each subgroup, simulate their potential outcome under the hypothetical scenario where everyone in the subgroup is exposed to the intervention $A=a$ regardless of their actual exposure level: --&gt;</span></span>
<span id="cb3-562"><a href="#cb3-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-563"><a href="#cb3-563" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   $$\hat{E}(Y(a)|G=g) = \hat{E}[Y|A=a,G=g, AG=ag; L,\hat{\theta}_Y, v]$$ --&gt;</span></span>
<span id="cb3-564"><a href="#cb3-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-565"><a href="#cb3-565" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- And also under the hypothetical scenario where everyone in each subgroup is exposed to intervention $A=a'$: --&gt;</span></span>
<span id="cb3-566"><a href="#cb3-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-567"><a href="#cb3-567" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{E}(Y(a')|G=g) = \hat{E}[Y|A=a',G=g, AG=a'g; L; \hat{\theta}_Y, v]$$ --&gt;</span></span>
<span id="cb3-568"><a href="#cb3-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-569"><a href="#cb3-569" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 4** Estimate the average causal effect for each subgroup. Compute the estimated expected value of the potential outcomes under each intervention level for each subgroup: --&gt;</span></span>
<span id="cb3-570"><a href="#cb3-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-571"><a href="#cb3-571" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   $$\hat{\delta}_g = \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g]$$ --&gt;</span></span>
<span id="cb3-572"><a href="#cb3-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-573"><a href="#cb3-573" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The estimated difference $\hat{\delta}_g$ represents the average causal effect of changing the exposure from level $a'$ to level $a$ within each subgroup. --&gt;</span></span>
<span id="cb3-574"><a href="#cb3-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-575"><a href="#cb3-575" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 5** Compare differences in causal effects by groups. Compute the differences in the estimated causal effects between different subgroups: --&gt;</span></span>
<span id="cb3-576"><a href="#cb3-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-577"><a href="#cb3-577" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{\gamma} = \hat{\delta}_g - \hat{\delta}_{g'}$$ --&gt;</span></span>
<span id="cb3-578"><a href="#cb3-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-579"><a href="#cb3-579" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- where, --&gt;</span></span>
<span id="cb3-580"><a href="#cb3-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-581"><a href="#cb3-581" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{\gamma} = \overbrace{\big( \hat{E}[Y(a)|G=g] - \hat{E}[Y(a')|G=g] \big)}^{\hat{\delta}_g} - \overbrace{\big( \hat{E}[Y(a)|G=g'] - \hat{E}[Y(a')|G=g'] \big)}^{\hat{\delta}_{g'}}$$ --&gt;</span></span>
<span id="cb3-582"><a href="#cb3-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-583"><a href="#cb3-583" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We again use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. --&gt;</span></span>
<span id="cb3-584"><a href="#cb3-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-585"><a href="#cb3-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-586"><a href="#cb3-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-587"><a href="#cb3-587" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## Appendix D: Marginal Structural Models for Estimating Population Average Treatment Effect with Interaction (Doubly Robust) --&gt;</span></span>
<span id="cb3-588"><a href="#cb3-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-589"><a href="#cb3-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-590"><a href="#cb3-590" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Sometimes we will only wish to estimate a marginal effect. In that case. --&gt;</span></span>
<span id="cb3-591"><a href="#cb3-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-592"><a href="#cb3-592" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 1** Estimate the propensity score. The propensity score $e(L)$ is the conditional probability of the exposure $A = 1$, given the covariates $L$ which contains the subgroup $G$. This can be modelled using logistic regression or other functions as described in @greifer2023 --&gt;</span></span>
<span id="cb3-593"><a href="#cb3-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-594"><a href="#cb3-594" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{e} = P(A = 1 | L) = f_A(L; \theta_A)$$ --&gt;</span></span>
<span id="cb3-595"><a href="#cb3-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-596"><a href="#cb3-596" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Here, $f_A(L; \theta_A)$ is a function (a statistical model) that estimates the probability of the exposure $A = 1$ given covariates $L$. Then, we calculate the weights for each individual, denoted as $v$, using the estimated propensity score: --&gt;</span></span>
<span id="cb3-597"><a href="#cb3-597" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb3-598"><a href="#cb3-598" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   v =  --&gt;</span></span>
<span id="cb3-599"><a href="#cb3-599" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   \begin{cases}  --&gt;</span></span>
<span id="cb3-600"><a href="#cb3-600" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \frac{1}{e} &amp; \text{if } A = 1 \\ --&gt;</span></span>
<span id="cb3-601"><a href="#cb3-601" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \frac{1}{1-e} &amp; \text{if } A = 0  --&gt;</span></span>
<span id="cb3-602"><a href="#cb3-602" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \end{cases} --&gt;</span></span>
<span id="cb3-603"><a href="#cb3-603" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb3-604"><a href="#cb3-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-605"><a href="#cb3-605" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 2** Fit a weighted outcome model. Using the weights calculated from the estimated propensity scores, fit a model for the outcome $Y$, conditional on the exposure $A$ and covariates $L$. --&gt;</span></span>
<span id="cb3-606"><a href="#cb3-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-607"><a href="#cb3-607" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ \hat{E}(Y|A, L; V) = f_Y(A, L; \theta_Y, V) $$ --&gt;</span></span>
<span id="cb3-608"><a href="#cb3-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-609"><a href="#cb3-609" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This model should include terms for both the main effects of $A$ and $L$ and their interaction $AL$. --&gt;</span></span>
<span id="cb3-610"><a href="#cb3-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-611"><a href="#cb3-611" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 3** For the entire population, simulate the potential outcome under the hypothetical scenario where everyone is exposed to the intervention $A=a$ regardless of their actual exposure level: --&gt;</span></span>
<span id="cb3-612"><a href="#cb3-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-613"><a href="#cb3-613" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   $$\hat{E}(Y(a)) = \hat{E}[Y|A=a; L,\hat{\theta}_Y, v]$$ --&gt;</span></span>
<span id="cb3-614"><a href="#cb3-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-615"><a href="#cb3-615" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- And also under the hypothetical scenario where everyone is exposed to intervention $A=a'$: --&gt;</span></span>
<span id="cb3-616"><a href="#cb3-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-617"><a href="#cb3-617" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{E}(Y(a')) = \hat{E}[Y|A=a'; L; \hat{\theta}_Y, v]$$ --&gt;</span></span>
<span id="cb3-618"><a href="#cb3-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-619"><a href="#cb3-619" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- **Step 4** Estimate the average causal effect for the entire population. Compute the estimated expected value of the potential outcomes under each intervention level for the entire population: --&gt;</span></span>
<span id="cb3-620"><a href="#cb3-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-621"><a href="#cb3-621" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$\hat{\delta} = \hat{E}[Y(a)] - \hat{E}[Y(a')]$$ --&gt;</span></span>
<span id="cb3-622"><a href="#cb3-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-623"><a href="#cb3-623" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The estimated difference $\hat{\delta}$ represents the average causal effect of changing the exposure from level $a'$ to level $a$ in the entire population. --&gt;</span></span>
<span id="cb3-624"><a href="#cb3-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-625"><a href="#cb3-625" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We again use simulation-based inference methods to compute standard errors and confidence intervals [@greifer2023]. --&gt;</span></span>
<span id="cb3-626"><a href="#cb3-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-627"><a href="#cb3-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-628"><a href="#cb3-628" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Machine Learning --&gt;</span></span>
<span id="cb3-629"><a href="#cb3-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-630"><a href="#cb3-630" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Example from https://osf.io/cnphs --&gt;</span></span>
<span id="cb3-631"><a href="#cb3-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-632"><a href="#cb3-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-633"><a href="#cb3-633" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- &gt; We perform statistical estimation using semi-parametric Targeted --&gt;</span></span>
<span id="cb3-634"><a href="#cb3-634" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Learning, specifically a Targeted Minimum Loss-based Estimation (TMLE) --&gt;</span></span>
<span id="cb3-635"><a href="#cb3-635" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- estimator. TMLE is a robust method that combines machine learning --&gt;</span></span>
<span id="cb3-636"><a href="#cb3-636" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- techniques with traditional statistical models to estimate causal --&gt;</span></span>
<span id="cb3-637"><a href="#cb3-637" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- effects while providing valid statistical uncertainty measures for these --&gt;</span></span>
<span id="cb3-638"><a href="#cb3-638" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- estimates [@van2012targeted; @van2014targeted]. --&gt;</span></span>
<span id="cb3-639"><a href="#cb3-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-640"><a href="#cb3-640" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- &gt; TMLE operates through a two-step process that involves modelling both --&gt;</span></span>
<span id="cb3-641"><a href="#cb3-641" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- the outcome and treatment (exposure). Initially, TMLE employs machine --&gt;</span></span>
<span id="cb3-642"><a href="#cb3-642" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- learning algorithms to flexibly model the relationship between --&gt;</span></span>
<span id="cb3-643"><a href="#cb3-643" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- treatments, covariates, and outcomes. This flexibility allows TMLE to --&gt;</span></span>
<span id="cb3-644"><a href="#cb3-644" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- account for complex, high-dimensional covariate spaces --&gt;</span></span>
<span id="cb3-645"><a href="#cb3-645" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \emph{efficiently} without imposing restrictive model assumptions; --&gt;</span></span>
<span id="cb3-646"><a href="#cb3-646" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- [@vanderlaan2011; @vanderlaan2018]. The outcome of this step is a set --&gt;</span></span>
<span id="cb3-647"><a href="#cb3-647" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- of initial estimates for these relationships. --&gt;</span></span>
<span id="cb3-648"><a href="#cb3-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-649"><a href="#cb3-649" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- &gt; The second step of TMLE involves ``targeting'' these initial estimates --&gt;</span></span>
<span id="cb3-650"><a href="#cb3-650" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- by incorporating information about the observed data distribution to --&gt;</span></span>
<span id="cb3-651"><a href="#cb3-651" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- improve the accuracy of the causal effect estimate. TMLE achieves this --&gt;</span></span>
<span id="cb3-652"><a href="#cb3-652" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- precision through an iterative updating process, which adjusts the --&gt;</span></span>
<span id="cb3-653"><a href="#cb3-653" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- initial estimates towards the true causal effect. This updating process --&gt;</span></span>
<span id="cb3-654"><a href="#cb3-654" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- is guided by the efficient influence function, ensuring that the final --&gt;</span></span>
<span id="cb3-655"><a href="#cb3-655" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- TMLE estimate is as close as possible, given the measures and data, to --&gt;</span></span>
<span id="cb3-656"><a href="#cb3-656" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- the targeted causal effect while still being robust to --&gt;</span></span>
<span id="cb3-657"><a href="#cb3-657" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- model-misspecification in either the outcome or the treatment model --&gt;</span></span>
<span id="cb3-658"><a href="#cb3-658" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- [@van2014discussion]. --&gt;</span></span>
<span id="cb3-659"><a href="#cb3-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-660"><a href="#cb3-660" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- &gt; Again, a central feature of TMLE is its double-robustness property. If --&gt;</span></span>
<span id="cb3-661"><a href="#cb3-661" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- either the treatment model or the outcome model is correctly specified, --&gt;</span></span>
<span id="cb3-662"><a href="#cb3-662" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- the TMLE estimator will consistently estimate the causal effect. --&gt;</span></span>
<span id="cb3-663"><a href="#cb3-663" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Additionally, we used cross-validation to avoid over-fitting, following --&gt;</span></span>
<span id="cb3-664"><a href="#cb3-664" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- the pre-stated protocols in Bulbulia [@bulbulia2024PRACTICAL]. The integration of TMLE --&gt;</span></span>
<span id="cb3-665"><a href="#cb3-665" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- and machine learning technologies reduces the dependence on restrictive --&gt;</span></span>
<span id="cb3-666"><a href="#cb3-666" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- modelling assumptions and introduces an additional layer of robustness. --&gt;</span></span>
<span id="cb3-667"><a href="#cb3-667" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- For further details of the specific targeted learning strategy we --&gt;</span></span>
<span id="cb3-668"><a href="#cb3-668" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- favour, see [@hoffman2022, @hoffman2023]. We perform estimation using the --&gt;</span></span>
<span id="cb3-669"><a href="#cb3-669" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \texttt{lmtp} package [@williams2021]. We used the \texttt{superlearner} library for semi-parametric estimation with the predefined libraries \texttt{SL.ranger}, --&gt;</span></span>
<span id="cb3-670"><a href="#cb3-670" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \texttt{SL.glmnet}, and \texttt{SL.xgboost} [@xgboost2023; @polley2023; @Ranger2017]. We created graphs, tables and output reports using the \texttt{margot} package --&gt;</span></span>
<span id="cb3-671"><a href="#cb3-671" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- [@margot2024]. --&gt;</span></span>
<span id="cb3-672"><a href="#cb3-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-673"><a href="#cb3-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-674"><a href="#cb3-674" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Sensitivity Analysis Using the E-value --&gt;</span></span>
<span id="cb3-675"><a href="#cb3-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-676"><a href="#cb3-676" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- &gt; To assess the sensitivity of results to unmeasured confounding, we --&gt;</span></span>
<span id="cb3-677"><a href="#cb3-677" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- report VanderWeele and Ding's ``E-value'' in all analyses --&gt;</span></span>
<span id="cb3-678"><a href="#cb3-678" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- [@vanderweele2017]. The E-value quantifies the minimum strength of association (on the risk ratio scale) that an unmeasured confounder would need to have with both the exposure --&gt;</span></span>
<span id="cb3-679"><a href="#cb3-679" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- and the outcome (after considering the measured covariates) to explain --&gt;</span></span>
<span id="cb3-680"><a href="#cb3-680" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- away the observed exposure-outcome association --&gt;</span></span>
<span id="cb3-681"><a href="#cb3-681" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- [@linden2020EVALUE; @vanderweele2020]. To --&gt;</span></span>
<span id="cb3-682"><a href="#cb3-682" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- evaluate the strength of evidence, we use the bound of the E-value 95\% --&gt;</span></span>
<span id="cb3-683"><a href="#cb3-683" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- confidence interval closest to 1. --&gt;</span></span>
<span id="cb3-684"><a href="#cb3-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-685"><a href="#cb3-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-686"><a href="#cb3-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-687"><a href="#cb3-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-688"><a href="#cb3-688" aria-hidden="true" tabindex="-1"></a><span class="fu">### Packages</span></span>
<span id="cb3-689"><a href="#cb3-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-692"><a href="#cb3-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-693"><a href="#cb3-693" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span>
<span id="cb3-694"><a href="#cb3-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-695"><a href="#cb3-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-696"><a href="#cb3-696" aria-hidden="true" tabindex="-1"></a>---</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>